# 13.1 门限单位根过程


```R
library(tsDyn)
```

    Warning message:
    "package 'tsDyn' was built under R version 4.0.4"
    Registered S3 method overwritten by 'quantmod':
      method            from
      as.zoo.data.frame zoo 


​    


```R
china3v = read.csv("doc/Ch13/china3v.csv", header=TRUE)
```


```R
dat0 <- ts(china3v, start=c(1961, 1), freq=4)
```


```R
head(dat0)
```


<table class="dataframe">
<caption>A Time Series: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>Saving</th><th scope=col>Investment</th><th scope=col>Growth</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1961 Q1</th><td>0.1008</td><td>0.2758</td><td>0.1813</td></tr>
	<tr><th scope=row>1961 Q2</th><td>0.1008</td><td>0.2882</td><td>0.2007</td></tr>
	<tr><th scope=row>1961 Q3</th><td>0.1008</td><td>0.2994</td><td>0.2187</td></tr>
	<tr><th scope=row>1961 Q4</th><td>0.1008</td><td>0.3095</td><td>0.2355</td></tr>
	<tr><th scope=row>1962 Q1</th><td>0.1043</td><td>0.3304</td><td>0.2582</td></tr>
	<tr><th scope=row>1962 Q2</th><td>0.1043</td><td>0.3485</td><td>0.2785</td></tr>
</tbody>
</table>




```R
dat1 <- timeSeries::as.timeSeries(dat0)
```


```R
plot(dat1, main="")
```


![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_6_0.png)



```R
y = dat1[, 3]
```

- 范例程序 13-2: 估计SETAR


```R
P.lags = 5 # 设定最大滞后阶数
out1.tar = setar(y, m=P.lags, d=1, nthresh=2 , trace=T, type="ADF")
```

    Using maximum autoregressive order for low regime: mL = 5 
    Using maximum autoregressive order for high regime: mH = 5 
    Using maximum autoregressive order for middle regime: mM = 5 
    Searching on 61 possible threshold values within regimes with sufficient ( 15% ) number of observations
    Searching on 61 combinations of thresholds (61) and thDelay (1) 
    Result of the one threshold search:
     -Thresh:  0.0936 	-Delay:  0 	- SSR 0.004392703 
    Second best: 0.1726 (conditionnal on th= 0.0936 and Delay= 0 ) 	 SSR/AIC: 0.004050858
    Second best: 0.0936 (conditionnal on th= 0.1726 and Delay= 0 ) 	 SSR/AIC: 0.004050858
    Selected threshold:  0.0936 0.1726 
    Selected delay:  0 



```R
summary(out1.tar)
```


​    
    Non linear autoregressive model
    
    SETAR model ( 3 regimes)
    Coefficients:
    Low regime:
        const.L      phiL.1 
     0.03518686 -0.39404311 
    
    Mid regime:
         const.M       phiM.1 
    -0.001218929  0.015360314 
    
    High regime:
         const.H       phiH.1 
    -0.003795945 -0.007692191 
    
    Threshold:
    -Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)+ (0)X(t-3)
    -Value: 0.0936 0.1726
    Proportion of points in low regime: 17.78% 	 Middle regime: 51.11% 	 High regime: 31.11% 
    
    Residuals:
            Min          1Q      Median          3Q         Max 
    -0.03263961 -0.00130436 -0.00037097  0.00281277  0.01709333 
    
    Fit:
    residuals variance = 3.871e-05,  AIC = -929, MAPE = 88.72%
    
    Coefficient(s):
    
               Estimate  Std. Error  t value  Pr(>|t|)    
    const.L  0.03518686  0.02505237   1.4045   0.16429    
    phiL.1  -0.39404311  0.28415473  -1.3867   0.16964    
    DphiL.1  0.23380383  0.58852869   0.3973   0.69230    
    DphiL.2  0.19555425  0.63255212   0.3092   0.75806    
    DphiL.3 -0.90997440  0.96734335  -0.9407   0.34988    
    DphiL.4 -0.86550430  0.90008562  -0.9616   0.33935    
    DphiL.5  1.85092915  0.82797521   2.2355   0.02836 *  
    const.M -0.00121893  0.00549555  -0.2218   0.82507    
    phiM.1   0.01536031  0.04109667   0.3738   0.70964    
    DphiM.1  0.94463473  0.14542505   6.4957 8.056e-09 ***
    DphiM.2 -0.00731459  0.18527702  -0.0395   0.96861    
    DphiM.3 -0.00979549  0.18214575  -0.0538   0.95725    
    DphiM.4 -0.26863967  0.23270559  -1.1544   0.25199    
    DphiM.5  0.25755070  0.19579284   1.3154   0.19237    
    const.H -0.00379595  0.00547092  -0.6938   0.48993    
    phiH.1  -0.00769219  0.02293344  -0.3354   0.73825    
    DphiH.1  0.69652331  0.14083017   4.9458 4.513e-06 ***
    DphiH.2  0.01601778  0.17574121   0.0911   0.92762    
    DphiH.3  0.00042985  0.17505327   0.0025   0.99805    
    DphiH.4  0.11588445  0.16327226   0.7098   0.48005    
    DphiH.5 -0.02014590  0.12019196  -0.1676   0.86734    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    Threshold
    Variable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)+ (0) X(t-3)+ (0) X(t-4)
    
    Value: 0.0936 0.1726



```R
summary(out1.tar)$coef
```


<table class="dataframe">
<caption>A matrix: 21 × 4 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col> Estimate</th><th scope=col> Std. Error</th><th scope=col> t value</th><th scope=col>Pr(&gt;|t|)</th></tr>
</thead>
<tbody>
	<tr><th scope=row>const.L</th><td> 0.0351868610</td><td>0.025052373</td><td> 1.404532050</td><td>1.642885e-01</td></tr>
	<tr><th scope=row>phiL.1</th><td>-0.3940431128</td><td>0.284154734</td><td>-1.386720209</td><td>1.696352e-01</td></tr>
	<tr><th scope=row>DphiL.1</th><td> 0.2338038274</td><td>0.588528693</td><td> 0.397268358</td><td>6.922979e-01</td></tr>
	<tr><th scope=row>DphiL.2</th><td> 0.1955542470</td><td>0.632552119</td><td> 0.309151201</td><td>7.580637e-01</td></tr>
	<tr><th scope=row>DphiL.3</th><td>-0.9099744013</td><td>0.967343351</td><td>-0.940694325</td><td>3.498815e-01</td></tr>
	<tr><th scope=row>DphiL.4</th><td>-0.8655042960</td><td>0.900085623</td><td>-0.961579959</td><td>3.393506e-01</td></tr>
	<tr><th scope=row>DphiL.5</th><td> 1.8509291489</td><td>0.827975211</td><td> 2.235488603</td><td>2.836099e-02</td></tr>
	<tr><th scope=row>const.M</th><td>-0.0012189294</td><td>0.005495550</td><td>-0.221802989</td><td>8.250701e-01</td></tr>
	<tr><th scope=row>phiM.1</th><td> 0.0153603144</td><td>0.041096668</td><td> 0.373760575</td><td>7.096370e-01</td></tr>
	<tr><th scope=row>DphiM.1</th><td> 0.9446347336</td><td>0.145425053</td><td> 6.495680878</td><td>8.056311e-09</td></tr>
	<tr><th scope=row>DphiM.2</th><td>-0.0073145886</td><td>0.185277016</td><td>-0.039479202</td><td>9.686132e-01</td></tr>
	<tr><th scope=row>DphiM.3</th><td>-0.0097954940</td><td>0.182145749</td><td>-0.053778329</td><td>9.572548e-01</td></tr>
	<tr><th scope=row>DphiM.4</th><td>-0.2686396718</td><td>0.232705594</td><td>-1.154418622</td><td>2.519938e-01</td></tr>
	<tr><th scope=row>DphiM.5</th><td> 0.2575507008</td><td>0.195792843</td><td> 1.315424490</td><td>1.923745e-01</td></tr>
	<tr><th scope=row>const.H</th><td>-0.0037959450</td><td>0.005470917</td><td>-0.693840773</td><td>4.899255e-01</td></tr>
	<tr><th scope=row>phiH.1</th><td>-0.0076921910</td><td>0.022933444</td><td>-0.335413687</td><td>7.382495e-01</td></tr>
	<tr><th scope=row>DphiH.1</th><td> 0.6965233125</td><td>0.140830170</td><td> 4.945838740</td><td>4.512746e-06</td></tr>
	<tr><th scope=row>DphiH.2</th><td> 0.0160177812</td><td>0.175741213</td><td> 0.091144137</td><td>9.276211e-01</td></tr>
	<tr><th scope=row>DphiH.3</th><td> 0.0004298477</td><td>0.175053274</td><td> 0.002455525</td><td>9.980473e-01</td></tr>
	<tr><th scope=row>DphiH.4</th><td> 0.1158844546</td><td>0.163272264</td><td> 0.709762035</td><td>4.800526e-01</td></tr>
	<tr><th scope=row>DphiH.5</th><td>-0.0201459033</td><td>0.120191956</td><td>-0.167614407</td><td>8.673378e-01</td></tr>
</tbody>
</table>




```R
th = summary(out1.tar)$thCoef
th
```


<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>th1</dt><dd>0.0936</dd><dt>th2</dt><dd>0.1726</dd></dl>




```R
plot(y)
abline(h=th[1])
abline(h=th[2])
```


![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_13_0.png)


- 范例程序 13-3: SETAR 模型估计结果的诊断


```R
# dev.new()
plot(out1.tar)
```


![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_15_0.png)



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_15_1.png)



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_15_2.png)



    Error in xy.coords(x, y): 'x' and 'y' lengths differ
    Traceback:


    1. plot(out1.tar)
    
    2. plot.setar(out1.tar)
    
    3. lines.default(xxyy[, j], x.old$fitted, lty = 2)
    
    4. plot.xy(xy.coords(x, y), type = type, ...)
    
    5. xy.coords(x, y)
    
    6. stop("'x' and 'y' lengths differ")



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_15_4.png)



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_15_5.png)



```R
# setarTest()
```

# 13.2 门限 VAR 

- 范例程序13-4: 数据读入和预处理


```R
library(xts)
```

    Loading required package: zoo


​    
    Attaching package: 'zoo'


​    
    The following objects are masked from 'package:base':
    
        as.Date, as.Date.numeric


​    
​    


```R
AORD0 = read.csv("doc/Ch13/AORD.csv")
GDAXI0 = read.csv("doc/Ch13/GDAXI.csv")
```


```R
AORD = as.xts(AORD0[,-1], as.Date(AORD0[,1]))
GDAXI = as.xts(GDAXI0[,-1], as.Date(GDAXI0[,1]))
```


```R
head(AORD)
```


                 Open   High    Low  Close    Volume
    2007-07-06 6392.1 6392.1 6352.5 6383.0 789604000
    2007-07-09 6385.3 6429.5 6385.3 6429.5 664130000
    2007-07-10 6431.5 6431.9 6394.8 6397.8 784987000
    2007-07-11 6394.1 6394.1 6339.1 6363.2 819885000
    2007-07-12 6373.4 6402.7 6369.8 6400.1 926407000
    2007-07-13 6423.8 6469.2 6423.8 6425.4 834473000



```R
head(GDAXI)
```


                  Open    High     Low   Close    Volume
    2007-07-06 7987.12 8048.43 7947.06 8048.31 186076000
    2007-07-09 8077.18 8119.79 8058.77 8077.39 206294000
    2007-07-10 8081.73 8109.71 7943.10 7964.75 280925000
    2007-07-11 7922.23 7922.23 7799.93 7898.54 288293000
    2007-07-12 7921.75 8053.62 7880.91 8053.43 305825000
    2007-07-13 8089.56 8151.56 8069.81 8092.77 233100000



```R
Risk1 = (AORD[, "High"]-AORD[, "Low"])/AORD[, "Low"]
Risk2 = (GDAXI[, "High"]-GDAXI[, "Low"])/GDAXI[, "Low"]
```


```R
dat = na.omit(cbind(Risk1, Risk2))*100
```


```R
colnames(dat) = c("risk.Aord", 'risk.GDAX')
```


```R
tail(dat)
```


               risk.Aord risk.GDAX
    2017-06-28 0.9402096 1.0720354
    2017-06-29 1.0524318 2.6871355
    2017-06-30 1.6631656 1.1421382
    2017-07-03 0.8032830 0.7715464
    2017-07-04 1.7546923 0.5655999
    2017-07-05 0.5799703 0.7262205


数据整理毕，门限 VAR 的分析流程如范例程序 13-5 所示，可以分为两步。第 1 步是线性检验，也就是必须检验看看线性的 H0 能否被 threshold 非线性拒绝。第 2 步是 TVAR 估计 和相关计算。 

- 范例程序 13 -5: TVAR 估计


```R
# 第一步：线性检验
library(tsDyn)
test1 = TVAR.LRtest(dat, lag=2)
```


    Warning: the thDelay values do not correspond to the univariate implementation in tsdyn



```R
summary(test1)
# 检验结果摘要
# 说明存在门限
```

    Test of linear VAR against TVAR(1) and TVAR(2)
    
    LR test:
              1vs2     1vs3
    Test  132.0369 150.8706
    P-Val   0.0000   0.0000
    
     Bootstrap critical values for test 1 vs 2 regimes
         90%      95%    97.5%      99% 
    26.91908 31.00840 33.05305 34.27985 
    
     Bootstrap critical values for test 1 vs 3 regimes
         90%      95%    97.5%      99% 
    51.69838 54.84600 56.41981 57.36410 



```R
# 第二步：门限 VAR 估计
out1.tvar = TVAR(dat, lag=2, nthresh=1, thDelay=1, plot=TRUE)
# 估计 TVAR(2), 设定 1 个门限值 nthresh=1, 也就是 2 个区间；
# thDelay=1 是指门限变量落后 1 期。
# 内建门限变量是 dat 的第 1 栏，也就是 Y。
# 下面会说明如何设定其他外在的变量当作门限变量 
```

    Best unique threshold 1.745116 



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_32_1.png)



```
summary(out1.tvar)
```

    Model TVAR with  1  thresholds
    
    Full sample size: 2503 	End sample size: 2501
    Number of variables: 2 	Number of estimated parameters: 20 + 1
    AIC -3884.055 	BIC -3761.742 	 SSR 2474.828 
    
    [[1]]
                       Intercept         risk.Aord -1      risk.GDAX -1     
    Equation risk.Aord 0.2531(0.0376)*** 0.1956(0.0378)*** 0.2311(0.0166)***
    Equation risk.GDAX 0.3384(0.0546)*** 0.1236(0.0549)*   0.2987(0.0241)***
                       risk.Aord -2      risk.GDAX -2     
    Equation risk.Aord 0.2233(0.0257)*** 0.0142(0.0183)   
    Equation risk.GDAX 0.2136(0.0374)*** 0.2631(0.0266)***
    
    [[2]]
                       Intercept         risk.Aord -1      risk.GDAX -1     
    Equation risk.Aord 0.4698(0.0878)*** 0.2062(0.0366)*** 0.2299(0.0231)***
    Equation risk.GDAX 0.0579(0.1277)    0.2737(0.0532)*** 0.5635(0.0336)***
                       risk.Aord -2      risk.GDAX -2     
    Equation risk.Aord 0.1646(0.0290)*** -0.0080(0.0221)  
    Equation risk.GDAX -0.0131(0.0422)   0.1585(0.0321)***
    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
    
    Threshold value: 1.745116
    Percentage of Observations in each regime: 85% 15% 


最下方指出门限值是 1.745


```R
summary(out1.tvar)$VarCov
# 估计参数的方差协方差矩阵 
```

    Warning message in if (class(x) == "matrix") return(list(x)) else return(x):
    "条件的长度大于一，因此只能用其第一元素"



<ol>
	<li><table class="dataframe">
<caption>A matrix: 20 × 20 of type dbl</caption>
<tbody>
	<tr><td> 1.412962e-03</td><td>-7.812904e-04</td><td>-1.076911e-04</td><td>-2.387971e-04</td><td>-8.662049e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 3.266649e-04</td><td>-1.806278e-04</td><td>-2.489729e-05</td><td>-5.520788e-05</td><td>-2.002593e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-7.812904e-04</td><td> 1.427834e-03</td><td>-5.298071e-05</td><td>-2.245245e-04</td><td>-1.596623e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.806278e-04</td><td> 3.301032e-04</td><td>-1.224870e-05</td><td>-5.190819e-05</td><td>-3.691258e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-1.076911e-04</td><td>-5.298071e-05</td><td> 2.746650e-04</td><td>-8.005805e-05</td><td>-1.180974e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-2.489729e-05</td><td>-1.224870e-05</td><td> 6.350024e-05</td><td>-1.850875e-05</td><td>-2.730313e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-2.387971e-04</td><td>-2.245245e-04</td><td>-8.005805e-05</td><td> 6.628910e-04</td><td>-7.808161e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-5.520788e-05</td><td>-5.190819e-05</td><td>-1.850875e-05</td><td> 1.532548e-04</td><td>-1.805181e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-8.662049e-05</td><td>-1.596623e-04</td><td>-1.180974e-04</td><td>-7.808161e-05</td><td> 3.345312e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-2.002593e-05</td><td>-3.691258e-05</td><td>-2.730313e-05</td><td>-1.805181e-05</td><td> 7.734080e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 7.710074e-03</td><td>-2.224273e-03</td><td> 1.326486e-04</td><td>-5.557879e-04</td><td>-1.742423e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 1.782504e-03</td><td>-5.142332e-04</td><td> 3.066724e-05</td><td>-1.284935e-04</td><td>-4.028335e-05</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-2.224273e-03</td><td> 1.338868e-03</td><td>-2.184626e-04</td><td>-9.634590e-05</td><td>-1.192184e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-5.142332e-04</td><td> 3.095351e-04</td><td>-5.050672e-05</td><td>-2.227436e-05</td><td>-2.756228e-05</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 1.326486e-04</td><td>-2.184626e-04</td><td> 5.341347e-04</td><td>-1.604086e-04</td><td>-2.577343e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 3.066724e-05</td><td>-5.050672e-05</td><td> 1.234875e-04</td><td>-3.708513e-05</td><td>-5.958602e-05</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-5.557879e-04</td><td>-9.634590e-05</td><td>-1.604086e-04</td><td> 8.426000e-04</td><td>-1.312830e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.284935e-04</td><td>-2.227436e-05</td><td>-3.708513e-05</td><td> 1.948020e-04</td><td>-3.035152e-05</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.742423e-04</td><td>-1.192184e-04</td><td>-2.577343e-04</td><td>-1.312830e-04</td><td> 4.866645e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-4.028335e-05</td><td>-2.756228e-05</td><td>-5.958602e-05</td><td>-3.035152e-05</td><td> 1.125128e-04</td></tr>
	<tr><td> 3.266649e-04</td><td>-1.806278e-04</td><td>-2.489729e-05</td><td>-5.520788e-05</td><td>-2.002593e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 2.986201e-03</td><td>-1.651206e-03</td><td>-2.275982e-04</td><td>-5.046819e-04</td><td>-1.830667e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-1.806278e-04</td><td> 3.301032e-04</td><td>-1.224870e-05</td><td>-5.190819e-05</td><td>-3.691258e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.651206e-03</td><td> 3.017633e-03</td><td>-1.119712e-04</td><td>-4.745179e-04</td><td>-3.374358e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-2.489729e-05</td><td>-1.224870e-05</td><td> 6.350024e-05</td><td>-1.850875e-05</td><td>-2.730313e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-2.275982e-04</td><td>-1.119712e-04</td><td> 5.804864e-04</td><td>-1.691974e-04</td><td>-2.495911e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-5.520788e-05</td><td>-5.190819e-05</td><td>-1.850875e-05</td><td> 1.532548e-04</td><td>-1.805181e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-5.046819e-04</td><td>-4.745179e-04</td><td>-1.691974e-04</td><td> 1.400977e-03</td><td>-1.650203e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td>-2.002593e-05</td><td>-3.691258e-05</td><td>-2.730313e-05</td><td>-1.805181e-05</td><td> 7.734080e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.830667e-04</td><td>-3.374358e-04</td><td>-2.495911e-04</td><td>-1.650203e-04</td><td> 7.070096e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 1.782504e-03</td><td>-5.142332e-04</td><td> 3.066724e-05</td><td>-1.284935e-04</td><td>-4.028335e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 1.629473e-02</td><td>-4.700854e-03</td><td> 2.803441e-04</td><td>-1.174621e-03</td><td>-3.682496e-04</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-5.142332e-04</td><td> 3.095351e-04</td><td>-5.050672e-05</td><td>-2.227436e-05</td><td>-2.756228e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-4.700854e-03</td><td> 2.829610e-03</td><td>-4.617063e-04</td><td>-2.036207e-04</td><td>-2.519602e-04</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 3.066724e-05</td><td>-5.050672e-05</td><td> 1.234875e-04</td><td>-3.708513e-05</td><td>-5.958602e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 2.803441e-04</td><td>-4.617063e-04</td><td> 1.128858e-03</td><td>-3.390131e-04</td><td>-5.447046e-04</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.284935e-04</td><td>-2.227436e-05</td><td>-3.708513e-05</td><td> 1.948020e-04</td><td>-3.035152e-05</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-1.174621e-03</td><td>-2.036207e-04</td><td>-3.390131e-04</td><td> 1.780780e-03</td><td>-2.774579e-04</td></tr>
	<tr><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-4.028335e-05</td><td>-2.756228e-05</td><td>-5.958602e-05</td><td>-3.035152e-05</td><td> 1.125128e-04</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td> 0.000000e+00</td><td>-3.682496e-04</td><td>-2.519602e-04</td><td>-5.447046e-04</td><td>-2.774579e-04</td><td> 1.028533e-03</td></tr>
</tbody>
</table>
</li>
</ol>




```R
summary(out1.tvar)$fitted.values
# TVAR 的预测值
```

<table class="dataframe">
<caption>A matrix: 2501 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>risk.Aord</th><th scope=col>risk.GDAX</th></tr>
</thead>
<tbody>
	<tr><th scope=row>2007-07-10</th><td>0.7207180</td><td>1.118911</td></tr>
	<tr><th scope=row>2007-07-11</th><td>1.0165590</td><td>1.383696</td></tr>
	<tr><th scope=row>2007-07-12</th><td>0.9443643</td><td>1.589814</td></tr>
	<tr><th scope=row>2007-07-13</th><td>1.0764731</td><td>1.654698</td></tr>
	<tr><th scope=row>2007-07-16</th><td>0.7717862</td><td>1.415299</td></tr>
	<tr><th scope=row>2007-07-17</th><td>0.6893760</td><td>1.028216</td></tr>
	<tr><th scope=row>2007-07-18</th><td>0.7193816</td><td>1.027846</td></tr>
	<tr><th scope=row>2007-07-19</th><td>0.8089563</td><td>1.229415</td></tr>
	<tr><th scope=row>2007-07-20</th><td>0.8060455</td><td>1.247801</td></tr>
	<tr><th scope=row>2007-07-23</th><td>0.9594084</td><td>1.363507</td></tr>
	<tr><th scope=row>2007-07-24</th><td>0.8723921</td><td>1.438614</td></tr>
	<tr><th scope=row>2007-07-25</th><td>0.9141071</td><td>1.411675</td></tr>
	<tr><th scope=row>2007-07-26</th><td>0.9573203</td><td>1.491508</td></tr>
	<tr><th scope=row>2007-07-27</th><td>1.4503977</td><td>2.054903</td></tr>
	<tr><th scope=row>2007-07-30</th><td>1.7505160</td><td>2.516072</td></tr>
	<tr><th scope=row>2007-07-31</th><td>1.4615884</td><td>2.104215</td></tr>
	<tr><th scope=row>2007-08-01</th><td>1.0305963</td><td>1.569740</td></tr>
	<tr><th scope=row>2007-08-02</th><td>1.6879303</td><td>2.335205</td></tr>
	<tr><th scope=row>2007-08-03</th><td>1.6992037</td><td>1.511190</td></tr>
	<tr><th scope=row>2007-08-06</th><td>1.5286857</td><td>1.850044</td></tr>
	<tr><th scope=row>2007-08-07</th><td>1.3869136</td><td>1.628419</td></tr>
	<tr><th scope=row>2007-08-08</th><td>1.2240703</td><td>1.570769</td></tr>
	<tr><th scope=row>2007-08-09</th><td>1.1128418</td><td>1.393862</td></tr>
	<tr><th scope=row>2007-08-10</th><td>1.2917852</td><td>1.714421</td></tr>
	<tr><th scope=row>2007-08-13</th><td>1.4798554</td><td>1.885612</td></tr>
	<tr><th scope=row>2007-08-14</th><td>1.4932031</td><td>1.854437</td></tr>
	<tr><th scope=row>2007-08-15</th><td>1.1849402</td><td>1.588464</td></tr>
	<tr><th scope=row>2007-08-16</th><td>1.6145948</td><td>1.974998</td></tr>
	<tr><th scope=row>2007-08-17</th><td>2.4183795</td><td>2.755921</td></tr>
	<tr><th scope=row>2007-08-20</th><td>2.8852761</td><td>3.355285</td></tr>
	<tr><th scope=row>...</th><td>...</td><td>...</td></tr>
	<tr><th scope=row>2017-05-23</th><td>0.7229340</td><td>0.9180675</td></tr>
	<tr><th scope=row>2017-05-24</th><td>0.7848695</td><td>1.0699258</td></tr>
	<tr><th scope=row>2017-05-25</th><td>0.5632690</td><td>0.8588425</td></tr>
	<tr><th scope=row>2017-05-26</th><td>0.7450331</td><td>0.9509834</td></tr>
	<tr><th scope=row>2017-05-29</th><td>0.7339428</td><td>1.1004671</td></tr>
	<tr><th scope=row>2017-05-30</th><td>0.7236597</td><td>0.9313638</td></tr>
	<tr><th scope=row>2017-05-31</th><td>0.7475484</td><td>0.9219347</td></tr>
	<tr><th scope=row>2017-06-01</th><td>0.7595415</td><td>1.0302849</td></tr>
	<tr><th scope=row>2017-06-02</th><td>0.5701211</td><td>0.8972797</td></tr>
	<tr><th scope=row>2017-06-06</th><td>0.8046038</td><td>1.0058395</td></tr>
	<tr><th scope=row>2017-06-07</th><td>0.9615609</td><td>1.2711104</td></tr>
	<tr><th scope=row>2017-06-08</th><td>0.9136982</td><td>1.2083518</td></tr>
	<tr><th scope=row>2017-06-09</th><td>0.6688905</td><td>0.9279446</td></tr>
	<tr><th scope=row>2017-06-13</th><td>0.7763022</td><td>0.9708319</td></tr>
	<tr><th scope=row>2017-06-14</th><td>0.8306949</td><td>1.0482292</td></tr>
	<tr><th scope=row>2017-06-15</th><td>1.0456314</td><td>1.2317136</td></tr>
	<tr><th scope=row>2017-06-16</th><td>1.1008015</td><td>1.4370350</td></tr>
	<tr><th scope=row>2017-06-19</th><td>0.7740189</td><td>1.1987961</td></tr>
	<tr><th scope=row>2017-06-20</th><td>0.6377949</td><td>0.8251211</td></tr>
	<tr><th scope=row>2017-06-21</th><td>0.8001825</td><td>1.0472512</td></tr>
	<tr><th scope=row>2017-06-22</th><td>0.9318618</td><td>1.2130812</td></tr>
	<tr><th scope=row>2017-06-23</th><td>0.9633953</td><td>1.1978321</td></tr>
	<tr><th scope=row>2017-06-26</th><td>0.7748356</td><td>1.0478939</td></tr>
	<tr><th scope=row>2017-06-27</th><td>0.6561784</td><td>0.9544871</td></tr>
	<tr><th scope=row>2017-06-28</th><td>0.7138839</td><td>0.9793171</td></tr>
	<tr><th scope=row>2017-06-29</th><td>0.8311671</td><td>1.1245341</td></tr>
	<tr><th scope=row>2017-06-30</th><td>1.3049947</td><td>1.7540132</td></tr>
	<tr><th scope=row>2017-07-03</th><td>1.1153513</td><td>1.8170236</td></tr>
	<tr><th scope=row>2017-07-04</th><td>0.9760519</td><td>1.3239503</td></tr>
	<tr><th scope=row>2017-07-05</th><td>1.0877404</td><td>0.9686358</td></tr>
</tbody>
</table>




```R
# 计算R2
SSE.tvar = apply(summary(out1.tvar)$resid, 2, function(x){sum(x^2)})
SSE0 = apply(dat-apply(dat, 2, mean), 2, function(x){sum(x^2)})
```

    Warning message in if (class(x) == "matrix") return(list(x)) else return(x):
    "条件的长度大于一，因此只能用其第一元素"



```R
R2 = (SSE0-SSE.tvar)/SSE0
R2
```


<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>risk.Aord</dt><dd>0.542868986626446</dd><dt>risk.GDAX</dt><dd>0.553445414383062</dd></dl>




```R
plot(out1.tvar)
```


![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_39_0.png)



```R
names(out1.tvar)
```


<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'coefficients'</li><li>'coeffmat'</li><li>'residuals'</li><li>'model'</li><li>'nobs_regimes'</li><li>'k'</li><li>'t'</li><li>'T'</li><li>'nparB'</li><li>'df.residual'</li><li>'fitted.values'</li><li>'lag'</li><li>'include'</li><li>'model.specific'</li><li>'usedThVar'</li><li>'trim'</li><li>'qr'</li></ol>




```R
names(summary(out1.tvar))
```

    Warning message in if (class(x) == "matrix") return(list(x)) else return(x):
    "条件的长度大于一，因此只能用其第一元素"



<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'coefficients'</li><li>'coeffmat'</li><li>'residuals'</li><li>'model'</li><li>'nobs_regimes'</li><li>'k'</li><li>'t'</li><li>'T'</li><li>'nparB'</li><li>'df.residual'</li><li>'fitted.values'</li><li>'lag'</li><li>'include'</li><li>'model.specific'</li><li>'usedThVar'</li><li>'trim'</li><li>'qr'</li><li>'StDev'</li><li>'Pvalues'</li><li>'Tvalues'</li><li>'VarCov'</li><li>'stars'</li><li>'starslegend'</li><li>'bigcoefficients'</li><li>'aic'</li><li>'bic'</li><li>'SSR'</li></ol>



## 13.3 门限 VECM


```R
library(tsDyn)
```


```R
lags <- vars::VARselect(dat, lag.max=25)$selection
lags
```


<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>AIC(n)</dt><dd>25</dd><dt>HQ(n)</dt><dd>10</dd><dt>SC(n)</dt><dd>6</dd><dt>FPE(n)</dt><dd>25</dd></dl>




```R
out1.tvecm=TVECM(dat, lag=lags[3], nthresh=2, trim=0.05, plot=TRUE)
# nthresh =2 是设定门限值个数为 2;Plot=TRUE 则会产生 
```

    Warning message in FUN(newX[, i], ...):
    "Tolerance reached, ndp possibly underestimated."
    Warning message in FUN(newX[, i], ...):
    "Tolerance reached, ndp possibly underestimated."
    Warning message in FUN(newX[, i], ...):
    "Tolerance reached, ndp possibly underestimated."


    50 (2%) points of the grid lead to regimes with percentage of observations < trim and were not computed
    Best threshold from first search -0.8642011 
    Best cointegrating value 0.576634 
    Second best (conditionnal on the first one) -0.8642011 0.3064223 	 SSR 2230.633 
    Second step best thresholds -0.8642011 0.3064223 			 SSR 2230.633 



![png](Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_files/Ch13%E9%97%A8%E9%99%90%E5%92%8C%E5%B9%B3%E6%BB%91%E8%BD%AC%E7%A7%BB_45_2.png)



```R
summary(out1.tvecm)
# 观察估计结果
```



    #############
    ###Model TVECM
    #############
    Full sample size: 2503 	End sample size: 2496
    Number of variables: 2 	Number of estimated parameters 84
    AIC -4236.551 	BIC -3735.821 	SSR 2230.633 


​    
    Cointegrating vector: (1, - 0.576634 )
    $Bdown
                       ECT                Const              risk.Aord t -1  
    Equation risk.Aord 0.0359(0.7932)     0.5420(1.4e-05)*** -0.3301(0.0160)*
    Equation risk.GDAX 0.9964(5.8e-07)*** -0.0466(0.7965)    -0.4949(0.0129)*
                       risk.GDAX t -1   risk.Aord t -2   risk.GDAX t -2 
    Equation risk.Aord 0.1246(0.0428)*  -0.2082(0.1088)  0.0548(0.3693) 
    Equation risk.GDAX -0.0926(0.3000)  -0.3370(0.0740). 0.1802(0.0420)*
                       risk.Aord t -3   risk.GDAX t -3   risk.Aord t -4  
    Equation risk.Aord 0.0311(0.8164)   -0.1348(0.0341)* 0.3493(0.0080)**
    Equation risk.GDAX -0.0209(0.9142)  0.0616(0.5047)   -0.0744(0.6971) 
                       risk.GDAX t -4  risk.Aord t -5   risk.GDAX t -5  
    Equation risk.Aord 0.0244(0.6383)  -0.0298(0.7536)  0.0110(0.8335)  
    Equation risk.GDAX 0.0060(0.9364)  -0.2880(0.0369)* -0.1056(0.1646) 
                       risk.Aord t -6    risk.GDAX t -6 
    Equation risk.Aord 0.0697(0.3832)    0.0603(0.1296) 
    Equation risk.GDAX -0.3650(0.0017)** 0.0168(0.7707) 
    
    $Bmiddle
                       ECT                Const            risk.Aord t -1     
    Equation risk.Aord -0.2132(0.0012)**  0.0508(0.0039)** -0.6081(3.6e-30)***
    Equation risk.GDAX 0.3854(5.4e-05)*** -0.0271(0.2902)  -0.1223(0.1093)    
                       risk.GDAX t -1      risk.Aord t -2      risk.GDAX t -2     
    Equation risk.Aord 0.0057(0.8582)      -0.4433(2.4e-17)*** 0.0245(0.4466)     
    Equation risk.GDAX -0.6736(4.8e-46)*** -0.1553(0.0396)*    -0.5797(2.9e-34)***
                       risk.Aord t -3      risk.GDAX t -3      risk.Aord t -4     
    Equation risk.Aord -0.3312(2.5e-11)*** -0.0049(0.8760)     -0.2250(1.4e-06)***
    Equation risk.GDAX -0.1580(0.0277)*    -0.4026(1.7e-18)*** -0.1379(0.0413)*   
                       risk.GDAX t -4      risk.Aord t -5    risk.GDAX t -5     
    Equation risk.Aord -0.0057(0.8455)     -0.1322(0.0014)** 0.0348(0.1936)     
    Equation risk.GDAX -0.3317(1.0e-14)*** -0.0669(0.2648)   -0.2255(7.6e-09)***
                       risk.Aord t -6    risk.GDAX t -6     
    Equation risk.Aord -0.0931(0.0017)** 0.0018(0.9301)     
    Equation risk.GDAX -0.0886(0.0398)*  -0.1517(3.1e-07)***
    
    $Bup
                       ECT                 Const             risk.Aord t -1     
    Equation risk.Aord -0.4019(7.0e-14)*** 0.0995(0.0034)**  -0.4344(5.0e-20)***
    Equation risk.GDAX 0.0006(0.9935)      0.1729(0.0005)*** 0.0022(0.9740)     
                       risk.GDAX t -1      risk.Aord t -2      risk.GDAX t -2     
    Equation risk.Aord 0.0363(0.2536)      -0.3312(2.5e-12)*** 0.0102(0.7540)     
    Equation risk.GDAX -0.4020(5.9e-18)*** 0.0227(0.7399)      -0.2657(1.9e-08)***
                       risk.Aord t -3      risk.GDAX t -3      risk.Aord t -4     
    Equation risk.Aord -0.2932(1.2e-10)*** -0.0469(0.1236)     -0.2244(6.8e-08)***
    Equation risk.GDAX 0.0533(0.4184)      -0.2541(1.0e-08)*** 0.0152(0.8005)     
                       risk.GDAX t -4      risk.Aord t -5     risk.GDAX t -5    
    Equation risk.Aord -0.0321(0.2898)     -0.1385(0.0001)*** -0.0471(0.0791).  
    Equation risk.GDAX -0.2560(6.6e-09)*** -0.0907(0.0854).   -0.1445(0.0002)***
                       risk.Aord t -6   risk.GDAX t -6  
    Equation risk.Aord -0.0268(0.3297)  -0.0425(0.0645).
    Equation risk.GDAX 0.0124(0.7561)   -0.0560(0.0936).


​    
    Threshold
    Values: -0.8642011 0.3064223
    Percentage of Observations in each regime 5% 55.1% 39.9% 



```R
summary(out1.tvecm)$coefficients
# 区间系数
```



<dl>
	<dt>$Bdown</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>0.03588499</td><td> 0.54197566</td><td>-0.3301357</td><td> 0.12458831</td><td>-0.2082305</td><td>0.05477102</td><td> 0.03106098</td><td>-0.13480170</td><td> 0.34931311</td><td>0.024432901</td><td>-0.02981927</td><td> 0.01098856</td><td> 0.06967222</td><td>0.06032594</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td>0.99636049</td><td>-0.04660099</td><td>-0.4948697</td><td>-0.09257982</td><td>-0.3370109</td><td>0.18022285</td><td>-0.02093783</td><td> 0.06161896</td><td>-0.07442409</td><td>0.006023211</td><td>-0.28799040</td><td>-0.10556601</td><td>-0.36501481</td><td>0.01684384</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bmiddle</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>-0.2132084</td><td> 0.05083225</td><td>-0.6081340</td><td> 0.005696829</td><td>-0.4432564</td><td> 0.02451359</td><td>-0.3311994</td><td>-0.004893006</td><td>-0.2250226</td><td>-0.005719111</td><td>-0.13224213</td><td> 0.03482251</td><td>-0.09309199</td><td> 0.001787244</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td> 0.3853530</td><td>-0.02707676</td><td>-0.1223279</td><td>-0.673550125</td><td>-0.1552795</td><td>-0.57973217</td><td>-0.1580268</td><td>-0.402588854</td><td>-0.1378934</td><td>-0.331748509</td><td>-0.06694726</td><td>-0.22554845</td><td>-0.08856633</td><td>-0.151721842</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bup</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>-0.4018785692</td><td>0.09951532</td><td>-0.434381222</td><td> 0.03631833</td><td>-0.33116120</td><td> 0.01017369</td><td>-0.2931547</td><td>-0.04691447</td><td>-0.22438741</td><td>-0.0320631</td><td>-0.13849929</td><td>-0.04711669</td><td>-0.02678310</td><td>-0.04254686</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td> 0.0006311781</td><td>0.17288262</td><td> 0.002221652</td><td>-0.40198468</td><td> 0.02269052</td><td>-0.26568682</td><td> 0.0533086</td><td>-0.25407785</td><td> 0.01522195</td><td>-0.2560360</td><td>-0.09068553</td><td>-0.14449389</td><td> 0.01239496</td><td>-0.05603912</td></tr>
</tbody>
</table>
</dd>
</dl>




```R
summary(out1.tvecm)$StDev
# 区间标准差
```



<dl>
	<dt>$Bdown</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><td>0.1368918</td><td>0.1244208</td><td>0.1369572</td><td>0.06148470</td><td>0.1298209</td><td>0.06099476</td><td>0.1337304</td><td>0.06358623</td><td>0.1316331</td><td>0.05197240</td><td>0.09496876</td><td>0.05228088</td><td>0.07987648</td><td>0.03978523</td></tr>
	<tr><td>0.1988311</td><td>0.1807174</td><td>0.1989261</td><td>0.08930463</td><td>0.1885608</td><td>0.08859301</td><td>0.1942392</td><td>0.09235704</td><td>0.1911930</td><td>0.07548832</td><td>0.13793921</td><td>0.07593637</td><td>0.11601812</td><td>0.05778682</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bmiddle</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><td>0.06562591</td><td>0.01761976</td><td>0.05256854</td><td>0.03187895</td><td>0.05191616</td><td>0.03220363</td><td>0.04938107</td><td>0.03134162</td><td>0.04649401</td><td>0.02934686</td><td>0.04132805</td><td>0.02678162</td><td>0.02964229</td><td>0.02036634</td></tr>
	<tr><td>0.09531961</td><td>0.02559215</td><td>0.07635419</td><td>0.04630320</td><td>0.07540663</td><td>0.04677479</td><td>0.07172448</td><td>0.04552273</td><td>0.06753111</td><td>0.04262541</td><td>0.06002773</td><td>0.03889949</td><td>0.04305452</td><td>0.02958149</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bup</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><td>0.05336439</td><td>0.03391389</td><td>0.04699115</td><td>0.03180346</td><td>0.04705158</td><td>0.03245750</td><td>0.04535090</td><td>0.03045402</td><td>0.04146221</td><td>0.03028548</td><td>0.03628532</td><td>0.02682194</td><td>0.02747288</td><td>0.02300075</td></tr>
	<tr><td>0.07751013</td><td>0.04925888</td><td>0.06825321</td><td>0.04619355</td><td>0.06834097</td><td>0.04714352</td><td>0.06587079</td><td>0.04423353</td><td>0.06022259</td><td>0.04398873</td><td>0.05270331</td><td>0.03895804</td><td>0.03990352</td><td>0.03340788</td></tr>
</tbody>
</table>
</dd>
</dl>




```R
summary(out1.tvecm)$Pvalues
# 区间P值
```



<dl>
	<dt>$Bdown</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>7.932345e-01</td><td>1.379112e-05</td><td>0.01600362</td><td>0.04283891</td><td>0.10884642</td><td>0.36929349</td><td>0.8163510</td><td>0.03410761</td><td>0.008013109</td><td>0.6383161</td><td>0.75355506</td><td>0.8335421</td><td>0.383157599</td><td>0.1295748</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td>5.797839e-07</td><td>7.965314e-01</td><td>0.01292290</td><td>0.29998978</td><td>0.07401569</td><td>0.04203086</td><td>0.9141679</td><td>0.50471861</td><td>0.697116422</td><td>0.9364108</td><td>0.03691816</td><td>0.1645972</td><td>0.001673962</td><td>0.7707071</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bmiddle</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>1.174387e-03</td><td>0.003948805</td><td>3.558953e-30</td><td>8.581865e-01</td><td>2.357649e-17</td><td>4.466073e-01</td><td>2.457240e-11</td><td>8.759525e-01</td><td>1.380232e-06</td><td>8.455032e-01</td><td>0.001392701</td><td>1.936413e-01</td><td>0.001706602</td><td>9.300787e-01</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td>5.445639e-05</td><td>0.290154870</td><td>1.092598e-01</td><td>4.791802e-46</td><td>3.957767e-02</td><td>2.914780e-34</td><td>2.766991e-02</td><td>1.731601e-18</td><td>4.126585e-02</td><td>1.036477e-14</td><td>0.264842924</td><td>7.562235e-09</td><td>0.039784569</td><td>3.141410e-07</td></tr>
</tbody>
</table>
</dd>
	<dt>$Bup</dt>
		<dd><table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>7.041057e-14</td><td>0.0033734512</td><td>5.001943e-20</td><td>2.535815e-01</td><td>2.515949e-12</td><td>7.539681e-01</td><td>1.224840e-10</td><td>1.235670e-01</td><td>6.842435e-08</td><td>2.898427e-01</td><td>0.0001384527</td><td>0.0791026581</td><td>0.3297099</td><td>0.06446205</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td>9.935034e-01</td><td>0.0004567354</td><td>9.740360e-01</td><td>5.858944e-18</td><td>7.399030e-01</td><td>1.942774e-08</td><td>4.184265e-01</td><td>1.038852e-08</td><td>8.004738e-01</td><td>6.633041e-09</td><td>0.0854349630</td><td>0.0002127267</td><td>0.7561133</td><td>0.09358728</td></tr>
</tbody>
</table>
</dd>
</dl>




```R
summary(out1.tvecm)$coefficients$Bmiddle
#  观察中间区间的系数
```



<table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>-0.2132084</td><td> 0.05083225</td><td>-0.6081340</td><td> 0.005696829</td><td>-0.4432564</td><td> 0.02451359</td><td>-0.3311994</td><td>-0.004893006</td><td>-0.2250226</td><td>-0.005719111</td><td>-0.13224213</td><td> 0.03482251</td><td>-0.09309199</td><td> 0.001787244</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td> 0.3853530</td><td>-0.02707676</td><td>-0.1223279</td><td>-0.673550125</td><td>-0.1552795</td><td>-0.57973217</td><td>-0.1580268</td><td>-0.402588854</td><td>-0.1378934</td><td>-0.331748509</td><td>-0.06694726</td><td>-0.22554845</td><td>-0.08856633</td><td>-0.151721842</td></tr>
</tbody>
</table>




```R
summary(out1.tvecm)$StDev$Bmiddle
# 观察中间区间的标准差 
```



<table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><td>0.06562591</td><td>0.01761976</td><td>0.05256854</td><td>0.03187895</td><td>0.05191616</td><td>0.03220363</td><td>0.04938107</td><td>0.03134162</td><td>0.04649401</td><td>0.02934686</td><td>0.04132805</td><td>0.02678162</td><td>0.02964229</td><td>0.02036634</td></tr>
	<tr><td>0.09531961</td><td>0.02559215</td><td>0.07635419</td><td>0.04630320</td><td>0.07540663</td><td>0.04677479</td><td>0.07172448</td><td>0.04552273</td><td>0.06753111</td><td>0.04262541</td><td>0.06002773</td><td>0.03889949</td><td>0.04305452</td><td>0.02958149</td></tr>
</tbody>
</table>




```R
summary(out1.tvecm)$Pvalues$Bmiddle
# 观察中间区间的P值 
```



<table class="dataframe">
<caption>A matrix: 2 × 14 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>ECT</th><th scope=col>Const</th><th scope=col>risk.Aord t -1</th><th scope=col>risk.GDAX t -1</th><th scope=col>risk.Aord t -2</th><th scope=col>risk.GDAX t -2</th><th scope=col>risk.Aord t -3</th><th scope=col>risk.GDAX t -3</th><th scope=col>risk.Aord t -4</th><th scope=col>risk.GDAX t -4</th><th scope=col>risk.Aord t -5</th><th scope=col>risk.GDAX t -5</th><th scope=col>risk.Aord t -6</th><th scope=col>risk.GDAX t -6</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Equation risk.Aord</th><td>1.174387e-03</td><td>0.003948805</td><td>3.558953e-30</td><td>8.581865e-01</td><td>2.357649e-17</td><td>4.466073e-01</td><td>2.457240e-11</td><td>8.759525e-01</td><td>1.380232e-06</td><td>8.455032e-01</td><td>0.001392701</td><td>1.936413e-01</td><td>0.001706602</td><td>9.300787e-01</td></tr>
	<tr><th scope=row>Equation risk.GDAX</th><td>5.445639e-05</td><td>0.290154870</td><td>1.092598e-01</td><td>4.791802e-46</td><td>3.957767e-02</td><td>2.914780e-34</td><td>2.766991e-02</td><td>1.731601e-18</td><td>4.126585e-02</td><td>1.036477e-14</td><td>0.264842924</td><td>7.562235e-09</td><td>0.039784569</td><td>3.141410e-07</td></tr>
</tbody>
</table>




```R
beta_tvecm=out1.tvecm$model.specific$coint
#  取出协整向量对象，命名为 beta_tvecm
beta_tvecm
```


<table class="dataframe">
<caption>A matrix: 2 × 1 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>r1</th></tr>
</thead>
<tbody>
	<tr><th scope=row>risk.Aord</th><td> 1.000000</td></tr>
	<tr><th scope=row>risk.GDAX</th><td>-0.576634</td></tr>
</tbody>
</table>




```R
threshold=out1.tvecm$model.specific$Thresh
# 取出门限值对象，命名为 threshold
```
