```R
riben <- read.csv("C:/client/202102/尘（在做）4000/data/riben.csv", encoding='UTF-8')
hanguo <- read.csv("C:/client/202102/尘（在做）4000/data/hanguo.csv", encoding='UTF-8')
taiguo <- read.csv("C:/client/202102/尘（在做）4000/data/taiguo.csv", encoding='UTF-8')
malai <- read.csv("C:/client/202102/尘（在做）4000/data/malai.csv", encoding='UTF-8')
xinjiapo <- read.csv("C:/client/202102/尘（在做）4000/data/xinjiapo.csv", encoding='UTF-8')
feilvbin <- read.csv("C:/client/202102/尘（在做）4000/data/feilvbin.csv", encoding='UTF-8')
yuenan <- read.csv("C:/client/202102/尘（在做）4000/data/yuenan.csv", encoding='UTF-8')
aodaliya <- read.csv("C:/client/202102/尘（在做）4000/data/aodaliya.csv", encoding='UTF-8')
```


```R
df <- read.csv("C:/client/202102/尘（在做）4000/data/最终结果第二版.csv", encoding='UTF-8')
```

# ADF 检验


```R
library(tseries)
```

    Registered S3 method overwritten by 'quantmod':
      method            from
      as.zoo.data.frame zoo 
    
    


```R
adf.test(df[,2])
```

    Warning message in adf.test(df[, 2]):
    "p-value smaller than printed p-value"
    


    
    	Augmented Dickey-Fuller Test
    
    data:  df[, 2]
    Dickey-Fuller = -7.042, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    



```R
for ( i in seq(from=2, to=17, by=1)) {
  print(i)
  print(adf.test(df[,i]))
}
```

    [1] 2
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -7.042, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 3
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -6.8487, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 4
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -7.314, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 5
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -7.0668, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 6
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -6.9018, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 7
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -3.5751, Lag order = 13, p-value = 0.03506
    alternative hypothesis: stationary
    
    [1] 8
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -4.7984, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 9
    

    Warning message in adf.test(df[, i]):
    "p-value smaller than printed p-value"
    

    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -6.4582, Lag order = 13, p-value = 0.01
    alternative hypothesis: stationary
    
    [1] 10
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -2.0622, Lag order = 13, p-value = 0.552
    alternative hypothesis: stationary
    
    [1] 11
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -3.1592, Lag order = 13, p-value = 0.09493
    alternative hypothesis: stationary
    
    [1] 12
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.4518, Lag order = 13, p-value = 0.8104
    alternative hypothesis: stationary
    
    [1] 13
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.4602, Lag order = 13, p-value = 0.8068
    alternative hypothesis: stationary
    
    [1] 14
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.8638, Lag order = 13, p-value = 0.636
    alternative hypothesis: stationary
    
    [1] 15
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.7892, Lag order = 13, p-value = 0.6676
    alternative hypothesis: stationary
    
    [1] 16
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.9629, Lag order = 13, p-value = 0.594
    alternative hypothesis: stationary
    
    [1] 17
    
    	Augmented Dickey-Fuller Test
    
    data:  df[, i]
    Dickey-Fuller = -1.884, Lag order = 13, p-value = 0.6275
    alternative hypothesis: stationary
    
    

拒绝存在一个单位根的假设

# 描述统计


```R
library(psych)
```


```R
describe(df[,2:17])
```


<table class="dataframe">
<caption>A psych: 16 × 13</caption>
<thead>
	<tr><th></th><th scope=col>vars</th><th scope=col>n</th><th scope=col>mean</th><th scope=col>sd</th><th scope=col>median</th><th scope=col>trimmed</th><th scope=col>mad</th><th scope=col>min</th><th scope=col>max</th><th scope=col>range</th><th scope=col>skew</th><th scope=col>kurtosis</th><th scope=col>se</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>日本利率</th><td> 1</td><td>2343</td><td>   2.3800260</td><td> 0.790471354</td><td>   2.3890900</td><td>   2.3410317</td><td> 0.57295077</td><td>   0.5501800</td><td>  13.3298300</td><td> 12.77965000</td><td> 2.5493237</td><td>22.8499040</td><td>0.0163305192</td></tr>
	<tr><th scope=row>韩国利率</th><td> 2</td><td>2343</td><td>   0.6538906</td><td> 0.784868112</td><td>   0.7310000</td><td>   0.6719641</td><td> 0.64493100</td><td>  -1.4486000</td><td>  10.9540000</td><td> 12.40260000</td><td> 1.3126436</td><td>15.4605671</td><td>0.0162147606</td></tr>
	<tr><th scope=row>泰国利率</th><td> 3</td><td>2343</td><td>   0.6574804</td><td> 0.736609549</td><td>   0.6720000</td><td>   0.6701709</td><td> 0.59007480</td><td>  -1.1886000</td><td>  10.9440000</td><td> 12.13260000</td><td> 1.7150570</td><td>20.1766905</td><td>0.0152177764</td></tr>
	<tr><th scope=row>马来西亚利率</th><td> 4</td><td>2343</td><td>  -0.5994172</td><td> 0.755890997</td><td>  -0.6510000</td><td>  -0.6452857</td><td> 0.59897040</td><td>  -2.2180000</td><td>  10.1940000</td><td> 12.41200000</td><td> 2.7307369</td><td>25.1031184</td><td>0.0156161161</td></tr>
	<tr><th scope=row>新加坡利率</th><td> 5</td><td>2343</td><td>   1.9916120</td><td> 1.030618613</td><td>   1.9741000</td><td>   1.9511274</td><td> 0.84137550</td><td>  -0.8490000</td><td>  13.3891000</td><td> 14.23810000</td><td> 1.3833982</td><td> 9.5765804</td><td>0.0212917735</td></tr>
	<tr><th scope=row>菲律宾利率</th><td> 6</td><td>2343</td><td>  -0.5921216</td><td> 1.261175470</td><td>  -0.5230000</td><td>  -0.5969697</td><td> 1.12336602</td><td>  -4.0778000</td><td>  11.3502000</td><td> 15.42800000</td><td> 0.6059561</td><td> 4.7911465</td><td>0.0260548976</td></tr>
	<tr><th scope=row>越南利率</th><td> 7</td><td>2343</td><td>  -0.5761735</td><td> 2.307111699</td><td>  -0.4060000</td><td>  -0.3696125</td><td> 2.02671420</td><td> -12.4350000</td><td>  12.0740000</td><td> 24.50900000</td><td>-1.6280566</td><td> 6.3037700</td><td>0.0476631210</td></tr>
	<tr><th scope=row>澳大利亚利率</th><td> 8</td><td>2343</td><td>   0.5271940</td><td> 0.938089052</td><td>   0.6640000</td><td>   0.5562945</td><td> 0.85397760</td><td>  -1.9442000</td><td>  10.6940000</td><td> 12.63820000</td><td> 0.4308356</td><td> 6.6183209</td><td>0.0193801852</td></tr>
	<tr><th scope=row>人民币兑日元</th><td> 9</td><td>2343</td><td>  16.2271150</td><td> 1.783455160</td><td>  16.3172065</td><td>  16.2694696</td><td> 1.17120947</td><td>  12.0705888</td><td>  20.3728227</td><td>  8.30223385</td><td>-0.1743496</td><td> 0.3893306</td><td>0.0368447870</td></tr>
	<tr><th scope=row>人民币兑韩元</th><td>10</td><td>2343</td><td> 172.8353478</td><td> 6.390726773</td><td> 171.9900000</td><td> 172.5409333</td><td> 7.22026200</td><td> 161.0200000</td><td> 189.5300000</td><td> 28.51000000</td><td> 0.3702616</td><td>-0.7063256</td><td>0.1320274107</td></tr>
	<tr><th scope=row>人民币兑泰国泰铢</th><td>11</td><td>2343</td><td>   4.8990120</td><td> 0.350382058</td><td>   4.9100000</td><td>   4.9056667</td><td> 0.37065000</td><td>   4.1400000</td><td>   5.7100000</td><td>  1.57000000</td><td>-0.1581375</td><td>-0.6142009</td><td>0.0072386189</td></tr>
	<tr><th scope=row>人民币兑马来西亚</th><td>12</td><td>2343</td><td>   0.5815045</td><td> 0.054800757</td><td>   0.6021000</td><td>   0.5838355</td><td> 0.04240236</td><td>   0.4760000</td><td>   0.7028000</td><td>  0.22680000</td><td>-0.4640763</td><td>-1.0009994</td><td>0.0011321407</td></tr>
	<tr><th scope=row>人民币兑新加坡元</th><td>13</td><td>2343</td><td>   0.2044210</td><td> 0.006986791</td><td>   0.2033000</td><td>   0.2037340</td><td> 0.00607866</td><td>   0.1924000</td><td>   0.2259000</td><td>  0.03350000</td><td> 0.8252014</td><td> 0.1912038</td><td>0.0001443416</td></tr>
	<tr><th scope=row>人民币兑菲律宾比索</th><td>14</td><td>2343</td><td>   7.2573362</td><td> 0.389130736</td><td>   7.2302000</td><td>   7.2438822</td><td> 0.24329466</td><td>   6.5056000</td><td>   8.3295000</td><td>  1.82390000</td><td> 0.4439163</td><td> 0.3521159</td><td>0.0080391363</td></tr>
	<tr><th scope=row>人民币兑越南盾</th><td>15</td><td>2343</td><td>3399.3977166</td><td>84.813634050</td><td>3402.0000000</td><td>3395.5976000</td><td>92.66250000</td><td>3231.0000000</td><td>3637.0000000</td><td>406.00000000</td><td> 0.3076235</td><td>-0.5368475</td><td>1.7521832635</td></tr>
	<tr><th scope=row>人民币兑澳大利亚元</th><td>16</td><td>2343</td><td>   0.1924522</td><td> 0.021005729</td><td>   0.1988309</td><td>   0.1941168</td><td> 0.01665776</td><td>   0.1470653</td><td>   0.2453747</td><td>  0.09830938</td><td>-0.6878178</td><td>-0.5175529</td><td>0.0004339619</td></tr>
</tbody>
</table>



# 正态性检验


```R
library('fBasics')
```

    Loading required package: timeDate
    
    Loading required package: timeSeries
    
    
    Attaching package: 'timeSeries'
    
    
    The following object is masked from 'package:psych':
    
        outlier
    
    
    
    Attaching package: 'fBasics'
    
    
    The following object is masked from 'package:psych':
    
        tr
    
    
    


```R
# JB 统计量(正态性检验)
v <- colnames(df)[2:17]
for ( i in v) {
  print(i)
  print(normalTest(df$i, method="jb"))
}
```

    [1] "日本利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "韩国利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "泰国利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "马来西亚利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "新加坡利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "菲律宾利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "越南利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "澳大利亚利率"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑日元"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑韩元"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑泰国泰铢"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑马来西亚"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑新加坡元"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑菲律宾比索"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑越南盾"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    [1] "人民币兑澳大利亚元"
    
    Title:
     Jarque - Bera Normalality Test
    
    Test Results:
      STATISTIC:
      P VALUE:
    
    Description:
     Mon Mar 01 18:52:45 2021 by user: 13631
    
    

# 确定最优阶数


```R
# 确定滞后阶数
library(vars)
# VARselect(df[2:17], lag.max = 5, type="const")
```

    Loading required package: MASS
    
    Loading required package: strucchange
    
    Loading required package: zoo
    
    
    Attaching package: 'zoo'
    
    
    The following object is masked from 'package:timeSeries':
    
        time<-
    
    
    The following objects are masked from 'package:base':
    
        as.Date, as.Date.numeric
    
    
    Loading required package: sandwich
    
    Loading required package: urca
    
    Loading required package: lmtest
    
    


```R
# vv <- c(riben, hanguo, taiguo, malai, xinjiapo, feilvbin, yuenan, aodaliya)
VARselect(hanguo[,2:3])
```


<dl>
	<dt>$selection</dt>
		<dd><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>AIC(n)</dt><dd>10</dd><dt>HQ(n)</dt><dd>4</dd><dt>SC(n)</dt><dd>4</dd><dt>FPE(n)</dt><dd>10</dd></dl>
</dd>
	<dt>$criteria</dt>
		<dd><table class="dataframe">
<caption>A matrix: 4 × 10 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>1</th><th scope=col>2</th><th scope=col>3</th><th scope=col>4</th><th scope=col>5</th><th scope=col>6</th><th scope=col>7</th><th scope=col>8</th><th scope=col>9</th><th scope=col>10</th></tr>
</thead>
<tbody>
	<tr><th scope=row>AIC(n)</th><td>-3.35388183</td><td>-3.3686383</td><td>-3.37875945</td><td>-3.39971196</td><td>-3.39858213</td><td>-3.39593382</td><td>-3.40282889</td><td>-3.39986150</td><td>-3.40173651</td><td>-3.41100661</td></tr>
	<tr><th scope=row>HQ(n)</th><td>-3.34848967</td><td>-3.3596513</td><td>-3.36617774</td><td>-3.38353548</td><td>-3.37881087</td><td>-3.37256778</td><td>-3.37586808</td><td>-3.36930592</td><td>-3.36758615</td><td>-3.37326148</td></tr>
	<tr><th scope=row>SC(n)</th><td>-3.33908138</td><td>-3.3439708</td><td>-3.34422505</td><td>-3.35531060</td><td>-3.34431380</td><td>-3.33179851</td><td>-3.32882661</td><td>-3.31599226</td><td>-3.30800030</td><td>-3.30740343</td></tr>
	<tr><th scope=row>FPE(n)</th><td> 0.03494843</td><td> 0.0344365</td><td> 0.03408972</td><td> 0.03338289</td><td> 0.03342063</td><td> 0.03350926</td><td> 0.03327901</td><td> 0.03337791</td><td> 0.03331539</td><td> 0.03300799</td></tr>
</tbody>
</table>
</dd>
</dl>




```R
VARselect(taiguo[,2:3])
```


<dl>
	<dt>$selection</dt>
		<dd><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>AIC(n)</dt><dd>10</dd><dt>HQ(n)</dt><dd>5</dd><dt>SC(n)</dt><dd>4</dd><dt>FPE(n)</dt><dd>10</dd></dl>
</dd>
	<dt>$criteria</dt>
		<dd><table class="dataframe">
<caption>A matrix: 4 × 10 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>1</th><th scope=col>2</th><th scope=col>3</th><th scope=col>4</th><th scope=col>5</th><th scope=col>6</th><th scope=col>7</th><th scope=col>8</th><th scope=col>9</th><th scope=col>10</th></tr>
</thead>
<tbody>
	<tr><th scope=row>AIC(n)</th><td>-1.091416e+01</td><td>-1.092718e+01</td><td>-1.093324e+01</td><td>-1.095572e+01</td><td>-1.095945e+01</td><td>-1.095702e+01</td><td>-1.096020e+01</td><td>-1.095895e+01</td><td>-10.95846658</td><td>-1.096904e+01</td></tr>
	<tr><th scope=row>HQ(n)</th><td>-1.090877e+01</td><td>-1.091820e+01</td><td>-1.092066e+01</td><td>-1.093954e+01</td><td>-1.093968e+01</td><td>-1.093366e+01</td><td>-1.093324e+01</td><td>-1.092839e+01</td><td>-10.92431621</td><td>-1.093129e+01</td></tr>
	<tr><th scope=row>SC(n)</th><td>-1.089936e+01</td><td>-1.090252e+01</td><td>-1.089871e+01</td><td>-1.091132e+01</td><td>-1.090518e+01</td><td>-1.089289e+01</td><td>-1.088620e+01</td><td>-1.087508e+01</td><td>-10.86473036</td><td>-1.086544e+01</td></tr>
	<tr><th scope=row>FPE(n)</th><td> 1.819872e-05</td><td> 1.796322e-05</td><td> 1.785470e-05</td><td> 1.745790e-05</td><td> 1.739293e-05</td><td> 1.743515e-05</td><td> 1.737987e-05</td><td> 1.740157e-05</td><td>  0.00001741</td><td> 1.722689e-05</td></tr>
</tbody>
</table>
</dd>
</dl>



# 构建VAR(1) 模型


```R
# 日本
var.riben <- VAR(riben[2:3], p=2)
summary(var.riben)
riben.res <- residuals(var.riben)
riben.res <- data.frame(riben.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑日元, 日本利率 
    Deterministic variables: const 
    Sample size: 2341 
    Log Likelihood: 2145.511 
    Roots of the characteristic polynomial:
    0.9976 0.9171 0.1325 0.06928
    Call:
    VAR(y = riben[2:3], p = 2)
    
    
    Estimation results for equation 人民币兑日元: 
    ======================================= 
    人民币兑日元 = 人民币兑日元.l1 + 日本利率.l1 + 人民币兑日元.l2 + 日本利率.l2 + const 
    
                      Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1  1.0677548  0.0206470  51.715  < 2e-16 ***
    日本利率.l1      0.0026760  0.0063628   0.421 0.674105    
    人民币兑日元.l2 -0.0698991  0.0206267  -3.389 0.000714 ***
    日本利率.l2     -0.0009517  0.0063679  -0.149 0.881205    
    const            0.0321685  0.0179749   1.790 0.073642 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.08526 on 2336 degrees of freedom
    Multiple R-Squared: 0.9977,	Adjusted R-squared: 0.9977 
    F-statistic: 2.545e+05 on 4 and 2336 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 日本利率: 
    ===================================== 
    日本利率 = 人民币兑日元.l1 + 日本利率.l1 + 人民币兑日元.l2 + 日本利率.l2 + const 
    
                    Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1  0.04945    0.06668   0.742    0.458    
    日本利率.l1      1.04865    0.02055  51.035  < 2e-16 ***
    人民币兑日元.l2 -0.05385    0.06661  -0.808    0.419    
    日本利率.l2     -0.12085    0.02056  -5.877 4.78e-09 ***
    const            0.24206    0.05805   4.170 3.16e-05 ***
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2753 on 2336 degrees of freedom
    Multiple R-Squared: 0.8788,	Adjusted R-squared: 0.8786 
    F-statistic:  4236 on 4 and 2336 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑日元  日本利率
    人民币兑日元     0.007269 -0.000671
    日本利率        -0.000671  0.075808
    
    Correlation matrix of residuals:
                 人民币兑日元 日本利率
    人民币兑日元      1.00000 -0.02858
    日本利率         -0.02858  1.00000
    
    



```R
var.hanguo <- VAR(hanguo[2:3], p=1)
summary(var.hanguo)
hanguo.res <- residuals(var.hanguo)
hanguo.res <- data.frame(hanguo.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑韩元, 韩国利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: -2721.716 
    Roots of the characteristic polynomial:
    0.9939 0.9315
    Call:
    VAR(y = hanguo[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑韩元: 
    ======================================= 
    人民币兑韩元 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                     Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1  0.993334   0.002255 440.464  < 2e-16 ***
    韩国利率.l1     -0.018358   0.018363  -1.000  0.31756    
    const            1.158249   0.393088   2.947  0.00325 ** 
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.677 on 2339 degrees of freedom
    Multiple R-Squared: 0.9888,	Adjusted R-squared: 0.9888 
    F-statistic: 1.031e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 韩国利率: 
    ===================================== 
    韩国利率 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                      Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1 -0.0018889  0.0009221  -2.048   0.0406 *  
    韩国利率.l1      0.9320416  0.0075084 124.134   <2e-16 ***
    const            0.3708727  0.1607253   2.307   0.0211 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2768 on 2339 degrees of freedom
    Multiple R-Squared: 0.8758,	Adjusted R-squared: 0.8756 
    F-statistic:  8243 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑韩元  韩国利率
    人民币兑韩元    0.4583501 0.0004868
    韩国利率        0.0004868 0.0766278
    
    Correlation matrix of residuals:
                 人民币兑韩元 韩国利率
    人民币兑韩元     1.000000 0.002598
    韩国利率         0.002598 1.000000
    
    



```R
    var.taiguo <- VAR(taiguo[2:3], p=1)
    summary(var.taiguo)
    taiguo.res <- residuals(var.taiguo)
    taiguo.res <- data.frame(taiguo.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑泰国泰铢, 泰国利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: 6135.14 
    Roots of the characteristic polynomial:
    0.9993 0.9264
    Call:
    VAR(y = taiguo[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑泰国泰铢: 
    ========================================= 
    人民币兑泰国泰铢 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                         Estimate Std. Error  t value Pr(>|t|)    
    人民币兑泰国泰铢.l1 0.9993664  0.0009105 1097.564   <2e-16 ***
    泰国利率.l1         0.0004948  0.0004330    1.143    0.253    
    const               0.0026037  0.0044968    0.579    0.563    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.01541 on 2339 degrees of freedom
    Multiple R-Squared: 0.9981,	Adjusted R-squared: 0.9981 
    F-statistic: 6.041e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 泰国利率: 
    ===================================== 
    泰国利率 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑泰国泰铢.l1 -0.011157   0.016378  -0.681    0.496    
    泰国利率.l1          0.926286   0.007789 118.921   <2e-16 ***
    const                0.103108   0.080885   1.275    0.203    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2772 on 2339 degrees of freedom
    Multiple R-Squared: 0.8585,	Adjusted R-squared: 0.8584 
    F-statistic:  7097 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑泰国泰铢 泰国利率
    人民币兑泰国泰铢        0.0002375 0.000155
    泰国利率                0.0001550 0.076851
    
    Correlation matrix of residuals:
                     人民币兑泰国泰铢 泰国利率
    人民币兑泰国泰铢          1.00000  0.03629
    泰国利率                  0.03629  1.00000
    
    



```R
var.malai <- VAR(malai[2:3], p=1)
summary(var.malai)
malai.res <- residuals(var.malai)
malai.res <- data.frame(malai.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑马来西亚, 马来西亚利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: 10470.951 
    Roots of the characteristic polynomial:
    0.9987 0.9241
    Call:
    VAR(y = malai[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑马来西亚: 
    ========================================= 
    人民币兑马来西亚 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                          Estimate Std. Error  t value Pr(>|t|)    
    人民币兑马来西亚.l1  9.987e-01  9.425e-04 1059.619   <2e-16 ***
    马来西亚利率.l1     -4.613e-06  6.833e-05   -0.068    0.946    
    const                8.252e-04  5.409e-04    1.526    0.127    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.002409 on 2339 degrees of freedom
    Multiple R-Squared: 0.9981,	Adjusted R-squared: 0.9981 
    F-statistic: 6.042e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 马来西亚利率: 
    ======================================= 
    马来西亚利率 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑马来西亚.l1 -0.277358   0.108882  -2.547   0.0109 *  
    马来西亚利率.l1      0.924080   0.007894 117.067   <2e-16 ***
    const                0.115222   0.062487   1.844   0.0653 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2783 on 2339 degrees of freedom
    Multiple R-Squared: 0.8645,	Adjusted R-squared: 0.8644 
    F-statistic:  7464 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚        5.804e-06    4.861e-06
    马来西亚利率            4.861e-06    7.746e-02
    
    Correlation matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚         1.000000     0.007249
    马来西亚利率             0.007249     1.000000
    
    



```R
var.xinjiapo <- VAR(xinjiapo[2:3], p=1)
summary(var.xinjiapo)
xinjiapo.res <- residuals(var.xinjiapo)
xinjiapo.res <- data.frame(xinjiapo.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑新加坡元, 新加坡利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: 13672.437 
    Roots of the characteristic polynomial:
    0.9968 0.954
    Call:
    VAR(y = xinjiapo[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑新加坡元: 
    ========================================= 
    人民币兑新加坡元 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1 9.966e-01  1.654e-03 602.620   <2e-16 ***
    新加坡利率.l1       1.567e-05  1.122e-05   1.397   0.1626    
    const               6.646e-04  3.367e-04   1.974   0.0485 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.0005562 on 2339 degrees of freedom
    Multiple R-Squared: 0.9937,	Adjusted R-squared: 0.9937 
    F-statistic: 1.836e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 新加坡利率: 
    ====================================== 
    新加坡利率 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1  0.476690   0.913703   0.522    0.602    
    新加坡利率.l1        0.954173   0.006197 153.980   <2e-16 ***
    const               -0.007392   0.186018  -0.040    0.968    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3073 on 2339 degrees of freedom
    Multiple R-Squared: 0.9111,	Adjusted R-squared: 0.9111 
    F-statistic: 1.199e+04 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元        3.093e-07 -2.393e-06
    新加坡利率             -2.393e-06  9.442e-02
    
    Correlation matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元            1.000     -0.014
    新加坡利率                 -0.014      1.000
    
    



```R
var.feilvbin <- VAR(feilvbin[2:3], p=1)
summary(var.feilvbin)
feilvbin.res <- residuals(var.feilvbin)
feilvbin.res <- data.frame(feilvbin.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑菲律宾比索, 菲律宾利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: 5274.684 
    Roots of the characteristic polynomial:
    0.9978 0.9731
    Call:
    VAR(y = feilvbin[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑菲律宾比索: 
    ========================================== 
    人民币兑菲律宾比索 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1 0.9989909  0.0011577 862.901  < 2e-16 ***
    菲律宾利率.l1         0.0010502  0.0003572   2.940  0.00332 ** 
    const                 0.0081145  0.0083768   0.969  0.33280    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.02142 on 2339 degrees of freedom
    Multiple R-Squared: 0.997,	Adjusted R-squared: 0.997 
    F-statistic: 3.851e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 菲律宾利率: 
    ====================================== 
    菲律宾利率 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1 -0.030192   0.015561  -1.940   0.0525 .  
    菲律宾利率.l1          0.971861   0.004802 202.407   <2e-16 ***
    const                  0.202426   0.112593   1.798   0.0723 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2879 on 2339 degrees of freedom
    Multiple R-Squared: 0.9479,	Adjusted R-squared: 0.9479 
    F-statistic: 2.13e+04 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索          0.0004589  0.0001693
    菲律宾利率                  0.0001693  0.0828999
    
    Correlation matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索            1.00000    0.02745
    菲律宾利率                    0.02745    1.00000
    
    



```R
var.yuenan <- VAR(yuenan[2:3], p=1)
summary(var.yuenan)
yuenan.res <- residuals(var.yuenan)
yuenan.res <- data.frame(yuenan.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑越南盾, 越南利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: -9454.267 
    Roots of the characteristic polynomial:
    0.9966 0.9723
    Call:
    VAR(y = yuenan[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑越南盾: 
    ======================================== 
    人民币兑越南盾 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                       Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  0.996123   0.001734 574.425   <2e-16 ***
    越南利率.l1        0.151557   0.063719   2.379   0.0175 *  
    const             13.338296   5.906281   2.258   0.0240 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 6.867 on 2339 degrees of freedom
    Multiple R-Squared: 0.9935,	Adjusted R-squared: 0.9934 
    F-statistic: 1.775e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 越南利率: 
    ===================================== 
    越南利率 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  0.0000822  0.0001222   0.673    0.501    
    越南利率.l1        0.9728056  0.0044904 216.640   <2e-16 ***
    const             -0.2902951  0.4162278  -0.697    0.486    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.4839 on 2339 degrees of freedom
    Multiple R-Squared: 0.9557,	Adjusted R-squared: 0.9557 
    F-statistic: 2.523e+04 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        47.1542   0.1193
    越南利率               0.1193   0.2342
    
    Correlation matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        1.00000  0.03589
    越南利率              0.03589  1.00000
    
    



```R
var.aodaliya <- VAR(aodaliya[2:3], p=1)
summary(var.aodaliya)
aodaliya.res <- residuals(var.aodaliya)
aodaliya.res <- data.frame(aodaliya.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑澳大利亚元, 澳大利亚利率 
    Deterministic variables: const 
    Sample size: 2342 
    Log Likelihood: 12246.304 
    Roots of the characteristic polynomial:
    0.9978 0.9449
    Call:
    VAR(y = aodaliya[2:3], p = 1)
    
    
    Estimation results for equation 人民币兑澳大利亚元: 
    ========================================== 
    人民币兑澳大利亚元 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1 9.969e-01  1.221e-03 816.628   <2e-16 ***
    澳大利亚利率.l1       4.994e-05  2.733e-05   1.827   0.0678 .  
    const                 5.860e-04  2.305e-04   2.542   0.0111 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.001128 on 2339 degrees of freedom
    Multiple R-Squared: 0.9971,	Adjusted R-squared: 0.9971 
    F-statistic: 4.041e+05 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 澳大利亚利率: 
    ======================================= 
    澳大利亚利率 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1  0.922832   0.301241   3.063  0.00221 ** 
    澳大利亚利率.l1        0.945798   0.006745 140.219  < 2e-16 ***
    const                 -0.148433   0.056877  -2.610  0.00912 ** 
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2784 on 2339 degrees of freedom
    Multiple R-Squared: 0.9119,	Adjusted R-squared: 0.9119 
    F-statistic: 1.211e+04 on 2 and 2339 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元          1.273e-06   -4.430e-07
    澳大利亚利率               -4.430e-07    7.752e-02
    
    Correlation matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元            1.00000     -0.00141
    澳大利亚利率                 -0.00141      1.00000
    
    



```R

```

# DCC-GARCH 模型

### 构建模型


```R
library(rugarch)
library(rmgarch)
```

    Loading required package: parallel
    
    
    Attaching package: 'rugarch'
    
    
    The following object is masked from 'package:stats':
    
        sigma
    
    
    


```R
spec <- ugarchspec(variance.model = list(model = "sGARCH", 
                                         garchOrder = c(1, 1), 
                                         submodel = NULL, 
                                         external.regressors = NULL, 
                                         variance.targeting = FALSE), 

                   mean.model     = list(armaOrder = c(0, 0),
                                         include.mean=TRUE,
                                         external.regressors = NULL
                                         # distribution.model = "std"
#                                          start.pars = list(), 
#                                          fixed.pars = list()
                                        ))
```


```R
dcc_once=function(xx){
                  spec1 = spec
                  spec2 = spec
                  mspec = multispec( c( spec1, spec2 ) )
                  spec = dccspec(mspec, VAR = FALSE, robust = FALSE,external.regressors = NULL,
                                 dccOrder = c(1,1), model = "DCC", distribution = "mvnorm")
                  m1=dccfit(spec, xx, out.sample = 0, solver = "solnp", solver.control = list(),
fit.control = list(eval.se = TRUE, stationarity = TRUE, scale = FALSE),
cluster = NULL, fit = NULL, VAR.fit = NULL, realizedVol = NULL)
                  show(m1)
                  matcoef=m1@mfit$matcoef
                  rho=m1@mfit$R
                  n=length(rho)
                  rho.t=0
                  for(i in 1:n){
                          r=rho[[i]]
                  rho.t[i]=r[1,2]
                  }
                  return(rho.t)
}
```

### 拟合 DCC 模型


```R
dcc.riben <- dcc_once(riben.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2341
    Log-Likelihood       :  3960.424
    Av.Log-Likelihood    :  1.69 
    
    Optimal Parameters
    -----------------------------------
                           Estimate  Std. Error  t value Pr(>|t|)
    [人民币兑日元].mu      0.000000    0.002069  0.00000 1.000000
    [人民币兑日元].omega   0.000009    0.000008  1.03548 0.300443
    [人民币兑日元].alpha1  0.062978    0.013805  4.56192 0.000005
    [人民币兑日元].beta1   0.936016    0.014385 65.06708 0.000000
    [日本利率].mu          0.000000    0.025716  0.00000 1.000000
    [日本利率].omega       0.000086    0.000214  0.40161 0.687972
    [日本利率].alpha1      0.075330    0.016828  4.47640 0.000008
    [日本利率].beta1       0.912732    0.028716 31.78456 0.000000
    [Joint]dcca1           0.011159    0.006779  1.64624 0.099713
    [Joint]dccb1           0.950987    0.029240 32.52363 0.000000
    
    Information Criteria
    ---------------------
                        
    Akaike       -3.3741
    Bayes        -3.3471
    Shibata      -3.3742
    Hannan-Quinn -3.3643
    
    
    Elapsed time : 2.060674 
    
    


```R
dcc.hanguo <- dcc_once(hanguo.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  -1045.697
    Av.Log-Likelihood    :  -0.45 
    
    Optimal Parameters
    -----------------------------------
                           Estimate  Std. Error  t value Pr(>|t|)
    [人民币兑韩元].mu      0.000000    0.013722  0.00000 1.000000
    [人民币兑韩元].omega   0.000809    0.000721  1.12213 0.261807
    [人民币兑韩元].alpha1  0.052167    0.008942  5.83393 0.000000
    [人民币兑韩元].beta1   0.943730    0.009680 97.49108 0.000000
    [韩国利率].mu          0.000000    0.015801  0.00000 1.000000
    [韩国利率].omega       0.000080    0.000287  0.27949 0.779871
    [韩国利率].alpha1      0.059512    0.113458  0.52453 0.599909
    [韩国利率].beta1       0.903744    0.241206  3.74678 0.000179
    [Joint]dcca1           0.006605    0.015754  0.41926 0.675029
    [Joint]dccb1           0.602489    0.374639  1.60819 0.107794
    
    Information Criteria
    ---------------------
                        
    Akaike       0.90239
    Bayes        0.92944
    Shibata      0.90234
    Hannan-Quinn 0.91224
    
    
    Elapsed time : 1.826115 
    
    


```R
dcc.taiguo <- dcc_once(taiguo.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  7338.733
    Av.Log-Likelihood    :  3.13 
    
    Optimal Parameters
    -----------------------------------
                               Estimate  Std. Error   t value Pr(>|t|)
    [人民币兑泰国泰铢].mu      0.000000    0.001966  0.000000 1.000000
    [人民币兑泰国泰铢].omega   0.000000    0.000011  0.021032 0.983220
    [人民币兑泰国泰铢].alpha1  0.050875    0.090984  0.559161 0.576052
    [人民币兑泰国泰铢].beta1   0.900351    0.205127  4.389236 0.000011
    [泰国利率].mu              0.000000    0.004764  0.000000 1.000000
    [泰国利率].omega           0.000077    0.000069  1.123897 0.261057
    [泰国利率].alpha1          0.081625    0.017256  4.730166 0.000002
    [泰国利率].beta1           0.904597    0.022154 40.832462 0.000000
    [Joint]dcca1               0.000000    0.000002  0.000412 0.999671
    [Joint]dccb1               0.919375    0.058387 15.746300 0.000000
    
    Information Criteria
    ---------------------
                        
    Akaike       -6.2577
    Bayes        -6.2306
    Shibata      -6.2577
    Hannan-Quinn -6.2478
    
    
    Elapsed time : 1.59176 
    
    


```R
dcc.malai <- dcc_once(malai.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  11793.16
    Av.Log-Likelihood    :  5.04 
    
    Optimal Parameters
    -----------------------------------
                               Estimate  Std. Error   t value Pr(>|t|)
    [人民币兑马来西亚].mu      0.000000    0.000128  0.000000 1.000000
    [人民币兑马来西亚].omega   0.000000    0.000001  0.008688 0.993068
    [人民币兑马来西亚].alpha1  0.050007    0.004840 10.332658 0.000000
    [人民币兑马来西亚].beta1   0.900002    0.011531 78.051117 0.000000
    [马来西亚利率].mu          0.000000    0.003546  0.000000 1.000000
    [马来西亚利率].omega       0.000099    0.000089  1.115579 0.264602
    [马来西亚利率].alpha1      0.075439    0.036113  2.088941 0.036713
    [马来西亚利率].beta1       0.916729    0.045078 20.336568 0.000000
    [Joint]dcca1               0.000000    0.000177  0.000261 0.999792
    [Joint]dccb1               0.918922    0.172246  5.334950 0.000000
    
    Information Criteria
    ---------------------
                        
    Akaike       -10.062
    Bayes        -10.035
    Shibata      -10.062
    Hannan-Quinn -10.052
    
    
    Elapsed time : 1.538943 
    
    


```R
dcc.xinjiapo <- dcc_once(xinjiapo.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  14158.47
    Av.Log-Likelihood    :  6.05 
    
    Optimal Parameters
    -----------------------------------
                               Estimate  Std. Error   t value Pr(>|t|)
    [人民币兑新加坡元].mu      0.000000    0.000032  0.000000 1.000000
    [人民币兑新加坡元].omega   0.000000    0.000000  0.000919 0.999267
    [人民币兑新加坡元].alpha1  0.050001    0.006232  8.022867 0.000000
    [人民币兑新加坡元].beta1   0.900000    0.014628 61.524766 0.000000
    [新加坡利率].mu            0.000000    0.004869  0.000000 1.000000
    [新加坡利率].omega         0.000154    0.000168  0.915596 0.359879
    [新加坡利率].alpha1        0.060685    0.023817  2.548007 0.010834
    [新加坡利率].beta1         0.932357    0.032613 28.588671 0.000000
    [Joint]dcca1               0.000000    0.000031  0.000925 0.999262
    [Joint]dccb1               0.893649    0.180433  4.952792 0.000001
    
    Information Criteria
    ---------------------
                        
    Akaike       -12.082
    Bayes        -12.054
    Shibata      -12.082
    Hannan-Quinn -12.072
    
    
    Elapsed time : 1.636716 
    
    


```R
dcc.feilvbin <- dcc_once(feilvbin.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  6236.35
    Av.Log-Likelihood    :  2.66 
    
    Optimal Parameters
    -----------------------------------
                                 Estimate  Std. Error   t value Pr(>|t|)
    [人民币兑菲律宾比索].mu      0.000000    0.003391  0.000000 1.000000
    [人民币兑菲律宾比索].omega   0.000000    0.000005  0.095455 0.923954
    [人民币兑菲律宾比索].alpha1  0.050052    0.046220  1.082909 0.278849
    [人民币兑菲律宾比索].beta1   0.900019    0.106067  8.485357 0.000000
    [菲律宾利率].mu              0.000000    0.002198  0.000000 1.000000
    [菲律宾利率].omega           0.000114    0.000098  1.164674 0.244151
    [菲律宾利率].alpha1          0.075382    0.030905  2.439157 0.014722
    [菲律宾利率].beta1           0.917312    0.037667 24.353468 0.000000
    [Joint]dcca1                 0.000000    0.000719  0.000001 0.999999
    [Joint]dccb1                 0.942984    0.576847  1.634720 0.102108
    
    Information Criteria
    ---------------------
                        
    Akaike       -5.3163
    Bayes        -5.2892
    Shibata      -5.3163
    Hannan-Quinn -5.3064
    
    
    Elapsed time : 1.637884 
    
    


```R
dcc.yuenan <- dcc_once(yuenan.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  -9271.24
    Av.Log-Likelihood    :  -3.96 
    
    Optimal Parameters
    -----------------------------------
                             Estimate  Std. Error  t value Pr(>|t|)
    [人民币兑越南盾].mu      0.000000    0.011136  0.00000  1.00000
    [人民币兑越南盾].omega   0.272197    2.002303  0.13594  0.89187
    [人民币兑越南盾].alpha1  0.171457    1.257428  0.13636  0.89154
    [人民币兑越南盾].beta1   0.827459    6.265073  0.13207  0.89492
    [越南利率].mu            0.000000    0.012097  0.00000  1.00000
    [越南利率].omega         0.000281    0.000201  1.39767  0.16221
    [越南利率].alpha1        0.083594    0.020019  4.17561  0.00003
    [越南利率].beta1         0.911061    0.023965 38.01577  0.00000
    [Joint]dcca1             0.015529    0.016556  0.93800  0.34825
    [Joint]dccb1             0.859483    0.163822  5.24643  0.00000
    
    Information Criteria
    ---------------------
                       
    Akaike       7.9268
    Bayes        7.9538
    Shibata      7.9267
    Hannan-Quinn 7.9366
    
    
    Elapsed time : 1.998666 
    
    


```R
dcc.aodaliya <- dcc_once(aodaliya.res[1:2])
```

    
    *---------------------------------*
    *          DCC GARCH Fit          *
    *---------------------------------*
    
    Distribution         :  mvnorm
    Model                :  DCC(1,1)
    No. Parameters       :  11
    [VAR GARCH DCC UncQ] : [0+8+2+1]
    No. Series           :  2
    No. Obs.             :  2342
    Log-Likelihood       :  13441.05
    Av.Log-Likelihood    :  5.74 
    
    Optimal Parameters
    -----------------------------------
                                 Estimate  Std. Error   t value Pr(>|t|)
    [人民币兑澳大利亚元].mu      0.000000    0.000061  0.000000 1.000000
    [人民币兑澳大利亚元].omega   0.000000    0.000000  0.003237 0.997417
    [人民币兑澳大利亚元].alpha1  0.050002    0.004829 10.354579 0.000000
    [人民币兑澳大利亚元].beta1   0.900001    0.010979 81.974496 0.000000
    [澳大利亚利率].mu            0.000000    0.004978  0.000000 1.000000
    [澳大利亚利率].omega         0.000096    0.000102  0.942587 0.345892
    [澳大利亚利率].alpha1        0.079512    0.043614  1.823079 0.068291
    [澳大利亚利率].beta1         0.915362    0.051367 17.820004 0.000000
    [Joint]dcca1                 0.000000    0.000800  0.000005 0.999996
    [Joint]dccb1                 0.935642    0.486306  1.923977 0.054357
    
    Information Criteria
    ---------------------
                        
    Akaike       -11.469
    Bayes        -11.442
    Shibata      -11.469
    Hannan-Quinn -11.459
    
    
    Elapsed time : 1.737898 
    
    

# 动态相关性图


```R
plot(dcc.riben, type='l') + title("人民币对日元")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_42_1.png)
    



```R
plot(dcc.hanguo, type='l') + title("人民币对韩元")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_43_1.png)
    



```R
plot(dcc.taiguo, type='l') + title("人民币对泰铢")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_44_1.png)
    



```R
plot(dcc.malai, type='l') + title("人民币对马来西亚元")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_45_1.png)
    



```R
plot(dcc.xinjiapo, type='l') + title("人民币对新加坡元")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_46_1.png)
    



```R
plot(dcc.feilvbin, type='l') + title("人民币对菲律宾比索")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_47_1.png)
    



```R
plot(dcc.yuenan, type='l') + title("人民币对越南盾")

```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_48_1.png)
    



```R
plot(dcc.aodaliya, type='l') + title("人民币对澳大利亚元")
```






    
![png](%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_files/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A-Copy1_49_1.png)
    


# BEKK模型

### 2015年8月12日至2018年2月28日，“8·11”汇改后， 

样本在943之后为第二阶段，残差在944之后为第二阶段

## 第一阶段 VAR


```R
# 日本第一阶段
var.riben1 <- VAR(riben[1:943, 2:3], p=1)
summary(var.riben1)
riben1.res <- residuals(var.riben1)
riben1.res <- data.frame(riben1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑日元, 日本利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 494.556 
    Roots of the characteristic polynomial:
    0.9994 0.9189
    Call:
    VAR(y = riben[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑日元: 
    ======================================= 
    人民币兑日元 = 人民币兑日元.l1 + 日本利率.l1 + const 
    
                     Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1  0.999328   0.001179 847.690   <2e-16 ***
    日本利率.l1     -0.000680   0.002949  -0.231    0.818    
    const            0.020677   0.021909   0.944    0.346    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.08912 on 939 degrees of freedom
    Multiple R-Squared: 0.9987,	Adjusted R-squared: 0.9987 
    F-statistic: 3.708e+05 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 日本利率: 
    ===================================== 
    日本利率 = 人民币兑日元.l1 + 日本利率.l1 + const 
    
                     Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1 -0.005720   0.005165  -1.108   0.2683    
    日本利率.l1      0.918923   0.012918  71.134   <2e-16 ***
    const            0.309652   0.095982   3.226   0.0013 ** 
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3904 on 939 degrees of freedom
    Multiple R-Squared: 0.8483,	Adjusted R-squared: 0.848 
    F-statistic:  2626 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑日元  日本利率
    人民币兑日元     0.007942 -0.001802
    日本利率        -0.001802  0.152423
    
    Correlation matrix of residuals:
                 人民币兑日元 日本利率
    人民币兑日元      1.00000 -0.05179
    日本利率         -0.05179  1.00000
    
    



```R
var.hanguo1 <- VAR(hanguo[1:943, 2:3], p=1)
summary(var.hanguo1)
hanguo1.res <- residuals(var.hanguo1)
hanguo1.res <- data.frame(hanguo1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑韩元, 韩国利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: -1406.681 
    Roots of the characteristic polynomial:
    0.9932 0.9204
    Call:
    VAR(y = hanguo[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑韩元: 
    ======================================= 
    人民币兑韩元 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                    Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1 0.993181   0.003929 252.766   <2e-16 ***
    韩国利率.l1     0.005827   0.021834   0.267   0.7896    
    const           1.201941   0.692448   1.736   0.0829 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.6689 on 939 degrees of freedom
    Multiple R-Squared: 0.9856,	Adjusted R-squared: 0.9856 
    F-statistic: 3.21e+04 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 韩国利率: 
    ===================================== 
    韩国利率 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                      Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1  0.0007193  0.0022965   0.313    0.754    
    韩国利率.l1      0.9204950  0.0127610  72.133   <2e-16 ***
    const           -0.1011605  0.4047081  -0.250    0.803    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3909 on 939 degrees of freedom
    Multiple R-Squared: 0.8478,	Adjusted R-squared: 0.8475 
    F-statistic:  2615 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑韩元 韩国利率
    人民币兑韩元     0.447429 0.003528
    韩国利率         0.003528 0.152839
    
    Correlation matrix of residuals:
                 人民币兑韩元 韩国利率
    人民币兑韩元      1.00000  0.01349
    韩国利率          0.01349  1.00000
    
    



```R
var.taiguo1 <- VAR(taiguo[1:943, 2:3], p=1)
summary(var.taiguo1)
taiguo1.res <- residuals(var.taiguo1)
taiguo1.res <- data.frame(taiguo1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑泰国泰铢, 泰国利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 2084.287 
    Roots of the characteristic polynomial:
    0.999 0.9124
    Call:
    VAR(y = taiguo[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑泰国泰铢: 
    ========================================= 
    人民币兑泰国泰铢 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑泰国泰铢.l1 0.9981609  0.0025428 392.541   <2e-16 ***
    泰国利率.l1         0.0008060  0.0005667   1.422    0.155    
    const               0.0094345  0.0126862   0.744    0.457    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.01648 on 939 degrees of freedom
    Multiple R-Squared: 0.9944,	Adjusted R-squared: 0.9944 
    F-statistic: 8.4e+04 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 泰国利率: 
    ===================================== 
    泰国利率 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑泰国泰铢.l1  0.08607    0.06029   1.428    0.154    
    泰国利率.l1          0.91322    0.01343  67.977   <2e-16 ***
    const               -0.39320    0.30077  -1.307    0.191    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3907 on 939 degrees of freedom
    Multiple R-Squared: 0.8442,	Adjusted R-squared: 0.8439 
    F-statistic:  2545 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑泰国泰铢  泰国利率
    人民币兑泰国泰铢        0.0002716 0.0004122
    泰国利率                0.0004122 0.1526757
    
    Correlation matrix of residuals:
                     人民币兑泰国泰铢 泰国利率
    人民币兑泰国泰铢          1.00000  0.06401
    泰国利率                  0.06401  1.00000
    
    



```R
var.malai1 <- VAR(malai[1:943, 2:3], p=1)
summary(var.malai1)
malai1.res <- residuals(var.malai1)
malai1.res <- data.frame(malai1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑马来西亚, 马来西亚利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 3959.479 
    Roots of the characteristic polynomial:
    1.002 0.9165
    Call:
    VAR(y = malai[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑马来西亚: 
    ========================================= 
    人民币兑马来西亚 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                          Estimate Std. Error t value Pr(>|t|)    
    人民币兑马来西亚.l1  1.002e+00  2.052e-03 488.363   <2e-16 ***
    马来西亚利率.l1      2.772e-05  7.525e-05   0.368    0.713    
    const               -9.344e-04  1.073e-03  -0.871    0.384    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.002252 on 939 degrees of freedom
    Multiple R-Squared: 0.9963,	Adjusted R-squared: 0.9962 
    F-statistic: 1.249e+05 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 马来西亚利率: 
    ======================================= 
    马来西亚利率 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑马来西亚.l1 -0.59378    0.35552   -1.67   0.0952 .  
    马来西亚利率.l1      0.91627    0.01304   70.27   <2e-16 ***
    const                0.27512    0.18587    1.48   0.1392    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3901 on 939 degrees of freedom
    Multiple R-Squared: 0.8477,	Adjusted R-squared: 0.8474 
    F-statistic:  2614 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚        5.070e-06    3.055e-05
    马来西亚利率            3.055e-05    1.522e-01
    
    Correlation matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚          1.00000      0.03478
    马来西亚利率              0.03478      1.00000
    
    



```R
var.xinjiapo1 <- VAR(xinjiapo[1:943, 2:3], p=1)
summary(var.xinjiapo1)
xinjiapo1.res <- residuals(var.xinjiapo1)
xinjiapo1.res <- data.frame(xinjiapo1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑新加坡元, 新加坡利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 5224.075 
    Roots of the characteristic polynomial:
    0.9989 0.9212
    Call:
    VAR(y = xinjiapo[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑新加坡元: 
    ========================================= 
    人民币兑新加坡元 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1 9.990e-01  2.644e-03 377.825   <2e-16 ***
    新加坡利率.l1       4.090e-06  1.869e-05   0.219    0.827    
    const               1.996e-04  5.527e-04   0.361    0.718    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.0005807 on 939 degrees of freedom
    Multiple R-Squared: 0.9936,	Adjusted R-squared: 0.9936 
    F-statistic: 7.314e+04 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 新加坡利率: 
    ====================================== 
    新加坡利率 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1 -2.20597    1.79795  -1.227   0.2202    
    新加坡利率.l1        0.92106    0.01271  72.483   <2e-16 ***
    const                0.66671    0.37578   1.774   0.0764 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3949 on 939 degrees of freedom
    Multiple R-Squared: 0.8522,	Adjusted R-squared: 0.8519 
    F-statistic:  2707 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元        3.372e-07 -1.947e-07
    新加坡利率             -1.947e-07  1.559e-01
    
    Correlation matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元        1.0000000 -0.0008489
    新加坡利率             -0.0008489  1.0000000
    
    



```R
var.feilvbin1 <- VAR(feilvbin[1:943, 2:3], p=1)
summary(var.feilvbin1)
feilvbin1.res <- residuals(var.feilvbin1)
feilvbin1.res <- data.frame(feilvbin1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑菲律宾比索, 菲律宾利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 1941.762 
    Roots of the characteristic polynomial:
    0.9973 0.9424
    Call:
    VAR(y = feilvbin[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑菲律宾比索: 
    ========================================== 
    人民币兑菲律宾比索 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1 0.9944147  0.0024364 408.151  < 2e-16 ***
    菲律宾利率.l1         0.0017727  0.0005068   3.497 0.000492 ***
    const                 0.0392862  0.0170114   2.309 0.021137 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.01856 on 939 degrees of freedom
    Multiple R-Squared: 0.9956,	Adjusted R-squared: 0.9956 
    F-statistic: 1.054e+05 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 菲律宾利率: 
    ====================================== 
    菲律宾利率 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                          Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1  0.08473    0.05290   1.602     0.11    
    菲律宾利率.l1          0.94532    0.01100  85.901   <2e-16 ***
    const                 -0.59052    0.36935  -1.599     0.11    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.403 on 939 degrees of freedom
    Multiple R-Squared: 0.9094,	Adjusted R-squared: 0.9092 
    F-statistic:  4713 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索          0.0003445  0.0002276
    菲律宾利率                  0.0002276  0.1624034
    
    Correlation matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索            1.00000    0.03042
    菲律宾利率                    0.03042    1.00000
    
    



```R
var.yuenan1 <- VAR(yuenan[1:943, 2:3], p=1)
summary(var.yuenan1)
yuenan1.res <- residuals(var.yuenan1)
yuenan1.res <- data.frame(yuenan1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑越南盾, 越南利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: -3718.452 
    Roots of the characteristic polynomial:
    0.9967 0.9615
    Call:
    VAR(y = yuenan[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑越南盾: 
    ======================================== 
    人民币兑越南盾 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                       Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  0.994510   0.002323 428.197  < 2e-16 ***
    越南利率.l1        0.185175   0.056770   3.262  0.00115 ** 
    const             18.977315   7.934248   2.392  0.01696 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 4.532 on 939 degrees of freedom
    Multiple R-Squared: 0.9961,	Adjusted R-squared: 0.9961 
    F-statistic: 1.187e+05 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 越南利率: 
    ===================================== 
    越南利率 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  0.0003838  0.0003444   1.114    0.265    
    越南利率.l1        0.9636987  0.0084177 114.485   <2e-16 ***
    const             -1.3377902  1.1764724  -1.137    0.256    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.672 on 939 degrees of freedom
    Multiple R-Squared: 0.9477,	Adjusted R-squared: 0.9476 
    F-statistic:  8502 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        20.5416   0.1407
    越南利率               0.1407   0.4516
    
    Correlation matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        1.00000  0.04621
    越南利率              0.04621  1.00000
    
    



```R
var.aodaliya1 <- VAR(aodaliya[1:943, 2:3], p=1)
summary(var.aodaliya1)
aodaliya1.res <- residuals(var.aodaliya1)
aodaliya1.res <- data.frame(aodaliya1.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑澳大利亚元, 澳大利亚利率 
    Deterministic variables: const 
    Sample size: 942 
    Log Likelihood: 4604.386 
    Roots of the characteristic polynomial:
        1 0.9277
    Call:
    VAR(y = aodaliya[1:943, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑澳大利亚元: 
    ========================================== 
    人民币兑澳大利亚元 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1 9.995e-01  1.861e-03 537.117   <2e-16 ***
    澳大利亚利率.l1       4.034e-05  3.523e-05   1.145    0.253    
    const                 1.488e-04  3.266e-04   0.456    0.649    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.001129 on 939 degrees of freedom
    Multiple R-Squared: 0.997,	Adjusted R-squared: 0.997 
    F-statistic: 1.574e+05 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 澳大利亚利率: 
    ======================================= 
    澳大利亚利率 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                          Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1  0.87391    0.64629   1.352    0.177    
    澳大利亚利率.l1        0.92818    0.01224  75.857   <2e-16 ***
    const                 -0.15253    0.11344  -1.345    0.179    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.3922 on 939 degrees of freedom
    Multiple R-Squared: 0.8709,	Adjusted R-squared: 0.8707 
    F-statistic:  3168 on 2 and 939 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元          1.276e-06    0.0000159
    澳大利亚利率                1.590e-05    0.1538550
    
    Correlation matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元            1.00000      0.03588
    澳大利亚利率                  0.03588      1.00000
    
    


## 第二阶段 VAR


```R
dim(riben)
```


<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>2343</li><li>3</li></ol>




```R
# 日本第一阶段
var.riben2 <- VAR(riben[944:2343, 2:3], p=1)
summary(var.riben2)
riben2.res <- residuals(var.riben2)
riben2.res <- data.frame(riben2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑日元, 日本利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 2094.903 
    Roots of the characteristic polynomial:
    0.9935 0.948
    Call:
    VAR(y = riben[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑日元: 
    ======================================= 
    人民币兑日元 = 人民币兑日元.l1 + 日本利率.l1 + const 
    
                    Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1 0.993292   0.002179 455.848   <2e-16 ***
    日本利率.l1     0.002802   0.004481   0.625   0.5318    
    const           0.101365   0.036218   2.799   0.0052 ** 
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.08222 on 1396 degrees of freedom
    Multiple R-Squared: 0.9934,	Adjusted R-squared: 0.9934 
    F-statistic: 1.048e+05 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 日本利率: 
    ===================================== 
    日本利率 = 人民币兑日元.l1 + 日本利率.l1 + const 
    
                    Estimate Std. Error t value Pr(>|t|)    
    人民币兑日元.l1 0.003848   0.004231   0.909    0.363    
    日本利率.l1     0.948266   0.008702 108.970   <2e-16 ***
    const           0.047762   0.070330   0.679    0.497    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.1597 on 1396 degrees of freedom
    Multiple R-Squared: 0.8957,	Adjusted R-squared: 0.8956 
    F-statistic:  5997 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑日元  日本利率
    人民币兑日元    6.760e-03 3.175e-05
    日本利率        3.175e-05 2.549e-02
    
    Correlation matrix of residuals:
                 人民币兑日元 日本利率
    人民币兑日元     1.000000 0.002419
    日本利率         0.002419 1.000000
    
    



```R
var.hanguo2 <- VAR(hanguo[944:2343, 2:3], p=1)
summary(var.hanguo2)
hanguo2.res <- residuals(var.hanguo2)
hanguo2.res <- data.frame(hanguo2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑韩元, 韩国利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: -850.966 
    Roots of the characteristic polynomial:
    0.9905 0.9373
    Call:
    VAR(y = hanguo[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑韩元: 
    ======================================= 
    人民币兑韩元 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                     Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1  0.988704   0.003321 297.715  < 2e-16 ***
    韩国利率.l1     -0.065124   0.040196  -1.620 0.105422    
    const            1.971218   0.579880   3.399 0.000694 ***
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.681 on 1396 degrees of freedom
    Multiple R-Squared: 0.9864,	Adjusted R-squared: 0.9864 
    F-statistic: 5.07e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 韩国利率: 
    ===================================== 
    韩国利率 = 人民币兑韩元.l1 + 韩国利率.l1 + const 
    
                      Estimate Std. Error t value Pr(>|t|)    
    人民币兑韩元.l1 -0.0013793  0.0007721  -1.786   0.0742 .  
    韩国利率.l1      0.9390928  0.0093450 100.491   <2e-16 ***
    const            0.2885968  0.1348152   2.141   0.0325 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.1583 on 1396 degrees of freedom
    Multiple R-Squared: 0.893,	Adjusted R-squared: 0.8929 
    F-statistic:  5827 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                 人民币兑韩元   韩国利率
    人民币兑韩元    0.4637002 -0.0008318
    韩国利率       -0.0008318  0.0250633
    
    Correlation matrix of residuals:
                 人民币兑韩元  韩国利率
    人民币兑韩元     1.000000 -0.007716
    韩国利率        -0.007716  1.000000
    
    



```R
var.taiguo2 <- VAR(taiguo[944:2343, 2:3], p=1)
summary(var.taiguo2)
taiguo2.res <- residuals(var.taiguo2)
taiguo2.res <- data.frame(taiguo2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑泰国泰铢, 泰国利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 4509.303 
    Roots of the characteristic polynomial:
    0.9987 0.9304
    Call:
    VAR(y = taiguo[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑泰国泰铢: 
    ========================================= 
    人民币兑泰国泰铢 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑泰国泰铢.l1 0.9988509  0.0010067 992.183   <2e-16 ***
    泰国利率.l1         0.0007615  0.0009016   0.845    0.398    
    const               0.0042509  0.0050747   0.838    0.402    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.01463 on 1396 degrees of freedom
    Multiple R-Squared: 0.9986,	Adjusted R-squared: 0.9986 
    F-statistic: 5.154e+05 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 泰国利率: 
    ===================================== 
    泰国利率 = 人民币兑泰国泰铢.l1 + 泰国利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑泰国泰铢.l1 -0.014951   0.010985  -1.361   0.1737    
    泰国利率.l1          0.930250   0.009838  94.553   <2e-16 ***
    const                0.128195   0.055374   2.315   0.0208 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.1597 on 1396 degrees of freedom
    Multiple R-Squared: 0.871,	Adjusted R-squared: 0.8708 
    F-statistic:  4712 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑泰国泰铢  泰国利率
    人民币兑泰国泰铢        2.142e-04 1.963e-06
    泰国利率                1.963e-06 2.550e-02
    
    Correlation matrix of residuals:
                     人民币兑泰国泰铢 泰国利率
    人民币兑泰国泰铢          1.00000  0.00084
    泰国利率                  0.00084  1.00000
    
    



```R
var.malai2 <- VAR(malai[944:2343, 2:3], p=1)
summary(var.malai2)
malai2.res <- residuals(var.malai2)
malai2.res <- data.frame(malai2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑马来西亚, 马来西亚利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 6932.425 
    Roots of the characteristic polynomial:
    0.9934 0.9416
    Call:
    VAR(y = malai[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑马来西亚: 
    ========================================= 
    人民币兑马来西亚 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                          Estimate Std. Error t value Pr(>|t|)    
    人民币兑马来西亚.l1  9.933e-01  3.082e-03 322.294   <2e-16 ***
    马来西亚利率.l1     -5.335e-05  1.360e-04  -0.392   0.6950    
    const                4.124e-03  1.903e-03   2.167   0.0304 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.002508 on 1396 degrees of freedom
    Multiple R-Squared: 0.9869,	Adjusted R-squared: 0.9869 
    F-statistic: 5.259e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 马来西亚利率: 
    ======================================= 
    马来西亚利率 = 人民币兑马来西亚.l1 + 马来西亚利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑马来西亚.l1 -0.107459   0.202656  -0.530    0.596    
    马来西亚利率.l1      0.941667   0.008945 105.273   <2e-16 ***
    const                0.024693   0.125129   0.197    0.844    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.1649 on 1396 degrees of freedom
    Multiple R-Squared: 0.8894,	Adjusted R-squared: 0.8893 
    F-statistic:  5615 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚        6.290e-06   -1.097e-05
    马来西亚利率           -1.097e-05    2.720e-02
    
    Correlation matrix of residuals:
                     人民币兑马来西亚 马来西亚利率
    人民币兑马来西亚          1.00000     -0.02652
    马来西亚利率             -0.02652      1.00000
    
    



```R
var.xinjiapo2 <- VAR(xinjiapo[944:2343, 2:3], p=1)
summary(var.xinjiapo2)
xinjiapo2.res <- residuals(var.xinjiapo2)
xinjiapo2.res <- data.frame(xinjiapo2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑新加坡元, 新加坡利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 8652.064 
    Roots of the characteristic polynomial:
    0.9955 0.9305
    Call:
    VAR(y = xinjiapo[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑新加坡元: 
    ========================================= 
    人民币兑新加坡元 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1 9.943e-01  2.259e-03 440.159   <2e-16 ***
    新加坡利率.l1       3.545e-05  2.325e-05   1.525   0.1275    
    const               1.107e-03  4.502e-04   2.458   0.0141 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.0005362 on 1396 degrees of freedom
    Multiple R-Squared: 0.9937,	Adjusted R-squared: 0.9937 
    F-statistic: 1.106e+05 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 新加坡利率: 
    ====================================== 
    新加坡利率 = 人民币兑新加坡元.l1 + 新加坡利率.l1 + const 
    
                         Estimate Std. Error t value Pr(>|t|)    
    人民币兑新加坡元.l1  2.285033   0.950795   2.403   0.0164 *  
    新加坡利率.l1        0.931757   0.009786  95.213   <2e-16 ***
    const               -0.365475   0.189507  -1.929   0.0540 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2257 on 1396 degrees of freedom
    Multiple R-Squared: 0.8828,	Adjusted R-squared: 0.8826 
    F-statistic:  5256 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元        2.875e-07 -3.938e-06
    新加坡利率             -3.938e-06  5.093e-02
    
    Correlation matrix of residuals:
                     人民币兑新加坡元 新加坡利率
    人民币兑新加坡元          1.00000   -0.03254
    新加坡利率               -0.03254    1.00000
    
    



```R
var.feilvbin2 <- VAR(feilvbin[944:2343, 2:3], p=1)
summary(var.feilvbin2)
feilvbin2.res <- residuals(var.feilvbin2)
feilvbin2.res <- data.frame(feilvbin2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑菲律宾比索, 菲律宾利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 3790.587 
    Roots of the characteristic polynomial:
    0.9959 0.9871
    Call:
    VAR(y = feilvbin[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑菲律宾比索: 
    ========================================== 
    人民币兑菲律宾比索 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                          Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1 0.998324   0.001882 530.576   <2e-16 ***
    菲律宾利率.l1         0.001153   0.000618   1.866   0.0623 .  
    const                 0.013707   0.013897   0.986   0.3242    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.02313 on 1396 degrees of freedom
    Multiple R-Squared: 0.9953,	Adjusted R-squared: 0.9953 
    F-statistic: 1.48e+05 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 菲律宾利率: 
    ====================================== 
    菲律宾利率 = 人民币兑菲律宾比索.l1 + 菲律宾利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑菲律宾比索.l1 -0.023263   0.013745  -1.693   0.0908 .  
    菲律宾利率.l1          0.984692   0.004514 218.132   <2e-16 ***
    const                  0.157655   0.101517   1.553   0.1207    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.169 on 1396 degrees of freedom
    Multiple R-Squared: 0.973,	Adjusted R-squared: 0.9729 
    F-statistic: 2.514e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索          0.0005352  0.0001641
    菲律宾利率                  0.0001641  0.0285580
    
    Correlation matrix of residuals:
                       人民币兑菲律宾比索 菲律宾利率
    人民币兑菲律宾比索            1.00000    0.04197
    菲律宾利率                    0.04197    1.00000
    
    



```R
var.yuenan2 <- VAR(yuenan[944:2343, 2:3], p=1)
summary(var.yuenan2)
yuenan2.res <- residuals(var.yuenan2)
yuenan2.res <- data.frame(yuenan2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑越南盾, 越南利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: -5184.777 
    Roots of the characteristic polynomial:
    0.9966 0.9826
    Call:
    VAR(y = yuenan[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑越南盾: 
    ======================================== 
    人民币兑越南盾 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                      Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  0.99648    0.00236 422.319   <2e-16 ***
    越南利率.l1        0.14331    0.13181   1.087    0.277    
    const             12.05591    8.02214   1.503    0.133    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 8.072 on 1396 degrees of freedom
    Multiple R-Squared: 0.9924,	Adjusted R-squared: 0.9924 
    F-statistic: 9.083e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 越南利率: 
    ===================================== 
    越南利率 = 人民币兑越南盾.l1 + 越南利率.l1 + const 
    
                        Estimate Std. Error t value Pr(>|t|)    
    人民币兑越南盾.l1  1.306e-05  8.655e-05   0.151    0.880    
    越南利率.l1        9.828e-01  4.835e-03 203.258   <2e-16 ***
    const             -4.552e-02  2.943e-01  -0.155    0.877    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.2961 on 1396 degrees of freedom
    Multiple R-Squared: 0.9679,	Adjusted R-squared: 0.9678 
    F-statistic: 2.103e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        65.1612  0.10924
    越南利率               0.1092  0.08768
    
    Correlation matrix of residuals:
                   人民币兑越南盾 越南利率
    人民币兑越南盾        1.00000  0.04571
    越南利率              0.04571  1.00000
    
    



```R
var.aodaliya2 <- VAR(aodaliya[944:2343, 2:3], p=1)
summary(var.aodaliya2)
aodaliya2.res <- residuals(var.aodaliya2)
aodaliya2.res <- data.frame(aodaliya2.res)
```


    
    VAR Estimation Results:
    ========================= 
    Endogenous variables: 人民币兑澳大利亚元, 澳大利亚利率 
    Deterministic variables: const 
    Sample size: 1399 
    Log Likelihood: 8099.689 
    Roots of the characteristic polynomial:
    0.9919 0.9587
    Call:
    VAR(y = aodaliya[944:2343, 2:3], p = 1)
    
    
    Estimation results for equation 人民币兑澳大利亚元: 
    ========================================== 
    人民币兑澳大利亚元 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1 9.929e-01  3.424e-03 290.016   <2e-16 ***
    澳大利亚利率.l1       4.390e-05  5.288e-05   0.830   0.4067    
    const                 1.398e-03  7.155e-04   1.954   0.0509 .  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.001124 on 1396 degrees of freedom
    Multiple R-Squared: 0.9849,	Adjusted R-squared: 0.9849 
    F-statistic: 4.546e+04 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    Estimation results for equation 澳大利亚利率: 
    ======================================= 
    澳大利亚利率 = 人民币兑澳大利亚元.l1 + 澳大利亚利率.l1 + const 
    
                           Estimate Std. Error t value Pr(>|t|)    
    人民币兑澳大利亚元.l1 -0.824778   0.487269  -1.693   0.0907 .  
    澳大利亚利率.l1        0.957603   0.007527 127.230   <2e-16 ***
    const                  0.207101   0.101836   2.034   0.0422 *  
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    
    
    Residual standard error: 0.16 on 1396 degrees of freedom
    Multiple R-Squared: 0.9267,	Adjusted R-squared: 0.9266 
    F-statistic:  8828 on 2 and 1396 DF,  p-value: < 2.2e-16 
    
    
    
    Covariance matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元          1.264e-06   -1.183e-05
    澳大利亚利率               -1.183e-05    2.560e-02
    
    Correlation matrix of residuals:
                       人民币兑澳大利亚元 澳大利亚利率
    人民币兑澳大利亚元            1.00000     -0.06576
    澳大利亚利率                 -0.06576      1.00000
    
    


## 第一阶段的BEKK模型


```R
# riben
# hanguo
# taiguo
# malai
# xinjiapo
# feilvbin
# yuenan
# aodaliya
```


```R
library(mgarchBEKK)
```

    Loading required package: mvtnorm
    
    


```R
bekk1.riben <- BEKK(as.matrix(na.omit(riben1.res)))
diagnoseBEKK(bekk1.riben)
```

    

    Warning message in BEKK(as.matrix(na.omit(riben1.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.704461 
    	Total Time                 :  1.857058 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  2.22435 0.1748194 0.01576615 0.001719894 
    	aic                        :  -1096.516 
    	unconditional cov. matrix  :  0.002571925 -0.0009748696 -0.0009748696 -0.00550644 
    	var(resid 1 )                :  0.9991754 
    	mean(resid 1 )               :  0.001210601 
    	var(resid 2 )                :  1.017676 
    	mean(resid 2 )               :  0.0123748 
    	Estimated parameters       :
    
    	C estimates:
               [,1]        [,2]
    [1,] 0.08775329 -0.02339989
    [2,] 0.00000000  0.07080161
    
    	ARCH estimates:
                  [,1]       [,2]
    [1,] -0.0005106472 -0.3118805
    [2,] -0.0117928196  1.3955431
    
    	GARCH estimates:
               [,1]      [,2]
    [1,] 0.13536632 0.8942994
    [2,] 0.01657289 0.2583940
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                [,1]       [,2]
    [1,] 0.002633413 0.01303601
    [2,] 0.000000000 0.05231327
    
    	ARCH estimates, standard errors:
               [,1]       [,2]
    [1,] 0.05824887 0.07194232
    [2,] 0.01244984 0.08416802
    
    	GARCH estimates, standard errors:
               [,1]       [,2]
    [1,] 0.13642521 0.52435285
    [2,] 0.01071556 0.06155776
    Called from: diagnoseBEKK(bekk1.riben)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.hanguo <- BEKK(as.matrix(na.omit(hanguo1.res)))
diagnoseBEKK(bekk1.hanguo)
```

    

    Warning message in BEKK(as.matrix(na.omit(hanguo1.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.511983 
    	Total Time                 :  1.642568 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.625186 0.990983 0.5912968 0.5904174 
    	aic                        :  785.1041 
    	unconditional cov. matrix  :  0.5199545 0.02196874 0.02196874 -0.02315585 
    	var(resid 1 )                :  1.003798 
    	mean(resid 1 )               :  -0.008011272 
    	var(resid 2 )                :  1.01172 
    	mean(resid 2 )               :  0.02925518 
    	Estimated parameters       :
    
    	C estimates:
               [,1]        [,2]
    [1,] 0.07018301 -0.02122447
    [2,] 0.00000000 -0.11891847
    
    	ARCH estimates:
                [,1]       [,2]
    [1,]  0.22952915 0.01136352
    [2,] -0.01870148 1.23445264
    
    	GARCH estimates:
                [,1]         [,2]
    [1,] -0.96814494 -0.003967142
    [2,] -0.02594217 -0.317973363
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
               [,1]       [,2]
    [1,] 0.01550363 0.04920177
    [2,] 0.00000000 0.01285276
    
    	ARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.02177570 0.009103748
    [2,] 0.08383476 0.091597002
    
    	GARCH estimates, standard errors:
                [,1]        [,2]
    [1,] 0.005674694 0.009459835
    [2,] 0.051242777 0.089360557
    Called from: diagnoseBEKK(bekk1.hanguo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.taiguo <- BEKK(as.matrix(na.omit(taiguo1.res)))
diagnoseBEKK(bekk1.taiguo)
```

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.263541 
    	Total Time                 :  1.365366 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  3.496539 0.6899517 0.3382041 0.06913731 
    	aic                        :  -2631.541 
    	unconditional cov. matrix  :  -0.7321816 -0.05582534 -0.05582534 -0.09753605 
    	var(resid 1 )                :  1.013457 
    	mean(resid 1 )               :  -0.01194323 
    	var(resid 2 )                :  0.9701329 
    	mean(resid 2 )               :  0.02243267 
    	Estimated parameters       :
    
    	C estimates:
                [,1]        [,2]
    [1,] -0.01084179 -0.06435263
    [2,]  0.00000000  0.02691525
    
    	ARCH estimates:
                [,1]      [,2]
    [1,] 0.276414942 1.6508365
    [2,] 0.005508592 0.6569133
    
    	GARCH estimates:
               [,1]       [,2]
    [1,] 0.63173358  0.5448963
    [2,] 0.01838202 -0.7925409
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0009210279 0.01254395
    [2,] 0.0000000000 0.01956965
    
    	ARCH estimates, standard errors:
                [,1]        [,2]
    [1,] 0.056600043 0.503788923
    [2,] 0.001516721 0.005449119
    
    	GARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.059765771 0.62215486
    [2,] 0.005392375 0.03807659
    Called from: diagnoseBEKK(bekk1.taiguo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.malai <- BEKK(as.matrix(na.omit(malai1.res)))
diagnoseBEKK(bekk1.malai)
```

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.628128 
    	Total Time                 :  1.800667 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  295.4089 0.2519751 0.01447014 1.26714e-05 
    	aic                        :  -4521.11 
    	unconditional cov. matrix  :  -4.708809 -0.1959643 -0.1959643 -0.01212432 
    	var(resid 1 )                :  0.8628688 
    	mean(resid 1 )               :  0.003633323 
    	var(resid 2 )                :  0.8469882 
    	mean(resid 2 )               :  0.006011002 
    	Estimated parameters       :
    
    	C estimates:
                 [,1]       [,2]
    [1,] -0.002440852 0.04460064
    [2,]  0.000000000 0.10464239
    
    	ARCH estimates:
                 [,1]      [,2]
    [1,] 0.0537367798 13.879988
    [2,] 0.0005805015  1.386832
    
    	GARCH estimates:
                  [,1]        [,2]
    [1,] -0.1741968810 -10.0931274
    [2,]  0.0006018209   0.3333621
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 2.207286e-05 0.007730976
    [2,] 0.000000e+00 0.009476691
    
    	ARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0785008934 4.55887715
    [2,] 0.0003647348 0.07940711
    
    	GARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0391130598 4.74883244
    [2,] 0.0003770949 0.01805416
    Called from: diagnoseBEKK(bekk1.malai)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.xinjiapo <- BEKK(as.matrix(na.omit(xinjiapo1.res)))
diagnoseBEKK(bekk1.xinjiapo)
```

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.694332 
    	Total Time                 :  1.806099 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  60.11766 0.2095845 0.1366433 0.003646609 
    	aic                        :  -5495.329 
    	unconditional cov. matrix  :  -0.2164738 -0.01408498 -0.01408498 -0.002894207 
    	var(resid 1 )                :  0.566401 
    	mean(resid 1 )               :  0.003258581 
    	var(resid 2 )                :  0.9129549 
    	mean(resid 2 )               :  0.01039416 
    	Estimated parameters       :
    
    	C estimates:
                 [,1]        [,2]
    [1,] -0.000890907  0.01440046
    [2,]  0.000000000 -0.09357502
    
    	ARCH estimates:
                 [,1]     [,2]
    [1,]  0.083443277 1.019432
    [2,] -0.001754235 2.018605
    
    	GARCH estimates:
                  [,1]       [,2]
    [1,] -0.1590938012 -7.6586734
    [2,]  0.0001799268 -0.2387216
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 5.121772e-06 0.002617142
    [2,] 0.000000e+00 0.002043594
    
    	ARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0639217887 14.2462779
    [2,] 0.0004561925  0.2114164
    
    	GARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0431322272 5.76266636
    [2,] 0.0001349191 0.01833662
    Called from: diagnoseBEKK(bekk1.xinjiapo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.feilvbin <- BEKK(as.matrix(na.omit(feilvbin1.res)))
diagnoseBEKK(bekk1.feilvbin)
```

    

    Warning message in BEKK(as.matrix(na.omit(feilvbin1.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.770262 
    	Total Time                 :  1.894928 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  2.323661 0.2322088 0.1561225 0.01587626 
    	aic                        :  -2514.786 
    	unconditional cov. matrix  :  -0.1432893 -0.08526173 -0.08526173 -0.06740583 
    	var(resid 1 )                :  1.017639 
    	mean(resid 1 )               :  -0.001077439 
    	var(resid 2 )                :  0.9841306 
    	mean(resid 2 )               :  0.007496144 
    	Estimated parameters       :
    
    	C estimates:
               [,1]         [,2]
    [1,] 0.01783586 -0.009678291
    [2,] 0.00000000 -0.088739401
    
    	ARCH estimates:
               [,1]      [,2]
    [1,] 0.22597611 1.1564302
    [2,] 0.00661115 0.7934796
    
    	GARCH estimates:
                [,1]       [,2]
    [1,] 0.023258582 -0.1817963
    [2,] 0.003243469 -0.6934758
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 0.0004732503 0.006803761
    [2,] 0.0000000000 0.007243275
    
    	ARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.065259026 0.42567220
    [2,] 0.002904031 0.05364913
    
    	GARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.026750422 0.55648307
    [2,] 0.002425667 0.03116823
    Called from: diagnoseBEKK(bekk1.feilvbin)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.yuenan <- BEKK(as.matrix(na.omit(yuenan1.res)))
diagnoseBEKK(bekk1.yuenan)
```

    

    Warning message in BEKK(as.matrix(na.omit(yuenan1.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.76157 
    	Total Time                 :  1.880223 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.003261 0.5594622 0.4127994 0.4028067 
    	aic                        :  3512.809 
    	unconditional cov. matrix  :  21.39712 -1.628469 -1.628469 32.86982 
    	var(resid 1 )                :  0.9865379 
    	mean(resid 1 )               :  -0.0001868737 
    	var(resid 2 )                :  1.018968 
    	mean(resid 2 )               :  0.0249923 
    	Estimated parameters       :
    
    	C estimates:
             [,1]        [,2]
    [1,] 3.092724 0.007799518
    [2,] 0.000000 0.117537422
    
    	ARCH estimates:
               [,1]         [,2]
    [1,]  0.3637802  0.003066669
    [2,] -0.1612010 -0.450300911
    
    	GARCH estimates:
               [,1]         [,2]
    [1,] 0.64851104 -0.002276631
    [2,] 0.02770562  0.888269380
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
             [,1]      [,2]
    [1,] 0.319849 0.0250314
    [2,] 0.000000 0.0151608
    
    	ARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.05251143 0.004516699
    [2,] 0.23056611 0.044253604
    
    	GARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.08405213 0.006192716
    [2,] 0.15225678 0.018642143
    Called from: diagnoseBEKK(bekk1.yuenan)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk1.aodaliya <- BEKK(as.matrix(na.omit(aodaliya1.res)))
diagnoseBEKK(bekk1.aodaliya)
```

    	Number of estimated series :  1884 
    	Length of estimated series :  942 
    	Estimation Time            :  1.411057 
    	Total Time                 :  1.493839 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  6.679034 0.5783709 0.4266163 0.08849859 
    	aic                        :  -4984.295 
    	unconditional cov. matrix  :  -1.113179 -0.4075031 -0.4075031 -0.0961776 
    	var(resid 1 )                :  1.020587 
    	mean(resid 1 )               :  -0.002339752 
    	var(resid 2 )                :  0.6617226 
    	mean(resid 2 )               :  0.009497033 
    	Estimated parameters       :
    
    	C estimates:
                 [,1]       [,2]
    [1,] 0.0004119043 -0.1415524
    [2,] 0.0000000000 -0.1203850
    
    	ARCH estimates:
                  [,1]     [,2]
    [1,]  0.3944710056 2.007994
    [2,] -0.0009954621 1.124954
    
    	GARCH estimates:
                [,1]       [,2]
    [1,] 0.417313174 -1.3944635
    [2,] 0.003638814  0.3056122
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]       [,2]
    [1,] 8.093306e-05 0.00789105
    [2,] 0.000000e+00 0.01456745
    
    	ARCH estimates, standard errors:
                 [,1]      [,2]
    [1,] 0.0537813232 6.8220707
    [2,] 0.0002281959 0.1114118
    
    	GARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 8.053885e-02 6.98424414
    [2,] 3.882055e-05 0.05900035
    Called from: diagnoseBEKK(bekk1.aodaliya)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    

## 第二阶段的BEKK模型


```R
bekk2.riben <- BEKK(as.matrix(na.omit(riben2.res)))
diagnoseBEKK(bekk2.riben)
```

    

    Warning message in BEKK(as.matrix(na.omit(riben2.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  2.553034 
    	Total Time                 :  2.736508 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.17366 0.1494185 0.00527769 0.005119864 
    	aic                        :  -2942.639 
    	unconditional cov. matrix  :  0.006668211 -0.0001468762 -0.0001468762 -0.000168912 
    	var(resid 1 )                :  0.9976152 
    	mean(resid 1 )               :  0.001702312 
    	var(resid 2 )                :  1.007998 
    	mean(resid 2 )               :  0.03561487 
    	Estimated parameters       :
    
    	C estimates:
                [,1]         [,2]
    [1,] -0.07547957 9.050842e-05
    [2,]  0.00000000 6.241512e-05
    
    	ARCH estimates:
                [,1]         [,2]
    [1,]  0.29316876 -0.004348818
    [2,] -0.05510989  0.682643008
    
    	GARCH estimates:
                [,1]        [,2]
    [1,]  0.24486320  0.02935331
    [2,] -0.02320192 -0.84066811
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                [,1]         [,2]
    [1,] 0.006200493 0.0008076564
    [2,] 0.000000000 0.0011139639
    
    	ARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.04292003 0.006484071
    [2,] 0.01905663 0.030349919
    
    	GARCH estimates, standard errors:
               [,1]       [,2]
    [1,] 0.26521990 0.01068522
    [2,] 0.01770629 0.01037154
    Called from: diagnoseBEKK(bekk2.riben)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk2.hanguo <- BEKK(as.matrix(na.omit(hanguo2.res)))
diagnoseBEKK(bekk2.hanguo)
```

    

    Warning message in BEKK(as.matrix(na.omit(hanguo2.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  4.139505 
    	Total Time                 :  4.305062 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.110051 1.003249 0.9444488 0.9166573 
    	aic                        :  -29.12114 
    	unconditional cov. matrix  :  0.374864 -0.009171814 -0.009171814 -0.01374037 
    	var(resid 1 )                :  0.9920839 
    	mean(resid 1 )               :  0.006065986 
    	var(resid 2 )                :  1.016285 
    	mean(resid 2 )               :  0.02769202 
    	Estimated parameters       :
    
    	C estimates:
               [,1]          [,2]
    [1,] 0.05929532  0.0009047945
    [2,] 0.00000000 -0.0062416173
    
    	ARCH estimates:
                [,1]       [,2]
    [1,] -0.18684140 0.01162988
    [2,]  0.07615402 0.60978694
    
    	GARCH estimates:
                [,1]         [,2]
    [1,]  0.97760477  0.002115898
    [2,] -0.03401719 -0.848708665
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                [,1]        [,2]
    [1,] 0.009857372 0.007385933
    [2,] 0.000000000 0.003004480
    
    	ARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.01444380 0.001737961
    [2,] 0.06717161 0.031354935
    
    	GARCH estimates, standard errors:
                [,1]        [,2]
    [1,] 0.003265358 0.003033143
    [2,] 0.159014624 0.013131637
    Called from: diagnoseBEKK(bekk2.hanguo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R

bekk2.taiguo <- BEKK(as.matrix(na.omit(taiguo2.res)))
diagnoseBEKK(bekk2.taiguo)
```

    

    Warning message in BEKK(as.matrix(na.omit(taiguo2.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  1.929851 
    	Total Time                 :  2.091417 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.112731 0.06838819 0.06836143 0.02389747 
    	aic                        :  -5309.366 
    	unconditional cov. matrix  :  0.0002104703 -1.527147e-05 -1.527147e-05 -0.0006296729 
    	var(resid 1 )                :  0.9992889 
    	mean(resid 1 )               :  0.001812415 
    	var(resid 2 )                :  1.003601 
    	mean(resid 2 )               :  0.001463218 
    	Estimated parameters       :
    
    	C estimates:
               [,1]         [,2]
    [1,] -0.0143877 -0.001125323
    [2,]  0.0000000  0.008267684
    
    	ARCH estimates:
                 [,1]        [,2]
    [1,] -0.150755814 -0.03778612
    [2,]  0.008012495 -0.63699081
    
    	GARCH estimates:
                 [,1]        [,2]
    [1,]  0.033137622 -0.02834135
    [2,] -0.004328567 -0.83958833
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                [,1]         [,2]
    [1,] 0.000299637 0.0012123248
    [2,] 0.000000000 0.0009652896
    
    	ARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.051200689 0.07257565
    [2,] 0.004005356 0.03015435
    
    	GARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.033818200 0.23417611
    [2,] 0.003236828 0.01147366
    Called from: diagnoseBEKK(bekk2.taiguo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk2.malai <- BEKK(as.matrix(na.omit(malai2.res)))
diagnoseBEKK(bekk2.malai)

```

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  2.176795 
    	Total Time                 :  2.315654 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  9.883652 0.3743021 0.2534221 0.03970127 
    	aic                        :  -7425.53 
    	unconditional cov. matrix  :  -0.6991824 0.07568045 0.07568045 -0.03134788 
    	var(resid 1 )                :  0.8906026 
    	mean(resid 1 )               :  -0.006628632 
    	var(resid 2 )                :  0.8659394 
    	mean(resid 2 )               :  0.001943182 
    	Estimated parameters       :
    
    	C estimates:
                 [,1]         [,2]
    [1,] -0.002284236 -0.002227105
    [2,]  0.000000000  0.034363297
    
    	ARCH estimates:
                  [,1]       [,2]
    [1,] -0.5023692595  3.0289966
    [2,] -0.0005083292 -0.6147129
    
    	GARCH estimates:
                  [,1]      [,2]
    [1,]  0.0783782149 0.4169413
    [2,] -0.0009005838 0.8111183
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 1.860135e-05 0.002828106
    [2,] 0.000000e+00 0.004127334
    
    	ARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0389787275 1.04974005
    [2,] 0.0005008889 0.04036804
    
    	GARCH estimates, standard errors:
                 [,1]      [,2]
    [1,] 0.0819815260 0.3697922
    [2,] 0.0004077753 0.0231939
    Called from: diagnoseBEKK(bekk2.malai)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R

bekk2.xinjiapo <- BEKK(as.matrix(na.omit(xinjiapo2.res)))
diagnoseBEKK(bekk2.xinjiapo)
```

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  1.436264 
    	Total Time                 :  1.594906 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  27.76535 0.06511534 0.03434464 0.0004288887 
    	aic                        :  -8620.769 
    	unconditional cov. matrix  :  1.861977 0.1973444 0.1973444 0.06587972 
    	var(resid 1 )                :  1.243798 
    	mean(resid 1 )               :  -0.003368394 
    	var(resid 2 )                :  0.8114062 
    	mean(resid 2 )               :  0.001871386 
    	Estimated parameters       :
    
    	C estimates:
                  [,1]        [,2]
    [1,] -0.0003153982 -0.08085636
    [2,]  0.0000000000  0.16946982
    
    	ARCH estimates:
                  [,1]      [,2]
    [1,]  0.1197956286 0.7917126
    [2,] -0.0004774919 0.4950142
    
    	GARCH estimates:
                [,1]       [,2]
    [1,] 0.005734161 -5.1807042
    [2,] 0.001575140 -0.4749723
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]       [,2]
    [1,] 4.756762e-05 0.01155401
    [2,] 0.000000e+00 0.01341167
    
    	ARCH estimates, standard errors:
               [,1]        [,2]
    [1,] 0.03243526 16.12396977
    [2,] 0.00015316  0.04082323
    
    	GARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 1.362271e-02 3.56288920
    [2,] 4.943844e-05 0.02974239
    Called from: diagnoseBEKK(bekk2.xinjiapo)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk2.feilvbin <- BEKK(as.matrix(na.omit(feilvbin2.res)))
diagnoseBEKK(bekk2.feilvbin)
```

    

    Warning message in BEKK(as.matrix(na.omit(feilvbin2.res))):
    "negative inverted hessian matrix element"
    

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  2.904626 
    	Total Time                 :  3.086165 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  1.099843 0.1408907 0.1401865 0.05132397 
    	aic                        :  -4342.004 
    	unconditional cov. matrix  :  0.0005108434 7.318006e-05 7.318006e-05 -0.002559284 
    	var(resid 1 )                :  0.9978755 
    	mean(resid 1 )               :  -0.002019321 
    	var(resid 2 )                :  1.001024 
    	mean(resid 2 )               :  0.02599423 
    	Estimated parameters       :
    
    	C estimates:
               [,1]        [,2]
    [1,] 0.02247649 0.004054582
    [2,] 0.00000000 0.015436581
    
    	ARCH estimates:
                [,1]       [,2]
    [1,] 0.227883658  0.0756780
    [2,] 0.004741368 -0.6137753
    
    	GARCH estimates:
                  [,1]        [,2]
    [1,] -0.0006142617 -0.05847164
    [2,] -0.0082208717 -0.85033058
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 0.0004873701 0.002248717
    [2,] 0.0000000000 0.002416634
    
    	ARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.054796526 0.09208098
    [2,] 0.006200254 0.03454459
    
    	GARCH estimates, standard errors:
                [,1]       [,2]
    [1,] 0.042123963 0.23070113
    [2,] 0.005010707 0.01407802
    Called from: diagnoseBEKK(bekk2.feilvbin)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R

bekk2.yuenan <- BEKK(as.matrix(na.omit(yuenan2.res)))
diagnoseBEKK(bekk2.yuenan)
```

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  2.215661 
    	Total Time                 :  2.525798 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  10.99269 0.6283158 0.553983 0.05115681 
    	aic                        :  4982.959 
    	unconditional cov. matrix  :  78.44809 -753.2322 -753.2322 55643.95 
    	var(resid 1 )                :  0.9909346 
    	mean(resid 1 )               :  0.002886034 
    	var(resid 2 )                :  1.046866 
    	mean(resid 2 )               :  0.01146407 
    	Estimated parameters       :
    
    	C estimates:
             [,1]         [,2]
    [1,] 4.708315 0.0530367606
    [2,] 0.000000 0.0005177155
    
    	ARCH estimates:
               [,1]          [,2]
    [1,]  0.2846249 -0.0002356446
    [2,] -2.9965207 -0.4213345927
    
    	GARCH estimates:
               [,1]         [,2]
    [1,]  0.7547883 -0.003802509
    [2,] -1.2824128  0.900236184
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
              [,1]        [,2]
    [1,] 0.3977305 0.002123276
    [2,] 0.0000000 0.011168316
    
    	ARCH estimates, standard errors:
               [,1]         [,2]
    [1,] 0.04249229 0.0002181941
    [2,] 0.83794929 0.0358935132
    
    	GARCH estimates, standard errors:
               [,1]         [,2]
    [1,] 0.04482145 0.0005932548
    [2,] 0.37767516 0.0104153296
    Called from: diagnoseBEKK(bekk2.yuenan)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R
bekk2.aodaliya <- BEKK(as.matrix(na.omit(aodaliya2.res)))
diagnoseBEKK(bekk2.aodaliya)
```

    	Number of estimated series :  2798 
    	Length of estimated series :  1399 
    	Estimation Time            :  2.542353 
    	Total Time                 :  2.678988 
    	BEKK order                 :  1 1 
    	Eigenvalues                :  668.2797 0.7731699 0.1661703 0.0001987281 
    	aic                        :  -8348.298 
    	unconditional cov. matrix  :  107.5799 0.6368263 0.6368263 0.06564011 
    	var(resid 1 )                :  1.039177 
    	mean(resid 1 )               :  -0.007034667 
    	var(resid 2 )                :  0.8383821 
    	mean(resid 2 )               :  -0.03465708 
    	Estimated parameters       :
    
    	C estimates:
                  [,1]        [,2]
    [1,] -0.0004356451 -0.01693928
    [2,]  0.0000000000 -0.05955040
    
    	ARCH estimates:
                 [,1]       [,2]
    [1,]  0.428228476 -2.6756931
    [2,] -0.003363971 -0.7024727
    
    	GARCH estimates:
                 [,1]        [,2]
    [1,] -0.515715605 -25.6984215
    [2,]  0.005838454  -0.6320364
    
    	asy.se.coef                : 
    
    	C estimates, standard errors:
                 [,1]        [,2]
    [1,] 7.187508e-05 0.003955610
    [2,] 0.000000e+00 0.004385803
    
    	ARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0425798973 2.85003548
    [2,] 0.0003791898 0.03539318
    
    	GARCH estimates, standard errors:
                 [,1]       [,2]
    [1,] 0.0243393130 3.82720873
    [2,] 0.0001987213 0.02591883
    Called from: diagnoseBEKK(bekk2.aodaliya)
    debug: dev.off()
    debug: plot(estimation$residuals[[i]])
    debug: browser()
    debug: dev.off()
    


```R

```

# mts Bekk


```R
library(MTS)
```

    
    Attaching package: 'MTS'
    
    
    The following object is masked from 'package:vars':
    
        VAR
    
    
    

# 第一阶段


```R
# mla1.riben <- BEKK11(na.omit(riben1.res))
```


```R
# mla1.hanguo <- BEKK11(na.omit(hanguo1.res))
```


```R
# mla1.taiguo <- BEKK11(na.omit(taiguo1.res))
```


```R
# mla1.malai <- BEKK11(na.omit(malai1.res))
```


```R
# mla1.xinjiapo <- BEKK11(na.omit(xinjiapo1.res))
```


```R
# mla1.feilvbin <- BEKK11(na.omit(feilvbin1.res))
```


```R
# mla1.yuenan <- BEKK11(na.omit(yuenan1.res))
```


```R
# mla1.aodaliya <- BEKK11(na.omit(aodaliya1.res))
```

# 第二阶段


```R

```


```R
# riben
# hanguo
# taiguo
# malai
# xinjiapo
# feilvbin
# yuenan
# aodaliya
```
