```python
import pandas as pd
import numpy as np
```


```python
%config InlineBackend.figure_format = 'svg'
```


```python
import matplotlib.pyplot as plt
# 中文乱码
plt.rcParams['font.sans-serif']=['SimHei'] #用来正常显示中文标签
plt.rcParams['axes.unicode_minus']=False #用来正常显示负号
```


```python
paths = [
    "data/STK_MKT_THRFACMONTH.xlsx",
    "data/STK_MKT_THRFACWEEK.xlsx"
]
```


```python
df_week = pd.read_excel(paths[1])
df_month = pd.read_excel(paths[0])
```

    c:\users\13631\appdata\local\programs\python\python38\lib\site-packages\openpyxl\styles\stylesheet.py:221: UserWarning: Workbook contains no default style, apply openpyxl's default
      warn("Workbook contains no default style, apply openpyxl's default")
    


```python
df_week.columns = df_week.loc[0]
df_month.columns = df_month.loc[0]
```


```python
df_week = df_week.drop([0, 1], axis=0)
df_month = df_month.drop([0, 1], axis=0)
```


```python
# df_week['交易周份'] = pd.to_datetime(df_week['交易周份'])
# df_month['交易月份'] = pd.to_datetime(df_month['交易月份'])
```


```python
df_week['股票市场类型编码'].unique()
```




    array(['P9706', 'P9710', 'P9709', 'P9712', 'P9713', 'P9714', 'P9715',
           'P9707', 'P9705', 'P9711'], dtype=object)




```python
df_week_P9709 = df_week[df_week['股票市场类型编码'] == 'P9712'].copy()
```


```python
df_week_P9709.columns
```




    Index(['股票市场类型编码', '交易周份', '市场风险溢价因子(流通市值加权)', '市场风险溢价因子(总市值加权)',
           '市值因子(流通市值加权)', '市值因子(总市值加权)', '账面市值比因子(流通市值加权)', '账面市值比因子(总市值加权)'],
          dtype='object', name=0)




```python
df_month_P9709 = df_month[df_month['股票市场类型编码'] == 'P9712'].copy()
```


```python
(df_week_P9709.set_index("交易周份")['市场风险溢价因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efa38ee80>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_12_1.svg)



```python
(df_week_P9709.set_index("交易周份")['市值因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efa37ae50>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_13_1.svg)



```python
(df_week_P9709.set_index("交易周份")['账面市值比因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efa3ee820>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_14_1.svg)



```python
(df_month_P9709.set_index("交易月份")['市场风险溢价因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efa49cd30>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_15_1.svg)



```python
(df_month_P9709.set_index("交易月份")['市值因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))

```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efa49f7c0>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_16_1.svg)



```python
(df_month_P9709.set_index("交易月份")['账面市值比因子(流通市值加权)']+1).cumprod().plot(figsize=(10, 7))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x15efb6f9970>




![svg](%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_files/%E5%9B%A0%E5%AD%90%E6%BA%A2%E4%BB%B7_17_1.svg)



```python
df_month_P9709
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>股票市场类型编码</th>
      <th>交易月份</th>
      <th>市场风险溢价因子(流通市值加权)</th>
      <th>市场风险溢价因子（总市值加权）</th>
      <th>市值因子(流通市值加权)</th>
      <th>市值因子(总市值加权)</th>
      <th>账面市值比因子(流通市值加权)</th>
      <th>账面市值比因子(总市值加权)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>P9712</td>
      <td>1990-12</td>
      <td>-0.0036</td>
      <td>-0.0036</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>P9712</td>
      <td>1991-01</td>
      <td>0.0044</td>
      <td>0.0044</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>P9712</td>
      <td>1991-02</td>
      <td>0.0074</td>
      <td>0.0034</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>P9712</td>
      <td>1991-03</td>
      <td>-0.0246</td>
      <td>0.1114</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>33</th>
      <td>P9712</td>
      <td>1991-04</td>
      <td>-0.0477</td>
      <td>-0.0347</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3025</th>
      <td>P9712</td>
      <td>2020-12</td>
      <td>0.016083</td>
      <td>0.015083</td>
      <td>-0.037501</td>
      <td>-0.04036</td>
      <td>-0.055282</td>
      <td>-0.060608</td>
    </tr>
    <tr>
      <th>3035</th>
      <td>P9712</td>
      <td>2021-01</td>
      <td>-0.000917</td>
      <td>0.000083</td>
      <td>-0.074607</td>
      <td>-0.07079</td>
      <td>-0.00887</td>
      <td>-0.007218</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>P9712</td>
      <td>2021-02</td>
      <td>0.009083</td>
      <td>0.005083</td>
      <td>0.023962</td>
      <td>0.020375</td>
      <td>0.037474</td>
      <td>0.037782</td>
    </tr>
    <tr>
      <th>3055</th>
      <td>P9712</td>
      <td>2021-03</td>
      <td>-0.022917</td>
      <td>-0.024917</td>
      <td>0.062785</td>
      <td>0.0612</td>
      <td>0.039101</td>
      <td>0.037314</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>P9712</td>
      <td>2021-04</td>
      <td>0.004083</td>
      <td>0.005083</td>
      <td>0.011549</td>
      <td>0.008608</td>
      <td>-0.02756</td>
      <td>-0.032847</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 8 columns</p>
</div>




```python

```


```python

```


```python

```
