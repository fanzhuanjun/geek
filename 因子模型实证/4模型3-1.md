```python
import numpy as np
import pandas as pd
import os
```


```python
factor_df = pd.read_excel("五因子数据.xlsx")
factor_df = factor_df.rename(columns={"时间" : "日期"})
```


```python
factor_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>SMB</th>
      <th>HML</th>
      <th>CMA</th>
      <th>RMW</th>
      <th>mk_rf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>1.776700</td>
      <td>-2.048085</td>
      <td>-3.020902</td>
      <td>-3.910493</td>
      <td>4.985</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>2.161310</td>
      <td>-3.355225</td>
      <td>-2.356352</td>
      <td>-3.563212</td>
      <td>0.555</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>2.768764</td>
      <td>-0.595435</td>
      <td>-0.795055</td>
      <td>-0.294096</td>
      <td>-3.895</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>2.368923</td>
      <td>0.203406</td>
      <td>-1.691315</td>
      <td>-2.593286</td>
      <td>3.545</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>0.514857</td>
      <td>0.213481</td>
      <td>0.095284</td>
      <td>-0.527789</td>
      <td>6.015</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.read_excel("数据整理_2.xlsx")
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 468906 entries, 0 to 468905
    Data columns (total 43 columns):
     #   Column                 Non-Null Count   Dtype         
    ---  ------                 --------------   -----         
     0   证券名称                   468906 non-null  object        
     1   证券代码                   468906 non-null  object        
     2   日期                     468906 non-null  datetime64[ns]
     3   12个月换手率                468883 non-null  float64       
     4   20日换手率                 468883 non-null  float64       
     5   PB                     468904 non-null  float64       
     6   ROA                    462750 non-null  float64       
     7   ROE                    468850 non-null  float64       
     8   动量11                   466135 non-null  float64       
     9   动量6                    452273 non-null  float64       
     10  市值                     468906 non-null  float64       
     11  年化波动率                  402545 non-null  float64       
     12  总资产增长率                 465130 non-null  float64       
     13  收益率                    468906 non-null  float64       
     14  收盘价                    468906 non-null  float64       
     15  账面市值比                  468020 non-null  float64       
     16  12个月换手率_winsorized     468906 non-null  float64       
     17  20日换手率_winsorized      468906 non-null  float64       
     18  PB_winsorized          468906 non-null  float64       
     19  ROA_winsorized         463173 non-null  float64       
     20  ROE_winsorized         468906 non-null  float64       
     21  动量11_winsorized        467478 non-null  float64       
     22  动量6_winsorized         452414 non-null  float64       
     23  市值_winsorized          468906 non-null  float64       
     24  年化波动率_winsorized       402545 non-null  float64       
     25  总资产增长率_winsorized      465229 non-null  float64       
     26  收盘价_winsorized         468906 non-null  float64       
     27  账面市值比_winsorized       468149 non-null  float64       
     28  MonRf                  468906 non-null  float64       
     29  mk_rf                  468906 non-null  float64       
     30  收益率_rf                 468906 non-null  float64       
     31  groupby_市值_winsorized  468906 non-null  int64         
     32  groupby_市值             468906 non-null  int64         
     33  groupby_ROE            468850 non-null  float64       
     34  groupby_账面市值比          468020 non-null  float64       
     35  groupby_总资产增长率         465130 non-null  float64       
     36  group5by_市值            468906 non-null  int64         
     37  group5by_账面市值比         468020 non-null  float64       
     38  group5by_ROE           468850 non-null  float64       
     39  group5by_总资产增长率        465130 non-null  float64       
     40  group_市值_账面市值比         468020 non-null  float64       
     41  group_市值_ROE           468850 non-null  float64       
     42  group_市值_总资产增长率        465130 non-null  float64       
    dtypes: datetime64[ns](1), float64(37), int64(3), object(2)
    memory usage: 153.8+ MB
    


```python
portfolio_df = pd.DataFrame()
for col in ['group_市值_账面市值比', 'group_市值_ROE', 'group_市值_总资产增长率']:
    _ = data.groupby(["日期", col])['收益率_rf'].mean().reset_index()
    _[col] = _[col].apply(lambda x: col + '_' + str(x))
    _.columns = ['日期', '投资组合', '收益率_rf']
    portfolio_df = portfolio_df.append(_)
```


```python
len(portfolio_df.投资组合.unique())
```




    75




```python
portfolio_df_f = portfolio_df.merge(factor_df, on='日期', how='left').dropna()
```

# FM两步回归


```python
import statsmodels.api as sm

def get_OLS(X, y):
    X = sm.add_constant(X)
    mod = sm.OLS(y, X)
    res = mod.fit()
    return res
```


```python
factor_ex = []

for i in list(portfolio_df_f['投资组合'].unique()):
    _ = portfolio_df_f[portfolio_df_f['投资组合'] == i].copy().dropna(subset=['SMB', 'HML', 'CMA', 'RMW', 'mk_rf', '收益率_rf'])
    X = _[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
    y = _['收益率_rf']
    res = get_OLS(X, y)
    
    n = [i, *list(res.params.values)]
    factor_ex.append(n)
```


```python
df_ex = pd.DataFrame(factor_ex, columns=['投资组合', 'const', 'SMB_beta', 'HML_beta', 'CMA_beta', 'RMW_beta', 'mk_rf_beta'])
```


```python
df_ex
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>投资组合</th>
      <th>const</th>
      <th>SMB_beta</th>
      <th>HML_beta</th>
      <th>CMA_beta</th>
      <th>RMW_beta</th>
      <th>mk_rf_beta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>group_市值_账面市值比_11.0</td>
      <td>-1.181383</td>
      <td>0.418788</td>
      <td>-0.558641</td>
      <td>0.032211</td>
      <td>-0.327486</td>
      <td>0.829871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>group_市值_账面市值比_12.0</td>
      <td>-1.532712</td>
      <td>0.378201</td>
      <td>-0.123392</td>
      <td>-0.002967</td>
      <td>-0.295093</td>
      <td>0.949446</td>
    </tr>
    <tr>
      <th>2</th>
      <td>group_市值_账面市值比_13.0</td>
      <td>-1.497978</td>
      <td>0.522660</td>
      <td>0.063886</td>
      <td>0.035895</td>
      <td>-0.263636</td>
      <td>0.941256</td>
    </tr>
    <tr>
      <th>3</th>
      <td>group_市值_账面市值比_14.0</td>
      <td>-1.614787</td>
      <td>0.812112</td>
      <td>0.522669</td>
      <td>-0.323095</td>
      <td>-0.084801</td>
      <td>0.954305</td>
    </tr>
    <tr>
      <th>4</th>
      <td>group_市值_账面市值比_15.0</td>
      <td>-1.957096</td>
      <td>0.824856</td>
      <td>0.851250</td>
      <td>-0.036663</td>
      <td>-0.316808</td>
      <td>0.925833</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>group_市值_总资产增长率_51.0</td>
      <td>2.106815</td>
      <td>-0.821950</td>
      <td>-0.035377</td>
      <td>-0.972462</td>
      <td>0.561733</td>
      <td>0.989700</td>
    </tr>
    <tr>
      <th>71</th>
      <td>group_市值_总资产增长率_52.0</td>
      <td>1.833333</td>
      <td>-0.682260</td>
      <td>0.156404</td>
      <td>-0.831118</td>
      <td>0.451560</td>
      <td>0.963006</td>
    </tr>
    <tr>
      <th>72</th>
      <td>group_市值_总资产增长率_53.0</td>
      <td>1.740340</td>
      <td>-0.764854</td>
      <td>0.175997</td>
      <td>-0.600070</td>
      <td>0.362012</td>
      <td>0.948200</td>
    </tr>
    <tr>
      <th>73</th>
      <td>group_市值_总资产增长率_54.0</td>
      <td>1.689762</td>
      <td>-0.733096</td>
      <td>0.040186</td>
      <td>-0.146237</td>
      <td>0.386592</td>
      <td>0.927875</td>
    </tr>
    <tr>
      <th>74</th>
      <td>group_市值_总资产增长率_55.0</td>
      <td>2.044085</td>
      <td>-0.862421</td>
      <td>-0.565389</td>
      <td>0.641464</td>
      <td>0.492806</td>
      <td>0.976112</td>
    </tr>
  </tbody>
</table>
<p>75 rows × 7 columns</p>
</div>




```python
ex_data = portfolio_df_f[['投资组合', '日期', '收益率_rf']].merge(df_ex, on='投资组合', how='left').dropna(subset=['SMB_beta', 'HML_beta', 'CMA_beta', 'RMW_beta', 'mk_rf_beta'])
```


```python
ex_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>投资组合</th>
      <th>日期</th>
      <th>收益率_rf</th>
      <th>const</th>
      <th>SMB_beta</th>
      <th>HML_beta</th>
      <th>CMA_beta</th>
      <th>RMW_beta</th>
      <th>mk_rf_beta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>group_市值_账面市值比_11.0</td>
      <td>2000-07-31</td>
      <td>9.221252</td>
      <td>-1.181383</td>
      <td>0.418788</td>
      <td>-0.558641</td>
      <td>0.032211</td>
      <td>-0.327486</td>
      <td>0.829871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>group_市值_账面市值比_12.0</td>
      <td>2000-07-31</td>
      <td>2.120166</td>
      <td>-1.532712</td>
      <td>0.378201</td>
      <td>-0.123392</td>
      <td>-0.002967</td>
      <td>-0.295093</td>
      <td>0.949446</td>
    </tr>
    <tr>
      <th>2</th>
      <td>group_市值_账面市值比_13.0</td>
      <td>2000-07-31</td>
      <td>4.406372</td>
      <td>-1.497978</td>
      <td>0.522660</td>
      <td>0.063886</td>
      <td>0.035895</td>
      <td>-0.263636</td>
      <td>0.941256</td>
    </tr>
    <tr>
      <th>3</th>
      <td>group_市值_账面市值比_14.0</td>
      <td>2000-07-31</td>
      <td>4.022239</td>
      <td>-1.614787</td>
      <td>0.812112</td>
      <td>0.522669</td>
      <td>-0.323095</td>
      <td>-0.084801</td>
      <td>0.954305</td>
    </tr>
    <tr>
      <th>4</th>
      <td>group_市值_账面市值比_15.0</td>
      <td>2000-07-31</td>
      <td>0.540806</td>
      <td>-1.957096</td>
      <td>0.824856</td>
      <td>0.851250</td>
      <td>-0.036663</td>
      <td>-0.316808</td>
      <td>0.925833</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17545</th>
      <td>group_市值_总资产增长率_51.0</td>
      <td>2019-12-31</td>
      <td>8.916628</td>
      <td>2.106815</td>
      <td>-0.821950</td>
      <td>-0.035377</td>
      <td>-0.972462</td>
      <td>0.561733</td>
      <td>0.989700</td>
    </tr>
    <tr>
      <th>17546</th>
      <td>group_市值_总资产增长率_52.0</td>
      <td>2019-12-31</td>
      <td>7.160002</td>
      <td>1.833333</td>
      <td>-0.682260</td>
      <td>0.156404</td>
      <td>-0.831118</td>
      <td>0.451560</td>
      <td>0.963006</td>
    </tr>
    <tr>
      <th>17547</th>
      <td>group_市值_总资产增长率_53.0</td>
      <td>2019-12-31</td>
      <td>7.896302</td>
      <td>1.740340</td>
      <td>-0.764854</td>
      <td>0.175997</td>
      <td>-0.600070</td>
      <td>0.362012</td>
      <td>0.948200</td>
    </tr>
    <tr>
      <th>17548</th>
      <td>group_市值_总资产增长率_54.0</td>
      <td>2019-12-31</td>
      <td>8.772259</td>
      <td>1.689762</td>
      <td>-0.733096</td>
      <td>0.040186</td>
      <td>-0.146237</td>
      <td>0.386592</td>
      <td>0.927875</td>
    </tr>
    <tr>
      <th>17549</th>
      <td>group_市值_总资产增长率_55.0</td>
      <td>2019-12-31</td>
      <td>9.620977</td>
      <td>2.044085</td>
      <td>-0.862421</td>
      <td>-0.565389</td>
      <td>0.641464</td>
      <td>0.492806</td>
      <td>0.976112</td>
    </tr>
  </tbody>
</table>
<p>17550 rows × 9 columns</p>
</div>




```python
fa_prenium = []
for d in list(ex_data.日期.unique()):
    _ = ex_data[ex_data['日期'] == d].copy()
    X = _[['SMB_beta', 'HML_beta', 'CMA_beta', 'RMW_beta', 'mk_rf_beta']]
    y = _['收益率_rf']
    res = get_OLS(X, y)
    fa_prenium.append([d, *list(res.params.values)])
    print(d)
```

    2000-07-31T00:00:00.000000000
    2000-08-31T00:00:00.000000000
    2000-09-29T00:00:00.000000000
    2000-10-31T00:00:00.000000000
    2000-11-30T00:00:00.000000000
    2000-12-29T00:00:00.000000000
    2001-01-19T00:00:00.000000000
    2001-02-28T00:00:00.000000000
    2001-03-30T00:00:00.000000000
    2001-04-30T00:00:00.000000000
    2001-05-31T00:00:00.000000000
    2001-06-29T00:00:00.000000000
    2001-07-31T00:00:00.000000000
    2001-08-31T00:00:00.000000000
    2001-09-28T00:00:00.000000000
    2001-10-31T00:00:00.000000000
    2001-11-30T00:00:00.000000000
    2001-12-31T00:00:00.000000000
    2002-01-31T00:00:00.000000000
    2002-02-28T00:00:00.000000000
    2002-03-29T00:00:00.000000000
    2002-04-30T00:00:00.000000000
    2002-05-31T00:00:00.000000000
    2002-06-28T00:00:00.000000000
    2002-07-31T00:00:00.000000000
    2002-08-30T00:00:00.000000000
    2002-09-27T00:00:00.000000000
    2002-10-31T00:00:00.000000000
    2002-11-29T00:00:00.000000000
    2002-12-31T00:00:00.000000000
    2003-01-29T00:00:00.000000000
    2003-02-28T00:00:00.000000000
    2003-03-31T00:00:00.000000000
    2003-04-30T00:00:00.000000000
    2003-05-30T00:00:00.000000000
    2003-06-30T00:00:00.000000000
    2003-07-31T00:00:00.000000000
    2003-08-29T00:00:00.000000000
    2003-09-30T00:00:00.000000000
    2003-10-31T00:00:00.000000000
    2003-11-28T00:00:00.000000000
    2003-12-31T00:00:00.000000000
    2004-01-30T00:00:00.000000000
    2004-02-27T00:00:00.000000000
    2004-03-31T00:00:00.000000000
    2004-04-30T00:00:00.000000000
    2004-05-31T00:00:00.000000000
    2004-06-30T00:00:00.000000000
    2004-07-30T00:00:00.000000000
    2004-08-31T00:00:00.000000000
    2004-09-30T00:00:00.000000000
    2004-10-29T00:00:00.000000000
    2004-11-30T00:00:00.000000000
    2004-12-31T00:00:00.000000000
    2005-01-31T00:00:00.000000000
    2005-02-28T00:00:00.000000000
    2005-03-31T00:00:00.000000000
    2005-04-29T00:00:00.000000000
    2005-05-31T00:00:00.000000000
    2005-06-30T00:00:00.000000000
    2005-07-29T00:00:00.000000000
    2005-08-31T00:00:00.000000000
    2005-09-30T00:00:00.000000000
    2005-10-31T00:00:00.000000000
    2005-11-30T00:00:00.000000000
    2005-12-30T00:00:00.000000000
    2006-01-25T00:00:00.000000000
    2006-02-28T00:00:00.000000000
    2006-03-31T00:00:00.000000000
    2006-04-28T00:00:00.000000000
    2006-05-31T00:00:00.000000000
    2006-06-30T00:00:00.000000000
    2006-07-31T00:00:00.000000000
    2006-08-31T00:00:00.000000000
    2006-09-29T00:00:00.000000000
    2006-10-31T00:00:00.000000000
    2006-11-30T00:00:00.000000000
    2006-12-29T00:00:00.000000000
    2007-01-31T00:00:00.000000000
    2007-02-28T00:00:00.000000000
    2007-03-30T00:00:00.000000000
    2007-04-30T00:00:00.000000000
    2007-05-31T00:00:00.000000000
    2007-06-29T00:00:00.000000000
    2007-07-31T00:00:00.000000000
    2007-08-31T00:00:00.000000000
    2007-09-28T00:00:00.000000000
    2007-10-31T00:00:00.000000000
    2007-11-30T00:00:00.000000000
    2007-12-28T00:00:00.000000000
    2008-01-31T00:00:00.000000000
    2008-02-29T00:00:00.000000000
    2008-03-31T00:00:00.000000000
    2008-04-30T00:00:00.000000000
    2008-05-30T00:00:00.000000000
    2008-06-30T00:00:00.000000000
    2008-07-31T00:00:00.000000000
    2008-08-29T00:00:00.000000000
    2008-09-26T00:00:00.000000000
    2008-10-31T00:00:00.000000000
    2008-11-28T00:00:00.000000000
    2008-12-31T00:00:00.000000000
    2009-01-23T00:00:00.000000000
    2009-02-27T00:00:00.000000000
    2009-03-31T00:00:00.000000000
    2009-04-30T00:00:00.000000000
    2009-05-27T00:00:00.000000000
    2009-06-30T00:00:00.000000000
    2009-07-31T00:00:00.000000000
    2009-08-31T00:00:00.000000000
    2009-09-30T00:00:00.000000000
    2009-10-30T00:00:00.000000000
    2009-11-30T00:00:00.000000000
    2009-12-31T00:00:00.000000000
    2010-01-29T00:00:00.000000000
    2010-02-26T00:00:00.000000000
    2010-03-31T00:00:00.000000000
    2010-04-30T00:00:00.000000000
    2010-05-31T00:00:00.000000000
    2010-06-30T00:00:00.000000000
    2010-07-30T00:00:00.000000000
    2010-08-31T00:00:00.000000000
    2010-09-30T00:00:00.000000000
    2010-10-29T00:00:00.000000000
    2010-11-30T00:00:00.000000000
    2010-12-31T00:00:00.000000000
    2011-01-31T00:00:00.000000000
    2011-02-28T00:00:00.000000000
    2011-03-31T00:00:00.000000000
    2011-04-29T00:00:00.000000000
    2011-05-31T00:00:00.000000000
    2011-06-30T00:00:00.000000000
    2011-07-29T00:00:00.000000000
    2011-08-31T00:00:00.000000000
    2011-09-30T00:00:00.000000000
    2011-10-31T00:00:00.000000000
    2011-11-30T00:00:00.000000000
    2011-12-30T00:00:00.000000000
    2012-01-31T00:00:00.000000000
    2012-02-29T00:00:00.000000000
    2012-03-30T00:00:00.000000000
    2012-04-27T00:00:00.000000000
    2012-05-31T00:00:00.000000000
    2012-06-29T00:00:00.000000000
    2012-07-31T00:00:00.000000000
    2012-08-31T00:00:00.000000000
    2012-09-28T00:00:00.000000000
    2012-10-31T00:00:00.000000000
    2012-11-30T00:00:00.000000000
    2012-12-31T00:00:00.000000000
    2013-01-31T00:00:00.000000000
    2013-02-28T00:00:00.000000000
    2013-03-29T00:00:00.000000000
    2013-04-26T00:00:00.000000000
    2013-05-31T00:00:00.000000000
    2013-06-28T00:00:00.000000000
    2013-07-31T00:00:00.000000000
    2013-08-30T00:00:00.000000000
    2013-09-30T00:00:00.000000000
    2013-10-31T00:00:00.000000000
    2013-11-29T00:00:00.000000000
    2013-12-31T00:00:00.000000000
    2014-01-30T00:00:00.000000000
    2014-02-28T00:00:00.000000000
    2014-03-31T00:00:00.000000000
    2014-04-30T00:00:00.000000000
    2014-05-30T00:00:00.000000000
    2014-06-30T00:00:00.000000000
    2014-07-31T00:00:00.000000000
    2014-08-29T00:00:00.000000000
    2014-09-30T00:00:00.000000000
    2014-10-31T00:00:00.000000000
    2014-11-28T00:00:00.000000000
    2014-12-31T00:00:00.000000000
    2015-01-30T00:00:00.000000000
    2015-02-27T00:00:00.000000000
    2015-03-31T00:00:00.000000000
    2015-04-30T00:00:00.000000000
    2015-05-29T00:00:00.000000000
    2015-06-30T00:00:00.000000000
    2015-07-31T00:00:00.000000000
    2015-08-31T00:00:00.000000000
    2015-09-30T00:00:00.000000000
    2015-10-30T00:00:00.000000000
    2015-11-30T00:00:00.000000000
    2015-12-31T00:00:00.000000000
    2016-01-29T00:00:00.000000000
    2016-02-29T00:00:00.000000000
    2016-03-31T00:00:00.000000000
    2016-04-29T00:00:00.000000000
    2016-05-31T00:00:00.000000000
    2016-06-30T00:00:00.000000000
    2016-07-29T00:00:00.000000000
    2016-08-31T00:00:00.000000000
    2016-09-30T00:00:00.000000000
    2016-10-31T00:00:00.000000000
    2016-11-30T00:00:00.000000000
    2016-12-30T00:00:00.000000000
    2017-01-26T00:00:00.000000000
    2017-02-28T00:00:00.000000000
    2017-03-31T00:00:00.000000000
    2017-04-28T00:00:00.000000000
    2017-05-31T00:00:00.000000000
    2017-06-30T00:00:00.000000000
    2017-07-31T00:00:00.000000000
    2017-08-31T00:00:00.000000000
    2017-09-29T00:00:00.000000000
    2017-10-31T00:00:00.000000000
    2017-11-30T00:00:00.000000000
    2017-12-29T00:00:00.000000000
    2018-01-31T00:00:00.000000000
    2018-02-28T00:00:00.000000000
    2018-03-30T00:00:00.000000000
    2018-04-27T00:00:00.000000000
    2018-05-31T00:00:00.000000000
    2018-06-29T00:00:00.000000000
    2018-07-31T00:00:00.000000000
    2018-08-31T00:00:00.000000000
    2018-09-28T00:00:00.000000000
    2018-10-31T00:00:00.000000000
    2018-11-30T00:00:00.000000000
    2018-12-28T00:00:00.000000000
    2019-01-31T00:00:00.000000000
    2019-02-28T00:00:00.000000000
    2019-03-29T00:00:00.000000000
    2019-04-30T00:00:00.000000000
    2019-05-31T00:00:00.000000000
    2019-06-28T00:00:00.000000000
    2019-07-31T00:00:00.000000000
    2019-08-30T00:00:00.000000000
    2019-09-30T00:00:00.000000000
    2019-10-31T00:00:00.000000000
    2019-11-29T00:00:00.000000000
    2019-12-31T00:00:00.000000000
    


```python
df_pre = pd.DataFrame(fa_prenium, columns=['日期', 'const_a', 'SMB_溢价', 'HML_溢价', 'CMA_溢价', 'RMW_溢价', 'mk_rf_溢价'])
```


```python
df_pre.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>const_a</th>
      <th>SMB_溢价</th>
      <th>HML_溢价</th>
      <th>CMA_溢价</th>
      <th>RMW_溢价</th>
      <th>mk_rf_溢价</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>4.566160</td>
      <td>-1.281193</td>
      <td>-2.486769</td>
      <td>-2.660292</td>
      <td>-3.553618</td>
      <td>0.175405</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>0.532397</td>
      <td>0.267281</td>
      <td>-3.389472</td>
      <td>-2.747530</td>
      <td>-3.215136</td>
      <td>-0.110194</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>6.890588</td>
      <td>0.237668</td>
      <td>-1.366054</td>
      <td>-0.351594</td>
      <td>-1.145616</td>
      <td>-11.174073</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>1.023256</td>
      <td>1.387265</td>
      <td>-0.972097</td>
      <td>-1.364139</td>
      <td>-2.788227</td>
      <td>2.460796</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>0.603379</td>
      <td>-1.077661</td>
      <td>-0.137547</td>
      <td>-0.396442</td>
      <td>-1.034558</td>
      <td>5.625171</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_pre.mean()
```

    <ipython-input-20-0b98a0662c22>:1: FutureWarning: DataFrame.mean and DataFrame.median with numeric_only=None will include datetime64 and datetime64tz columns in a future version.
      df_pre.mean()
    




    const_a    -4.659560
    SMB_溢价     -0.455647
    HML_溢价     -0.156543
    CMA_溢价      0.010472
    RMW_溢价      1.162163
    mk_rf_溢价    6.062843
    dtype: float64




```python

```
