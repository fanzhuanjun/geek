```python
import numpy as np
import pandas as pd
import os
```


```python
factor_df = pd.read_excel("五因子数据.xlsx")
factor_df = factor_df.rename(columns={"时间" : "日期"})
```


```python
factor_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>SMB</th>
      <th>HML</th>
      <th>CMA</th>
      <th>RMW</th>
      <th>mk_rf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>1.776700</td>
      <td>-2.048085</td>
      <td>-3.020902</td>
      <td>-3.910493</td>
      <td>4.985</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>2.161310</td>
      <td>-3.355225</td>
      <td>-2.356352</td>
      <td>-3.563212</td>
      <td>0.555</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>2.768764</td>
      <td>-0.595435</td>
      <td>-0.795055</td>
      <td>-0.294096</td>
      <td>-3.895</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>2.368923</td>
      <td>0.203406</td>
      <td>-1.691315</td>
      <td>-2.593286</td>
      <td>3.545</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>0.514857</td>
      <td>0.213481</td>
      <td>0.095284</td>
      <td>-0.527789</td>
      <td>6.015</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.read_excel("数据整理_2.xlsx")
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 468906 entries, 0 to 468905
    Data columns (total 43 columns):
     #   Column                 Non-Null Count   Dtype         
    ---  ------                 --------------   -----         
     0   证券名称                   468906 non-null  object        
     1   证券代码                   468906 non-null  object        
     2   日期                     468906 non-null  datetime64[ns]
     3   12个月换手率                468883 non-null  float64       
     4   20日换手率                 468883 non-null  float64       
     5   PB                     468904 non-null  float64       
     6   ROA                    462750 non-null  float64       
     7   ROE                    468850 non-null  float64       
     8   动量11                   466135 non-null  float64       
     9   动量6                    452273 non-null  float64       
     10  市值                     468906 non-null  float64       
     11  年化波动率                  402545 non-null  float64       
     12  总资产增长率                 465130 non-null  float64       
     13  收益率                    468906 non-null  float64       
     14  收盘价                    468906 non-null  float64       
     15  账面市值比                  468020 non-null  float64       
     16  12个月换手率_winsorized     468906 non-null  float64       
     17  20日换手率_winsorized      468906 non-null  float64       
     18  PB_winsorized          468906 non-null  float64       
     19  ROA_winsorized         463173 non-null  float64       
     20  ROE_winsorized         468906 non-null  float64       
     21  动量11_winsorized        467478 non-null  float64       
     22  动量6_winsorized         452414 non-null  float64       
     23  市值_winsorized          468906 non-null  float64       
     24  年化波动率_winsorized       402545 non-null  float64       
     25  总资产增长率_winsorized      465229 non-null  float64       
     26  收盘价_winsorized         468906 non-null  float64       
     27  账面市值比_winsorized       468149 non-null  float64       
     28  MonRf                  468906 non-null  float64       
     29  mk_rf                  468906 non-null  float64       
     30  收益率_rf                 468906 non-null  float64       
     31  groupby_市值_winsorized  468906 non-null  int64         
     32  groupby_市值             468906 non-null  int64         
     33  groupby_ROE            468850 non-null  float64       
     34  groupby_账面市值比          468020 non-null  float64       
     35  groupby_总资产增长率         465130 non-null  float64       
     36  group5by_市值            468906 non-null  int64         
     37  group5by_账面市值比         468020 non-null  float64       
     38  group5by_ROE           468850 non-null  float64       
     39  group5by_总资产增长率        465130 non-null  float64       
     40  group_市值_账面市值比         468020 non-null  float64       
     41  group_市值_ROE           468850 non-null  float64       
     42  group_市值_总资产增长率        465130 non-null  float64       
    dtypes: datetime64[ns](1), float64(37), int64(3), object(2)
    memory usage: 153.8+ MB
    


```python
data['换手比'] = data['20日换手率_winsorized'] / data['12个月换手率_winsorized']
```


```python
data['换手比_分10组'] = data.groupby(['日期'])['换手比'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
data['动量6_分10组'] = data.groupby(['日期'])['动量6_winsorized'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
data['动量11_分10组'] = data.groupby(['日期'])['动量11_winsorized'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
```

# 构建多空时间序列


```python
huanshoulv_ts = data[data['换手比_分10组'] == 10].groupby("日期")['收益率'].mean() - \
data[data['换手比_分10组'] == 1].groupby("日期")['收益率'].mean()

dongliang6_ts = data[data['动量6_分10组'] == 10].groupby("日期")['收益率'].mean() - \
data[data['动量6_分10组'] == 1].groupby("日期")['收益率'].mean()


dongliang11_ts = data[data['动量11_分10组'] == 10].groupby("日期")['收益率'].mean() - \
data[data['动量11_分10组'] == 1].groupby("日期")['收益率'].mean()
```


```python
huanshoulv_ts_rf = data[data['换手比_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['换手比_分10组'] == 1].groupby("日期")['收益率_rf'].mean()

dongliang6_ts_rf = data[data['动量6_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['动量6_分10组'] == 1].groupby("日期")['收益率_rf'].mean()


dongliang11_ts_rf = data[data['动量11_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['动量11_分10组'] == 1].groupby("日期")['收益率_rf'].mean()
```


```python
huanshoulv_ts = huanshoulv_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang6_ts = dongliang6_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang11_ts = dongliang11_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
```


```python
huanshoulv_ts_rf = huanshoulv_ts_rf.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang6_ts_rf = dongliang6_ts_rf.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang11_ts_rf = dongliang11_ts_rf.reset_index().merge(factor_df, on='日期', how='left').dropna()
```


```python
huanshoulv_ts.columns
```




    Index(['日期', '收益率', 'SMB', 'HML', 'CMA', 'RMW', 'mk_rf'], dtype='object')




```python
import statsmodels.api as sm

def get_OLS(X, y):
    X = sm.add_constant(X)
    mod = sm.OLS(y, X)
    res = mod.fit()
    return res
```

# 模型一


```python
X = huanshoulv_ts_rf[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts_rf['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.095</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.075</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   4.791</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>0.000349</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:56:21</td>     <th>  Log-Likelihood:    </th> <td> -730.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1473.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1493.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    9.4765</td> <td>    0.402</td> <td>   23.548</td> <td> 0.000</td> <td>    8.684</td> <td>   10.269</td>
</tr>
<tr>
  <th>SMB</th>   <td>    0.0182</td> <td>    0.125</td> <td>    0.146</td> <td> 0.884</td> <td>   -0.228</td> <td>    0.264</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.2766</td> <td>    0.220</td> <td>   -1.256</td> <td> 0.210</td> <td>   -0.711</td> <td>    0.157</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.1339</td> <td>    0.253</td> <td>   -0.528</td> <td> 0.598</td> <td>   -0.633</td> <td>    0.366</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.0400</td> <td>    0.161</td> <td>   -0.249</td> <td> 0.804</td> <td>   -0.357</td> <td>    0.277</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1216</td> <td>    0.042</td> <td>    2.881</td> <td> 0.004</td> <td>    0.038</td> <td>    0.205</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>63.704</td> <th>  Durbin-Watson:     </th> <td>   1.657</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 197.506</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.138</td> <th>  Prob(JB):          </th> <td>1.29e-43</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 6.883</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts_rf[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts_rf['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.106</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.087</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   5.428</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>9.71e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:56:25</td>     <th>  Log-Likelihood:    </th> <td> -816.96</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1646.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1667.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.2648</td> <td>    0.583</td> <td>   22.765</td> <td> 0.000</td> <td>   12.117</td> <td>   14.413</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.4042</td> <td>    0.181</td> <td>   -2.238</td> <td> 0.026</td> <td>   -0.760</td> <td>   -0.048</td>
</tr>
<tr>
  <th>HML</th>   <td>    0.0513</td> <td>    0.319</td> <td>    0.161</td> <td> 0.872</td> <td>   -0.577</td> <td>    0.680</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.3002</td> <td>    0.367</td> <td>   -0.818</td> <td> 0.414</td> <td>   -1.023</td> <td>    0.423</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.8034</td> <td>    0.233</td> <td>    3.449</td> <td> 0.001</td> <td>    0.344</td> <td>    1.262</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1385</td> <td>    0.061</td> <td>    2.266</td> <td> 0.024</td> <td>    0.018</td> <td>    0.259</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>72.930</td> <th>  Durbin-Watson:     </th> <td>   1.535</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 248.985</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.276</td> <th>  Prob(JB):          </th> <td>8.58e-55</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.362</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts_rf[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts_rf['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.264</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.248</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   16.34</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>9.03e-14</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:56:28</td>     <th>  Log-Likelihood:    </th> <td> -770.50</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1553.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1574.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.6171</td> <td>    0.478</td> <td>    3.385</td> <td> 0.001</td> <td>    0.676</td> <td>    2.558</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.1938</td> <td>    0.148</td> <td>   -8.063</td> <td> 0.000</td> <td>   -1.486</td> <td>   -0.902</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.1549</td> <td>    0.261</td> <td>   -0.593</td> <td> 0.554</td> <td>   -0.670</td> <td>    0.360</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.0964</td> <td>    0.301</td> <td>   -0.321</td> <td> 0.749</td> <td>   -0.689</td> <td>    0.497</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.1188</td> <td>    0.191</td> <td>   -0.622</td> <td> 0.534</td> <td>   -0.495</td> <td>    0.257</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0312</td> <td>    0.050</td> <td>    0.622</td> <td> 0.535</td> <td>   -0.068</td> <td>    0.130</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>19.032</td> <th>  Durbin-Watson:     </th> <td>   1.514</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  65.520</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.089</td> <th>  Prob(JB):          </th> <td>5.92e-15</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.586</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 模型二


```python
factor_mut = pd.read_excel("因子收益率.xlsx")
```


```python
factor_mut.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>const</th>
      <th>市值因子收益率</th>
      <th>账面市值比因子收益率</th>
      <th>ROE因子收益率</th>
      <th>总资产增长率因子收益率</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>5.819702</td>
      <td>-0.063955</td>
      <td>-1.781308</td>
      <td>1.850489</td>
      <td>-1.612875</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>1.139063</td>
      <td>-0.155462</td>
      <td>-1.870000</td>
      <td>0.991164</td>
      <td>-0.982347</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>-3.225288</td>
      <td>-0.811375</td>
      <td>-1.039938</td>
      <td>1.483239</td>
      <td>-0.788082</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>3.815990</td>
      <td>-0.923542</td>
      <td>0.028459</td>
      <td>0.642535</td>
      <td>-1.010535</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>6.247308</td>
      <td>0.195750</td>
      <td>-0.010602</td>
      <td>0.829874</td>
      <td>-0.549144</td>
    </tr>
  </tbody>
</table>
</div>




```python
factor_mut.columns
```




    Index(['日期', 'const', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率', '总资产增长率因子收益率'], dtype='object')




```python
huanshoulv_ts02 = huanshoulv_ts[['日期', '收益率']].merge(factor_mut, on="日期", how='left')
dongliang6_ts02 = dongliang6_ts[['日期', '收益率']].merge(factor_mut, on="日期", how='left')
dongliang11_ts02 = dongliang11_ts[['日期', '收益率']].merge(factor_mut, on="日期", how='left')
```


```python
X_cols = ['市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率', '总资产增长率因子收益率']
```


```python
huanshoulv_ts02.columns
```




    Index(['日期', '收益率', 'const', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率',
           '总资产增长率因子收益率'],
          dtype='object')




```python
X = huanshoulv_ts02[X_cols]
y = huanshoulv_ts02['收益率'] - huanshoulv_ts02['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.111</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.095</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   7.127</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>2.00e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:57:20</td>     <th>  Log-Likelihood:    </th> <td> -846.65</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1703.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1721.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    7.6325</td> <td>    0.664</td> <td>   11.500</td> <td> 0.000</td> <td>    6.325</td> <td>    8.940</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    1.7595</td> <td>    0.368</td> <td>    4.779</td> <td> 0.000</td> <td>    1.034</td> <td>    2.485</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    0.7670</td> <td>    0.641</td> <td>    1.196</td> <td> 0.233</td> <td>   -0.496</td> <td>    2.030</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.2823</td> <td>    0.508</td> <td>   -0.556</td> <td> 0.579</td> <td>   -1.283</td> <td>    0.718</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.4974</td> <td>    0.390</td> <td>    1.275</td> <td> 0.204</td> <td>   -0.271</td> <td>    1.266</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 7.780</td> <th>  Durbin-Watson:     </th> <td>   1.988</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.020</td> <th>  Jarque-Bera (JB):  </th> <td>  13.193</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.091</td> <th>  Prob(JB):          </th> <td> 0.00137</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.149</td> <th>  Cond. No.          </th> <td>    2.32</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts02[X_cols]
y = dongliang6_ts02['收益率'] - dongliang6_ts02['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.245</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.232</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   18.62</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>2.91e-13</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:57:41</td>     <th>  Log-Likelihood:    </th> <td> -886.63</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1783.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1801.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    9.7599</td> <td>    0.787</td> <td>   12.396</td> <td> 0.000</td> <td>    8.209</td> <td>   11.311</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.6179</td> <td>    0.437</td> <td>    8.282</td> <td> 0.000</td> <td>    2.757</td> <td>    4.479</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    0.9780</td> <td>    0.761</td> <td>    1.286</td> <td> 0.200</td> <td>   -0.521</td> <td>    2.476</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    2.4444</td> <td>    0.602</td> <td>    4.058</td> <td> 0.000</td> <td>    1.257</td> <td>    3.631</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.7052</td> <td>    0.463</td> <td>    1.524</td> <td> 0.129</td> <td>   -0.207</td> <td>    1.617</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.870</td> <th>  Durbin-Watson:     </th> <td>   2.142</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.004</td> <th>  Jarque-Bera (JB):  </th> <td>  18.617</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.233</td> <th>  Prob(JB):          </th> <td>9.07e-05</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.301</td> <th>  Cond. No.          </th> <td>    2.32</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts02[X_cols]
y = dongliang11_ts02['收益率'] - dongliang11_ts02['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.225</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.212</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   16.65</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>5.39e-12</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:59:48</td>     <th>  Log-Likelihood:    </th> <td> -896.73</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1803.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1821.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -2.8187</td> <td>    0.822</td> <td>   -3.429</td> <td> 0.001</td> <td>   -4.438</td> <td>   -1.199</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.4816</td> <td>    0.456</td> <td>    7.634</td> <td> 0.000</td> <td>    2.583</td> <td>    4.380</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    1.3715</td> <td>    0.794</td> <td>    1.727</td> <td> 0.085</td> <td>   -0.193</td> <td>    2.936</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.1061</td> <td>    0.629</td> <td>   -0.169</td> <td> 0.866</td> <td>   -1.345</td> <td>    1.133</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.5021</td> <td>    0.483</td> <td>    1.039</td> <td> 0.300</td> <td>   -0.450</td> <td>    1.454</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>39.613</td> <th>  Durbin-Watson:     </th> <td>   1.853</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  73.321</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.877</td> <th>  Prob(JB):          </th> <td>1.20e-16</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.108</td> <th>  Cond. No.          </th> <td>    2.32</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 模型三


```python
huanshoulv_ts03 = huanshoulv_ts_rf[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left').merge(factor_df, on='日期', how='left')
dongliang6_ts03 = dongliang6_ts_rf[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left').merge(factor_df, on='日期', how='left')
dongliang11_ts03 = dongliang11_ts_rf[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left').merge(factor_df, on='日期', how='left')
```


```python
huanshoulv_ts03.columns
```




    Index(['日期', '收益率_rf', 'const', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率',
           '总资产增长率因子收益率', 'SMB', 'HML', 'CMA', 'RMW', 'mk_rf'],
          dtype='object')




```python
X_cols_03 = ['mk_rf', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率', '总资产增长率因子收益率']
```


```python
X = huanshoulv_ts03[X_cols_03]
y = huanshoulv_ts03['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.115</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.095</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   5.901</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>3.76e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:05:37</td>     <th>  Log-Likelihood:    </th> <td> -727.80</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1468.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1488.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    8.9250</td> <td>    0.404</td> <td>   22.110</td> <td> 0.000</td> <td>    8.130</td> <td>    9.720</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>    0.1344</td> <td>    0.041</td> <td>    3.304</td> <td> 0.001</td> <td>    0.054</td> <td>    0.215</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    0.4438</td> <td>    0.232</td> <td>    1.914</td> <td> 0.057</td> <td>   -0.013</td> <td>    0.901</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.1061</td> <td>    0.398</td> <td>   -2.778</td> <td> 0.006</td> <td>   -1.891</td> <td>   -0.322</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.2349</td> <td>    0.306</td> <td>   -0.767</td> <td> 0.444</td> <td>   -0.839</td> <td>    0.369</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -0.2171</td> <td>    0.239</td> <td>   -0.908</td> <td> 0.365</td> <td>   -0.689</td> <td>    0.254</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>31.245</td> <th>  Durbin-Watson:     </th> <td>   1.579</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  59.435</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.693</td> <th>  Prob(JB):          </th> <td>1.24e-13</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.043</td> <th>  Cond. No.          </th> <td>    11.8</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts03[X_cols_03]
y = dongliang6_ts03['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.285</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.269</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   18.16</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>3.69e-15</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:05:42</td>     <th>  Log-Likelihood:    </th> <td> -790.90</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1594.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1615.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   11.1263</td> <td>    0.529</td> <td>   21.049</td> <td> 0.000</td> <td>   10.085</td> <td>   12.168</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>    0.0770</td> <td>    0.053</td> <td>    1.446</td> <td> 0.150</td> <td>   -0.028</td> <td>    0.182</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    2.2082</td> <td>    0.304</td> <td>    7.274</td> <td> 0.000</td> <td>    1.610</td> <td>    2.806</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.0293</td> <td>    0.521</td> <td>   -1.974</td> <td> 0.050</td> <td>   -2.057</td> <td>   -0.002</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    2.4769</td> <td>    0.401</td> <td>    6.173</td> <td> 0.000</td> <td>    1.686</td> <td>    3.268</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -0.0702</td> <td>    0.313</td> <td>   -0.224</td> <td> 0.823</td> <td>   -0.688</td> <td>    0.547</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>31.813</td> <th>  Durbin-Watson:     </th> <td>   1.833</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  48.580</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.798</td> <th>  Prob(JB):          </th> <td>2.82e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.560</td> <th>  Cond. No.          </th> <td>    11.8</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts03[X_cols_03]
y = dongliang11_ts03['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.219</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.202</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   12.81</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>5.52e-11</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:05:47</td>     <th>  Log-Likelihood:    </th> <td> -777.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1567.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1587.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -1.3033</td> <td>    0.499</td> <td>   -2.613</td> <td> 0.010</td> <td>   -2.286</td> <td>   -0.320</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>   -0.0387</td> <td>    0.050</td> <td>   -0.770</td> <td> 0.442</td> <td>   -0.138</td> <td>    0.060</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    1.8825</td> <td>    0.286</td> <td>    6.571</td> <td> 0.000</td> <td>    1.318</td> <td>    2.447</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.9067</td> <td>    0.492</td> <td>   -1.843</td> <td> 0.067</td> <td>   -1.876</td> <td>    0.063</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.1038</td> <td>    0.379</td> <td>   -0.274</td> <td> 0.784</td> <td>   -0.850</td> <td>    0.642</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -0.3964</td> <td>    0.296</td> <td>   -1.341</td> <td> 0.181</td> <td>   -0.979</td> <td>    0.186</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>23.387</td> <th>  Durbin-Watson:     </th> <td>   1.568</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  92.604</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.183</td> <th>  Prob(JB):          </th> <td>7.78e-21</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 6.060</td> <th>  Cond. No.          </th> <td>    11.8</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 分时段

# 2000-2009.12


```python
huanshoulv_ts_2000 = huanshoulv_ts_rf[huanshoulv_ts_rf['日期'] <= '2009-12-31']
dongliang6_ts_2000 = dongliang6_ts_rf[dongliang6_ts_rf['日期'] <= '2009-12-31']
dongliang11_ts_2000 = dongliang11_ts_rf[dongliang11_ts_rf['日期'] <= '2009-12-31']

huanshoulv_ts02_2000 = huanshoulv_ts02[huanshoulv_ts02['日期'] <= '2009-12-31']
dongliang6_ts02_2000 = dongliang6_ts02[dongliang6_ts02['日期'] <= '2009-12-31']
dongliang11_ts02_2000 = dongliang11_ts02[dongliang11_ts02['日期'] <= '2009-12-31']

huanshoulv_ts03_2000 = huanshoulv_ts03[huanshoulv_ts03['日期'] <= '2009-12-31']
dongliang6_ts03_2000 = dongliang6_ts03[dongliang6_ts03['日期'] <= '2009-12-31']
dongliang11_ts03_2000 = dongliang11_ts03[dongliang11_ts03['日期'] <= '2009-12-31']
```

## 模型一


```python
X = huanshoulv_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.281</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.247</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.426</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>9.28e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:08:16</td>     <th>  Log-Likelihood:    </th> <td> -344.84</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   701.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   718.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    8.4869</td> <td>    0.513</td> <td>   16.528</td> <td> 0.000</td> <td>    7.469</td> <td>    9.505</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.0603</td> <td>    0.213</td> <td>   -0.284</td> <td> 0.777</td> <td>   -0.482</td> <td>    0.361</td>
</tr>
<tr>
  <th>HML</th>   <td>   -1.2584</td> <td>    0.302</td> <td>   -4.169</td> <td> 0.000</td> <td>   -1.857</td> <td>   -0.660</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.8922</td> <td>    0.370</td> <td>    2.414</td> <td> 0.017</td> <td>    0.159</td> <td>    1.625</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.0603</td> <td>    0.239</td> <td>   -0.252</td> <td> 0.801</td> <td>   -0.534</td> <td>    0.413</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1680</td> <td>    0.051</td> <td>    3.307</td> <td> 0.001</td> <td>    0.067</td> <td>    0.269</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>14.125</td> <th>  Durbin-Watson:     </th> <td>   1.414</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.001</td> <th>  Jarque-Bera (JB):  </th> <td>  15.329</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.854</td> <th>  Prob(JB):          </th> <td>0.000469</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.558</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.136</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.096</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.387</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00700</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:08:20</td>     <th>  Log-Likelihood:    </th> <td> -408.79</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   829.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   846.0</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.3124</td> <td>    0.900</td> <td>   14.794</td> <td> 0.000</td> <td>   11.529</td> <td>   15.096</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.0483</td> <td>    0.373</td> <td>   -2.813</td> <td> 0.006</td> <td>   -1.787</td> <td>   -0.310</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.5740</td> <td>    0.529</td> <td>   -1.085</td> <td> 0.280</td> <td>   -1.623</td> <td>    0.475</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.5102</td> <td>    0.648</td> <td>    0.788</td> <td> 0.433</td> <td>   -0.774</td> <td>    1.794</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.2604</td> <td>    0.419</td> <td>    0.622</td> <td> 0.535</td> <td>   -0.570</td> <td>    1.090</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1162</td> <td>    0.089</td> <td>    1.305</td> <td> 0.195</td> <td>   -0.060</td> <td>    0.293</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>43.272</td> <th>  Durbin-Watson:     </th> <td>   1.382</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 115.307</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.418</td> <th>  Prob(JB):          </th> <td>9.15e-26</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.028</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.242</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.207</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   6.899</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>1.26e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:08:22</td>     <th>  Log-Likelihood:    </th> <td> -384.34</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   780.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   797.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.2541</td> <td>    0.726</td> <td>    1.727</td> <td> 0.087</td> <td>   -0.185</td> <td>    2.693</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.5137</td> <td>    0.301</td> <td>   -5.033</td> <td> 0.000</td> <td>   -2.110</td> <td>   -0.918</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.2925</td> <td>    0.427</td> <td>   -0.685</td> <td> 0.495</td> <td>   -1.139</td> <td>    0.554</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.1096</td> <td>    0.523</td> <td>    0.210</td> <td> 0.834</td> <td>   -0.927</td> <td>    1.146</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.1027</td> <td>    0.338</td> <td>   -0.304</td> <td> 0.762</td> <td>   -0.773</td> <td>    0.567</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0233</td> <td>    0.072</td> <td>    0.325</td> <td> 0.746</td> <td>   -0.119</td> <td>    0.166</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.962</td> <th>  Durbin-Watson:     </th> <td>   1.215</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.004</td> <th>  Jarque-Bera (JB):  </th> <td>  29.050</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.074</td> <th>  Prob(JB):          </th> <td>4.92e-07</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.469</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



## 模型二


```python
huanshoulv_ts02_2000.columns
```




    Index(['日期', '收益率', 'const', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率',
           '总资产增长率因子收益率'],
          dtype='object')




```python
X = huanshoulv_ts02_2000[X_cols]
y = huanshoulv_ts02_2000['收益率'] - huanshoulv_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.105</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.072</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.206</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td>0.0157</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>13:10:10</td>     <th>  Log-Likelihood:    </th> <td> -411.58</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   833.2</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   846.8</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    6.6840</td> <td>    1.010</td> <td>    6.616</td> <td> 0.000</td> <td>    4.682</td> <td>    8.686</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    1.5110</td> <td>    0.551</td> <td>    2.744</td> <td> 0.007</td> <td>    0.420</td> <td>    2.602</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.4223</td> <td>    0.834</td> <td>   -0.506</td> <td> 0.614</td> <td>   -2.075</td> <td>    1.231</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    0.2190</td> <td>    0.804</td> <td>    0.272</td> <td> 0.786</td> <td>   -1.375</td> <td>    1.813</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.5589</td> <td>    0.676</td> <td>    2.307</td> <td> 0.023</td> <td>    0.220</td> <td>    2.898</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.244</td> <th>  Durbin-Watson:     </th> <td>   2.138</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.006</td> <th>  Jarque-Bera (JB):  </th> <td>  14.924</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.430</td> <th>  Prob(JB):          </th> <td>0.000574</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.550</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts02_2000[X_cols]
y = dongliang6_ts02_2000['收益率'] - dongliang6_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.281</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.255</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   10.67</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>2.47e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:10:25</td>     <th>  Log-Likelihood:    </th> <td> -441.92</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   893.8</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   907.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    8.6569</td> <td>    1.318</td> <td>    6.567</td> <td> 0.000</td> <td>    6.044</td> <td>   11.270</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.8920</td> <td>    0.718</td> <td>    5.417</td> <td> 0.000</td> <td>    2.468</td> <td>    5.316</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.0483</td> <td>    1.088</td> <td>   -0.044</td> <td> 0.965</td> <td>   -2.205</td> <td>    2.109</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    2.6989</td> <td>    1.050</td> <td>    2.571</td> <td> 0.011</td> <td>    0.618</td> <td>    4.779</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.3236</td> <td>    0.882</td> <td>    1.501</td> <td> 0.136</td> <td>   -0.424</td> <td>    3.071</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>15.283</td> <th>  Durbin-Watson:     </th> <td>   2.172</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  19.979</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.713</td> <th>  Prob(JB):          </th> <td>4.59e-05</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.475</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts02_2000[X_cols]
y = dongliang11_ts02_2000['收益率'] - dongliang11_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.222</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.194</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   7.793</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>1.46e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:10:33</td>     <th>  Log-Likelihood:    </th> <td> -443.94</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   897.9</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   911.6</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -3.2233</td> <td>    1.342</td> <td>   -2.402</td> <td> 0.018</td> <td>   -5.883</td> <td>   -0.564</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.3136</td> <td>    0.731</td> <td>    4.531</td> <td> 0.000</td> <td>    1.864</td> <td>    4.763</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    0.9667</td> <td>    1.108</td> <td>    0.873</td> <td> 0.385</td> <td>   -1.229</td> <td>    3.162</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    1.8783</td> <td>    1.068</td> <td>    1.758</td> <td> 0.082</td> <td>   -0.239</td> <td>    3.996</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.2429</td> <td>    0.898</td> <td>    1.385</td> <td> 0.169</td> <td>   -0.536</td> <td>    3.022</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>16.838</td> <th>  Durbin-Watson:     </th> <td>   1.869</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  23.803</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.738</td> <th>  Prob(JB):          </th> <td>6.78e-06</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.684</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



## 模型三


```python
X = huanshoulv_ts03_2000[X_cols_03]
y = huanshoulv_ts03_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.320</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.288</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   10.16</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>5.37e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:14:16</td>     <th>  Log-Likelihood:    </th> <td> -341.63</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   695.3</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   711.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    7.1172</td> <td>    0.550</td> <td>   12.949</td> <td> 0.000</td> <td>    6.028</td> <td>    8.207</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>    0.1256</td> <td>    0.051</td> <td>    2.441</td> <td> 0.016</td> <td>    0.024</td> <td>    0.228</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    0.9114</td> <td>    0.302</td> <td>    3.019</td> <td> 0.003</td> <td>    0.313</td> <td>    1.510</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -2.1788</td> <td>    0.467</td> <td>   -4.661</td> <td> 0.000</td> <td>   -3.105</td> <td>   -1.252</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.7601</td> <td>    0.444</td> <td>   -1.714</td> <td> 0.089</td> <td>   -1.639</td> <td>    0.119</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -0.6936</td> <td>    0.396</td> <td>   -1.753</td> <td> 0.083</td> <td>   -1.478</td> <td>    0.091</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>11.354</td> <th>  Durbin-Watson:     </th> <td>   1.543</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.003</td> <th>  Jarque-Bera (JB):  </th> <td>  12.430</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.636</td> <th>  Prob(JB):          </th> <td> 0.00200</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.999</td> <th>  Cond. No.          </th> <td>    13.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts03_2000[X_cols_03]
y = dongliang6_ts03_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()

```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.474</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.449</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   19.43</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>9.31e-14</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:14:17</td>     <th>  Log-Likelihood:    </th> <td> -380.52</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   773.0</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   789.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    9.1350</td> <td>    0.773</td> <td>   11.816</td> <td> 0.000</td> <td>    7.603</td> <td>   10.667</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>   -0.0594</td> <td>    0.072</td> <td>   -0.822</td> <td> 0.413</td> <td>   -0.203</td> <td>    0.084</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.1560</td> <td>    0.425</td> <td>    7.433</td> <td> 0.000</td> <td>    2.314</td> <td>    3.998</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -2.2092</td> <td>    0.657</td> <td>   -3.360</td> <td> 0.001</td> <td>   -3.512</td> <td>   -0.906</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    1.4577</td> <td>    0.624</td> <td>    2.336</td> <td> 0.021</td> <td>    0.221</td> <td>    2.694</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -1.4565</td> <td>    0.557</td> <td>   -2.617</td> <td> 0.010</td> <td>   -2.560</td> <td>   -0.353</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>11.538</td> <th>  Durbin-Watson:     </th> <td>   1.839</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.003</td> <th>  Jarque-Bera (JB):  </th> <td>  11.914</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.753</td> <th>  Prob(JB):          </th> <td> 0.00259</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.490</td> <th>  Cond. No.          </th> <td>    13.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts03_2000[X_cols_03]
y = dongliang11_ts03_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.407</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.380</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   14.83</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>4.63e-11</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:14:17</td>     <th>  Log-Likelihood:    </th> <td> -370.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   752.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   769.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -2.7281</td> <td>    0.707</td> <td>   -3.858</td> <td> 0.000</td> <td>   -4.130</td> <td>   -1.326</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>   -0.1300</td> <td>    0.066</td> <td>   -1.964</td> <td> 0.052</td> <td>   -0.261</td> <td>    0.001</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    2.5255</td> <td>    0.388</td> <td>    6.503</td> <td> 0.000</td> <td>    1.756</td> <td>    3.295</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.3484</td> <td>    0.601</td> <td>   -2.242</td> <td> 0.027</td> <td>   -2.540</td> <td>   -0.156</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    0.5371</td> <td>    0.571</td> <td>    0.941</td> <td> 0.349</td> <td>   -0.594</td> <td>    1.668</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -1.7383</td> <td>    0.509</td> <td>   -3.414</td> <td> 0.001</td> <td>   -2.747</td> <td>   -0.729</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>18.909</td> <th>  Durbin-Watson:     </th> <td>   1.557</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  32.434</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.728</td> <th>  Prob(JB):          </th> <td>9.06e-08</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.169</td> <th>  Cond. No.          </th> <td>    13.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 2010~至今


```python
huanshoulv_ts_2010 = huanshoulv_ts_rf[huanshoulv_ts_rf['日期'] > '2009-12-31']
dongliang6_ts_2010 = dongliang6_ts_rf[dongliang6_ts_rf['日期'] > '2009-12-31']
dongliang11_ts_2010 = dongliang11_ts_rf[dongliang11_ts_rf['日期'] > '2009-12-31']

huanshoulv_ts02_2010 = huanshoulv_ts02[huanshoulv_ts02['日期'] > '2009-12-31']
dongliang6_ts02_2010 = dongliang6_ts02[dongliang6_ts02['日期'] > '2009-12-31']
dongliang11_ts02_2010 = dongliang11_ts02[dongliang11_ts02['日期'] > '2009-12-31']

huanshoulv_ts03_2010 = huanshoulv_ts03[huanshoulv_ts03['日期'] > '2009-12-31']
dongliang6_ts03_2010 = dongliang6_ts03[dongliang6_ts03['日期'] > '2009-12-31']
dongliang11_ts03_2010 = dongliang11_ts03[dongliang11_ts03['日期'] > '2009-12-31']
```

## 模型一


```python
X = huanshoulv_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.281</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.247</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.426</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>9.28e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:05</td>     <th>  Log-Likelihood:    </th> <td> -344.84</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   701.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   718.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    8.4869</td> <td>    0.513</td> <td>   16.528</td> <td> 0.000</td> <td>    7.469</td> <td>    9.505</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.0603</td> <td>    0.213</td> <td>   -0.284</td> <td> 0.777</td> <td>   -0.482</td> <td>    0.361</td>
</tr>
<tr>
  <th>HML</th>   <td>   -1.2584</td> <td>    0.302</td> <td>   -4.169</td> <td> 0.000</td> <td>   -1.857</td> <td>   -0.660</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.8922</td> <td>    0.370</td> <td>    2.414</td> <td> 0.017</td> <td>    0.159</td> <td>    1.625</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.0603</td> <td>    0.239</td> <td>   -0.252</td> <td> 0.801</td> <td>   -0.534</td> <td>    0.413</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1680</td> <td>    0.051</td> <td>    3.307</td> <td> 0.001</td> <td>    0.067</td> <td>    0.269</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>14.125</td> <th>  Durbin-Watson:     </th> <td>   1.414</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.001</td> <th>  Jarque-Bera (JB):  </th> <td>  15.329</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.854</td> <th>  Prob(JB):          </th> <td>0.000469</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.558</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.136</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.096</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.387</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00700</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:05</td>     <th>  Log-Likelihood:    </th> <td> -408.79</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   829.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   846.0</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.3124</td> <td>    0.900</td> <td>   14.794</td> <td> 0.000</td> <td>   11.529</td> <td>   15.096</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.0483</td> <td>    0.373</td> <td>   -2.813</td> <td> 0.006</td> <td>   -1.787</td> <td>   -0.310</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.5740</td> <td>    0.529</td> <td>   -1.085</td> <td> 0.280</td> <td>   -1.623</td> <td>    0.475</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.5102</td> <td>    0.648</td> <td>    0.788</td> <td> 0.433</td> <td>   -0.774</td> <td>    1.794</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.2604</td> <td>    0.419</td> <td>    0.622</td> <td> 0.535</td> <td>   -0.570</td> <td>    1.090</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1162</td> <td>    0.089</td> <td>    1.305</td> <td> 0.195</td> <td>   -0.060</td> <td>    0.293</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>43.272</td> <th>  Durbin-Watson:     </th> <td>   1.382</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 115.307</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.418</td> <th>  Prob(JB):          </th> <td>9.15e-26</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.028</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.242</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.207</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   6.899</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>1.26e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:06</td>     <th>  Log-Likelihood:    </th> <td> -384.34</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   780.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   797.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.2541</td> <td>    0.726</td> <td>    1.727</td> <td> 0.087</td> <td>   -0.185</td> <td>    2.693</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.5137</td> <td>    0.301</td> <td>   -5.033</td> <td> 0.000</td> <td>   -2.110</td> <td>   -0.918</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.2925</td> <td>    0.427</td> <td>   -0.685</td> <td> 0.495</td> <td>   -1.139</td> <td>    0.554</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.1096</td> <td>    0.523</td> <td>    0.210</td> <td> 0.834</td> <td>   -0.927</td> <td>    1.146</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.1027</td> <td>    0.338</td> <td>   -0.304</td> <td> 0.762</td> <td>   -0.773</td> <td>    0.567</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0233</td> <td>    0.072</td> <td>    0.325</td> <td> 0.746</td> <td>   -0.119</td> <td>    0.166</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.962</td> <th>  Durbin-Watson:     </th> <td>   1.215</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.004</td> <th>  Jarque-Bera (JB):  </th> <td>  29.050</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.074</td> <th>  Prob(JB):          </th> <td>4.92e-07</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.469</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



## 模型二


```python
X = huanshoulv_ts02_2000[X_cols]
y = huanshoulv_ts02_2000['收益率'] - huanshoulv_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.105</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.072</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.206</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td>0.0157</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:08</td>     <th>  Log-Likelihood:    </th> <td> -411.58</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   833.2</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   846.8</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    6.6840</td> <td>    1.010</td> <td>    6.616</td> <td> 0.000</td> <td>    4.682</td> <td>    8.686</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    1.5110</td> <td>    0.551</td> <td>    2.744</td> <td> 0.007</td> <td>    0.420</td> <td>    2.602</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.4223</td> <td>    0.834</td> <td>   -0.506</td> <td> 0.614</td> <td>   -2.075</td> <td>    1.231</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    0.2190</td> <td>    0.804</td> <td>    0.272</td> <td> 0.786</td> <td>   -1.375</td> <td>    1.813</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.5589</td> <td>    0.676</td> <td>    2.307</td> <td> 0.023</td> <td>    0.220</td> <td>    2.898</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.244</td> <th>  Durbin-Watson:     </th> <td>   2.138</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.006</td> <th>  Jarque-Bera (JB):  </th> <td>  14.924</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.430</td> <th>  Prob(JB):          </th> <td>0.000574</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.550</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts02_2000[X_cols]
y = dongliang6_ts02_2000['收益率'] - dongliang6_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.281</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.255</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   10.67</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>2.47e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:08</td>     <th>  Log-Likelihood:    </th> <td> -441.92</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   893.8</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   907.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    8.6569</td> <td>    1.318</td> <td>    6.567</td> <td> 0.000</td> <td>    6.044</td> <td>   11.270</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.8920</td> <td>    0.718</td> <td>    5.417</td> <td> 0.000</td> <td>    2.468</td> <td>    5.316</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.0483</td> <td>    1.088</td> <td>   -0.044</td> <td> 0.965</td> <td>   -2.205</td> <td>    2.109</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    2.6989</td> <td>    1.050</td> <td>    2.571</td> <td> 0.011</td> <td>    0.618</td> <td>    4.779</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.3236</td> <td>    0.882</td> <td>    1.501</td> <td> 0.136</td> <td>   -0.424</td> <td>    3.071</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>15.283</td> <th>  Durbin-Watson:     </th> <td>   2.172</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  19.979</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.713</td> <th>  Prob(JB):          </th> <td>4.59e-05</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.475</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts02_2000[X_cols]
y = dongliang11_ts02_2000['收益率'] - dongliang11_ts02_2000['const']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.222</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.194</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   7.793</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>1.46e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:08</td>     <th>  Log-Likelihood:    </th> <td> -443.94</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   897.9</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   911.6</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -3.2233</td> <td>    1.342</td> <td>   -2.402</td> <td> 0.018</td> <td>   -5.883</td> <td>   -0.564</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    3.3136</td> <td>    0.731</td> <td>    4.531</td> <td> 0.000</td> <td>    1.864</td> <td>    4.763</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    0.9667</td> <td>    1.108</td> <td>    0.873</td> <td> 0.385</td> <td>   -1.229</td> <td>    3.162</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    1.8783</td> <td>    1.068</td> <td>    1.758</td> <td> 0.082</td> <td>   -0.239</td> <td>    3.996</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    1.2429</td> <td>    0.898</td> <td>    1.385</td> <td> 0.169</td> <td>   -0.536</td> <td>    3.022</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>16.838</td> <th>  Durbin-Watson:     </th> <td>   1.869</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  23.803</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.738</td> <th>  Prob(JB):          </th> <td>6.78e-06</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.684</td> <th>  Cond. No.          </th> <td>    2.54</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



## 模型三


```python
X = huanshoulv_ts03_2010[X_cols_03]
y = huanshoulv_ts03_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.070</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.030</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   1.725</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td> 0.135</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>13:14:59</td>     <th>  Log-Likelihood:    </th> <td> -371.10</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   754.2</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   770.9</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   10.3730</td> <td>    0.583</td> <td>   17.782</td> <td> 0.000</td> <td>    9.217</td> <td>   11.529</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>    0.1340</td> <td>    0.063</td> <td>    2.128</td> <td> 0.035</td> <td>    0.009</td> <td>    0.259</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    0.7714</td> <td>    0.402</td> <td>    1.918</td> <td> 0.058</td> <td>   -0.026</td> <td>    1.568</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    1.2145</td> <td>    0.777</td> <td>    1.563</td> <td> 0.121</td> <td>   -0.325</td> <td>    2.754</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -0.2945</td> <td>    0.456</td> <td>   -0.646</td> <td> 0.519</td> <td>   -1.197</td> <td>    0.608</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.0579</td> <td>    0.313</td> <td>    0.185</td> <td> 0.853</td> <td>   -0.562</td> <td>    0.678</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>17.098</td> <th>  Durbin-Watson:     </th> <td>   1.903</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  31.076</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.612</td> <th>  Prob(JB):          </th> <td>1.79e-07</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.172</td> <th>  Cond. No.          </th> <td>    14.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python


X = dongliang6_ts03_2010[X_cols_03]
y = dongliang6_ts03_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.160</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.123</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   4.345</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00118</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:14:59</td>     <th>  Log-Likelihood:    </th> <td> -398.48</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   809.0</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   825.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   12.2541</td> <td>    0.733</td> <td>   16.720</td> <td> 0.000</td> <td>   10.802</td> <td>   13.706</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>    0.1472</td> <td>    0.079</td> <td>    1.861</td> <td> 0.065</td> <td>   -0.010</td> <td>    0.304</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    1.8397</td> <td>    0.505</td> <td>    3.640</td> <td> 0.000</td> <td>    0.838</td> <td>    2.841</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    0.2336</td> <td>    0.976</td> <td>    0.239</td> <td> 0.811</td> <td>   -1.700</td> <td>    2.167</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    2.1053</td> <td>    0.573</td> <td>    3.677</td> <td> 0.000</td> <td>    0.971</td> <td>    3.240</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.2745</td> <td>    0.393</td> <td>    0.698</td> <td> 0.486</td> <td>   -0.504</td> <td>    1.053</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>14.253</td> <th>  Durbin-Watson:     </th> <td>   2.003</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.001</td> <th>  Jarque-Bera (JB):  </th> <td>  19.023</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.638</td> <th>  Prob(JB):          </th> <td>7.40e-05</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.475</td> <th>  Cond. No.          </th> <td>    14.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts03_2010[X_cols_03]
y = dongliang11_ts03_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.228</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.194</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   6.745</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 12 Aug 2021</td> <th>  Prob (F-statistic):</th> <td>1.53e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:15:00</td>     <th>  Log-Likelihood:    </th> <td> -389.21</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   790.4</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   807.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    0.0718</td> <td>    0.678</td> <td>    0.106</td> <td> 0.916</td> <td>   -1.272</td> <td>    1.416</td>
</tr>
<tr>
  <th>mk_rf</th>       <td>   -0.0267</td> <td>    0.073</td> <td>   -0.364</td> <td> 0.716</td> <td>   -0.172</td> <td>    0.118</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    0.8877</td> <td>    0.468</td> <td>    1.898</td> <td> 0.060</td> <td>   -0.039</td> <td>    1.814</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.2863</td> <td>    0.903</td> <td>   -0.317</td> <td> 0.752</td> <td>   -2.076</td> <td>    1.504</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -1.7529</td> <td>    0.530</td> <td>   -3.307</td> <td> 0.001</td> <td>   -2.803</td> <td>   -0.703</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -0.0246</td> <td>    0.364</td> <td>   -0.068</td> <td> 0.946</td> <td>   -0.745</td> <td>    0.696</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.124</td> <th>  Durbin-Watson:     </th> <td>   1.761</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.127</td> <th>  Jarque-Bera (JB):  </th> <td>   4.455</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.184</td> <th>  Prob(JB):          </th> <td>   0.108</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.869</td> <th>  Cond. No.          </th> <td>    14.5</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python

```
