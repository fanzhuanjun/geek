```python
import numpy as np
import pandas as pd
import os
```


```python
factor_df = pd.read_excel("五因子数据.xlsx")
factor_df = factor_df.rename(columns={"时间" : "日期"})
```


```python
factor_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>SMB</th>
      <th>HML</th>
      <th>CMA</th>
      <th>RMW</th>
      <th>mk_rf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>1.776700</td>
      <td>-2.048085</td>
      <td>-3.020902</td>
      <td>-3.910493</td>
      <td>4.985</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>2.161310</td>
      <td>-3.355225</td>
      <td>-2.356352</td>
      <td>-3.563212</td>
      <td>0.555</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>2.768764</td>
      <td>-0.595435</td>
      <td>-0.795055</td>
      <td>-0.294096</td>
      <td>-3.895</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>2.368923</td>
      <td>0.203406</td>
      <td>-1.691315</td>
      <td>-2.593286</td>
      <td>3.545</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>0.514857</td>
      <td>0.213481</td>
      <td>0.095284</td>
      <td>-0.527789</td>
      <td>6.015</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.read_excel("数据整理_2.xlsx")
data.info()
```


```python
data['换手比'] = data['20日换手率_winsorized'] / data['12个月换手率_winsorized']
```


```python
data['换手比_分10组'] = data.groupby(['日期'])['换手比'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
data['动量6_分10组'] = data.groupby(['日期'])['动量6_winsorized'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
data['动量11_分10组'] = data.groupby(['日期'])['动量11_winsorized'].apply(lambda x: pd.qcut(x, q=10, labels=range(1, 11)))
```

# 构建多空时间序列


```python
huanshoulv_ts = data[data['换手比_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['换手比_分10组'] == 1].groupby("日期")['收益率_rf'].mean()

dongliang6_ts = data[data['动量6_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['动量6_分10组'] == 1].groupby("日期")['收益率_rf'].mean()


dongliang11_ts = data[data['动量11_分10组'] == 10].groupby("日期")['收益率_rf'].mean() - \
data[data['动量11_分10组'] == 1].groupby("日期")['收益率_rf'].mean()
```


```python
huanshoulv_ts = huanshoulv_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang6_ts = dongliang6_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
dongliang11_ts = dongliang11_ts.reset_index().merge(factor_df, on='日期', how='left').dropna()
```


```python
huanshoulv_ts.columns
```




    Index(['日期', '收益率_rf', 'SMB', 'HML', 'CMA', 'RMW', 'mk_rf'], dtype='object')




```python
import statsmodels.api as sm

def get_OLS(X, y):
    X = sm.add_constant(X)
    mod = sm.OLS(y, X)
    res = mod.fit()
    return res
```


```python
X = huanshoulv_ts[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.095</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.075</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   4.791</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>0.000349</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:28:46</td>     <th>  Log-Likelihood:    </th> <td> -730.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1473.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1493.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    9.4765</td> <td>    0.402</td> <td>   23.548</td> <td> 0.000</td> <td>    8.684</td> <td>   10.269</td>
</tr>
<tr>
  <th>SMB</th>   <td>    0.0182</td> <td>    0.125</td> <td>    0.146</td> <td> 0.884</td> <td>   -0.228</td> <td>    0.264</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.2766</td> <td>    0.220</td> <td>   -1.256</td> <td> 0.210</td> <td>   -0.711</td> <td>    0.157</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.1339</td> <td>    0.253</td> <td>   -0.528</td> <td> 0.598</td> <td>   -0.633</td> <td>    0.366</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.0400</td> <td>    0.161</td> <td>   -0.249</td> <td> 0.804</td> <td>   -0.357</td> <td>    0.277</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1216</td> <td>    0.042</td> <td>    2.881</td> <td> 0.004</td> <td>    0.038</td> <td>    0.205</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>63.704</td> <th>  Durbin-Watson:     </th> <td>   1.657</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 197.506</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.138</td> <th>  Prob(JB):          </th> <td>1.29e-43</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 6.883</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.106</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.087</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   5.428</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>9.71e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:28:46</td>     <th>  Log-Likelihood:    </th> <td> -816.96</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1646.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1667.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.2648</td> <td>    0.583</td> <td>   22.765</td> <td> 0.000</td> <td>   12.117</td> <td>   14.413</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.4042</td> <td>    0.181</td> <td>   -2.238</td> <td> 0.026</td> <td>   -0.760</td> <td>   -0.048</td>
</tr>
<tr>
  <th>HML</th>   <td>    0.0513</td> <td>    0.319</td> <td>    0.161</td> <td> 0.872</td> <td>   -0.577</td> <td>    0.680</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.3002</td> <td>    0.367</td> <td>   -0.818</td> <td> 0.414</td> <td>   -1.023</td> <td>    0.423</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.8034</td> <td>    0.233</td> <td>    3.449</td> <td> 0.001</td> <td>    0.344</td> <td>    1.262</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1385</td> <td>    0.061</td> <td>    2.266</td> <td> 0.024</td> <td>    0.018</td> <td>    0.259</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>72.930</td> <th>  Durbin-Watson:     </th> <td>   1.535</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 248.985</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.276</td> <th>  Prob(JB):          </th> <td>8.58e-55</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.362</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.264</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.248</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   16.34</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>9.03e-14</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:28:46</td>     <th>  Log-Likelihood:    </th> <td> -770.50</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1553.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   228</td>      <th>  BIC:               </th> <td>   1574.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.6171</td> <td>    0.478</td> <td>    3.385</td> <td> 0.001</td> <td>    0.676</td> <td>    2.558</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.1938</td> <td>    0.148</td> <td>   -8.063</td> <td> 0.000</td> <td>   -1.486</td> <td>   -0.902</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.1549</td> <td>    0.261</td> <td>   -0.593</td> <td> 0.554</td> <td>   -0.670</td> <td>    0.360</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.0964</td> <td>    0.301</td> <td>   -0.321</td> <td> 0.749</td> <td>   -0.689</td> <td>    0.497</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.1188</td> <td>    0.191</td> <td>   -0.622</td> <td> 0.534</td> <td>   -0.495</td> <td>    0.257</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0312</td> <td>    0.050</td> <td>    0.622</td> <td> 0.535</td> <td>   -0.068</td> <td>    0.130</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>19.032</td> <th>  Durbin-Watson:     </th> <td>   1.514</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  65.520</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.089</td> <th>  Prob(JB):          </th> <td>5.92e-15</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.586</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 模型二


```python
factor_mut = pd.read_excel("因子收益率.xlsx")
```


```python
factor_mut.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>日期</th>
      <th>const</th>
      <th>市值因子收益率</th>
      <th>账面市值比因子收益率</th>
      <th>ROE因子收益率</th>
      <th>总资产增长率因子收益率</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>11.893441</td>
      <td>-0.002794</td>
      <td>-2.176539</td>
      <td>0.119478</td>
      <td>-0.080916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-08-31</td>
      <td>7.524615</td>
      <td>-0.006606</td>
      <td>-2.273877</td>
      <td>0.064646</td>
      <td>-0.049349</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-09-29</td>
      <td>1.640380</td>
      <td>-0.035452</td>
      <td>-1.264579</td>
      <td>0.089341</td>
      <td>-0.039572</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-10-31</td>
      <td>6.209219</td>
      <td>-0.043229</td>
      <td>0.034465</td>
      <td>0.046475</td>
      <td>-0.051498</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-11-30</td>
      <td>6.042043</td>
      <td>0.009037</td>
      <td>-0.012821</td>
      <td>0.060097</td>
      <td>-0.027767</td>
    </tr>
  </tbody>
</table>
</div>




```python
factor_mut.columns
```




    Index(['日期', 'const', '市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率', '总资产增长率因子收益率'], dtype='object')




```python
huanshoulv_ts02 = huanshoulv_ts[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left')
dongliang6_ts02 = dongliang6_ts[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left')
dongliang11_ts02 = dongliang11_ts[['日期', '收益率_rf']].merge(factor_mut, on="日期", how='left')
```


```python
X_cols = ['市值因子收益率', '账面市值比因子收益率', 'ROE因子收益率', '总资产增长率因子收益率']
```


```python
X = huanshoulv_ts02[X_cols]
y = huanshoulv_ts02['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.103</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.087</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   6.562</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>5.13e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>15:58:56</td>     <th>  Log-Likelihood:    </th> <td> -729.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1469.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1486.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    9.3823</td> <td>    0.406</td> <td>   23.109</td> <td> 0.000</td> <td>    8.582</td> <td>   10.182</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   -5.7799</td> <td>    8.003</td> <td>   -0.722</td> <td> 0.471</td> <td>  -21.549</td> <td>    9.989</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.7676</td> <td>    0.475</td> <td>   -3.724</td> <td> 0.000</td> <td>   -2.703</td> <td>   -0.832</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -4.3247</td> <td>    2.422</td> <td>   -1.786</td> <td> 0.075</td> <td>   -9.097</td> <td>    0.447</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -17.2775</td> <td>    6.981</td> <td>   -2.475</td> <td> 0.014</td> <td>  -31.032</td> <td>   -3.523</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>43.565</td> <th>  Durbin-Watson:     </th> <td>   1.531</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 104.748</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.851</td> <th>  Prob(JB):          </th> <td>1.80e-23</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.801</td> <th>  Cond. No.          </th> <td>    22.6</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts02[X_cols]
y = dongliang6_ts02['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.241</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.227</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   18.14</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>5.89e-13</td>
</tr>
<tr>
  <th>Time:</th>                 <td>15:59:18</td>     <th>  Log-Likelihood:    </th> <td> -797.92</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1606.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1623.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   11.2872</td> <td>    0.544</td> <td>   20.739</td> <td> 0.000</td> <td>   10.215</td> <td>   12.360</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   75.9814</td> <td>   10.728</td> <td>    7.082</td> <td> 0.000</td> <td>   54.843</td> <td>   97.120</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.8350</td> <td>    0.636</td> <td>   -2.884</td> <td> 0.004</td> <td>   -3.089</td> <td>   -0.581</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   12.9587</td> <td>    3.246</td> <td>    3.992</td> <td> 0.000</td> <td>    6.562</td> <td>   19.355</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -19.0114</td> <td>    9.358</td> <td>   -2.032</td> <td> 0.043</td> <td>  -37.450</td> <td>   -0.573</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>36.688</td> <th>  Durbin-Watson:     </th> <td>   1.586</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  63.045</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.849</td> <th>  Prob(JB):          </th> <td>2.04e-14</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.893</td> <th>  Cond. No.          </th> <td>    22.6</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts02[X_cols]
y = dongliang11_ts02['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.225</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.212</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   16.64</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>5.53e-12</td>
</tr>
<tr>
  <th>Time:</th>                 <td>15:59:18</td>     <th>  Log-Likelihood:    </th> <td> -776.48</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   234</td>      <th>  AIC:               </th> <td>   1563.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   229</td>      <th>  BIC:               </th> <td>   1580.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -1.0403</td> <td>    0.497</td> <td>   -2.095</td> <td> 0.037</td> <td>   -2.019</td> <td>   -0.062</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   67.9148</td> <td>    9.789</td> <td>    6.938</td> <td> 0.000</td> <td>   48.627</td> <td>   87.202</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.0226</td> <td>    0.581</td> <td>   -1.761</td> <td> 0.080</td> <td>   -2.167</td> <td>    0.121</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -9.5201</td> <td>    2.962</td> <td>   -3.214</td> <td> 0.001</td> <td>  -15.357</td> <td>   -3.684</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -21.8919</td> <td>    8.538</td> <td>   -2.564</td> <td> 0.011</td> <td>  -38.716</td> <td>   -5.068</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>21.180</td> <th>  Durbin-Watson:     </th> <td>   1.466</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  68.481</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.240</td> <th>  Prob(JB):          </th> <td>1.35e-15</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.606</td> <th>  Cond. No.          </th> <td>    22.6</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 分时段

# 2000-2009.12


```python
huanshoulv_ts_2000 = huanshoulv_ts[huanshoulv_ts['日期'] <= '2009-12-31']
dongliang6_ts_2000 = dongliang6_ts[dongliang6_ts['日期'] <= '2009-12-31']
dongliang11_ts_2000 = dongliang11_ts[dongliang11_ts['日期'] <= '2009-12-31']

huanshoulv_ts02_2000 = huanshoulv_ts02[huanshoulv_ts02['日期'] <= '2009-12-31']
dongliang6_ts02_2000 = dongliang6_ts02[dongliang6_ts02['日期'] <= '2009-12-31']
dongliang11_ts02_2000 = dongliang11_ts02[dongliang11_ts02['日期'] <= '2009-12-31']
```


```python
X = huanshoulv_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.281</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.247</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.426</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>9.28e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:17</td>     <th>  Log-Likelihood:    </th> <td> -344.84</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   701.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   718.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    8.4869</td> <td>    0.513</td> <td>   16.528</td> <td> 0.000</td> <td>    7.469</td> <td>    9.505</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.0603</td> <td>    0.213</td> <td>   -0.284</td> <td> 0.777</td> <td>   -0.482</td> <td>    0.361</td>
</tr>
<tr>
  <th>HML</th>   <td>   -1.2584</td> <td>    0.302</td> <td>   -4.169</td> <td> 0.000</td> <td>   -1.857</td> <td>   -0.660</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.8922</td> <td>    0.370</td> <td>    2.414</td> <td> 0.017</td> <td>    0.159</td> <td>    1.625</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.0603</td> <td>    0.239</td> <td>   -0.252</td> <td> 0.801</td> <td>   -0.534</td> <td>    0.413</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1680</td> <td>    0.051</td> <td>    3.307</td> <td> 0.001</td> <td>    0.067</td> <td>    0.269</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>14.125</td> <th>  Durbin-Watson:     </th> <td>   1.414</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.001</td> <th>  Jarque-Bera (JB):  </th> <td>  15.329</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.854</td> <th>  Prob(JB):          </th> <td>0.000469</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.558</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.136</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.096</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.387</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00700</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:17</td>     <th>  Log-Likelihood:    </th> <td> -408.79</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   829.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   846.0</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.3124</td> <td>    0.900</td> <td>   14.794</td> <td> 0.000</td> <td>   11.529</td> <td>   15.096</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.0483</td> <td>    0.373</td> <td>   -2.813</td> <td> 0.006</td> <td>   -1.787</td> <td>   -0.310</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.5740</td> <td>    0.529</td> <td>   -1.085</td> <td> 0.280</td> <td>   -1.623</td> <td>    0.475</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.5102</td> <td>    0.648</td> <td>    0.788</td> <td> 0.433</td> <td>   -0.774</td> <td>    1.794</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.2604</td> <td>    0.419</td> <td>    0.622</td> <td> 0.535</td> <td>   -0.570</td> <td>    1.090</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1162</td> <td>    0.089</td> <td>    1.305</td> <td> 0.195</td> <td>   -0.060</td> <td>    0.293</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>43.272</td> <th>  Durbin-Watson:     </th> <td>   1.382</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 115.307</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.418</td> <th>  Prob(JB):          </th> <td>9.15e-26</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.028</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts_2000[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.242</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.207</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   6.899</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>1.26e-05</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:17</td>     <th>  Log-Likelihood:    </th> <td> -384.34</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   780.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   108</td>      <th>  BIC:               </th> <td>   797.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.2541</td> <td>    0.726</td> <td>    1.727</td> <td> 0.087</td> <td>   -0.185</td> <td>    2.693</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -1.5137</td> <td>    0.301</td> <td>   -5.033</td> <td> 0.000</td> <td>   -2.110</td> <td>   -0.918</td>
</tr>
<tr>
  <th>HML</th>   <td>   -0.2925</td> <td>    0.427</td> <td>   -0.685</td> <td> 0.495</td> <td>   -1.139</td> <td>    0.554</td>
</tr>
<tr>
  <th>CMA</th>   <td>    0.1096</td> <td>    0.523</td> <td>    0.210</td> <td> 0.834</td> <td>   -0.927</td> <td>    1.146</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.1027</td> <td>    0.338</td> <td>   -0.304</td> <td> 0.762</td> <td>   -0.773</td> <td>    0.567</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0233</td> <td>    0.072</td> <td>    0.325</td> <td> 0.746</td> <td>   -0.119</td> <td>    0.166</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.962</td> <th>  Durbin-Watson:     </th> <td>   1.215</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.004</td> <th>  Jarque-Bera (JB):  </th> <td>  29.050</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.074</td> <th>  Prob(JB):          </th> <td>4.92e-07</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.469</td> <th>  Cond. No.          </th> <td>    11.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = huanshoulv_ts02_2000[X_cols]
y = huanshoulv_ts02_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.254</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.227</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   9.299</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>1.67e-06</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:18</td>     <th>  Log-Likelihood:    </th> <td> -346.88</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   703.8</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   717.4</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    7.7083</td> <td>    0.576</td> <td>   13.371</td> <td> 0.000</td> <td>    6.566</td> <td>    8.851</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>    6.2576</td> <td>    8.647</td> <td>    0.724</td> <td> 0.471</td> <td>  -10.881</td> <td>   23.396</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -2.5827</td> <td>    0.508</td> <td>   -5.089</td> <td> 0.000</td> <td>   -3.589</td> <td>   -1.577</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>  -12.2847</td> <td>    5.867</td> <td>   -2.094</td> <td> 0.039</td> <td>  -23.913</td> <td>   -0.656</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -21.8053</td> <td>    8.129</td> <td>   -2.682</td> <td> 0.008</td> <td>  -37.917</td> <td>   -5.693</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>19.246</td> <th>  Durbin-Watson:     </th> <td>   1.444</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  26.763</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.849</td> <th>  Prob(JB):          </th> <td>1.54e-06</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.659</td> <th>  Cond. No.          </th> <td>    21.3</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang6_ts02_2000[X_cols]
y = dongliang6_ts02_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.362</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.338</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   15.44</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>4.88e-10</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:18</td>     <th>  Log-Likelihood:    </th> <td> -391.50</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   793.0</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   806.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    9.6563</td> <td>    0.853</td> <td>   11.324</td> <td> 0.000</td> <td>    7.966</td> <td>   11.346</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   79.8778</td> <td>   12.790</td> <td>    6.245</td> <td> 0.000</td> <td>   54.528</td> <td>  105.227</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -1.8308</td> <td>    0.751</td> <td>   -2.439</td> <td> 0.016</td> <td>   -3.319</td> <td>   -0.343</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   16.0229</td> <td>    8.678</td> <td>    1.846</td> <td> 0.068</td> <td>   -1.177</td> <td>   33.223</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -31.3313</td> <td>   12.024</td> <td>   -2.606</td> <td> 0.010</td> <td>  -55.163</td> <td>   -7.499</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>24.688</td> <th>  Durbin-Watson:     </th> <td>   1.524</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  39.200</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.995</td> <th>  Prob(JB):          </th> <td>3.07e-09</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.072</td> <th>  Cond. No.          </th> <td>    21.3</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python
X = dongliang11_ts02_2000[X_cols]
y = dongliang11_ts02_2000['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.294</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.268</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   11.37</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>9.54e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:19</td>     <th>  Log-Likelihood:    </th> <td> -380.27</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   114</td>      <th>  AIC:               </th> <td>   770.5</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   109</td>      <th>  BIC:               </th> <td>   784.2</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   -2.3916</td> <td>    0.773</td> <td>   -3.095</td> <td> 0.003</td> <td>   -3.923</td> <td>   -0.860</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   69.9987</td> <td>   11.590</td> <td>    6.040</td> <td> 0.000</td> <td>   47.028</td> <td>   92.970</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.8393</td> <td>    0.680</td> <td>   -1.234</td> <td> 0.220</td> <td>   -2.188</td> <td>    0.509</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>    1.7402</td> <td>    7.864</td> <td>    0.221</td> <td> 0.825</td> <td>  -13.846</td> <td>   17.327</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -30.6056</td> <td>   10.896</td> <td>   -2.809</td> <td> 0.006</td> <td>  -52.201</td> <td>   -9.010</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>18.292</td> <th>  Durbin-Watson:     </th> <td>   1.335</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  48.481</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.514</td> <th>  Prob(JB):          </th> <td>2.97e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 6.025</td> <th>  Cond. No.          </th> <td>    21.3</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.



# 2010~至今


```python
huanshoulv_ts_2010 = huanshoulv_ts[huanshoulv_ts['日期'] > '2009-12-31']
dongliang6_ts_2010 = dongliang6_ts[dongliang6_ts['日期'] > '2009-12-31']
dongliang11_ts_2010 = dongliang11_ts[dongliang11_ts['日期'] > '2009-12-31']

huanshoulv_ts02_2010 = huanshoulv_ts02[huanshoulv_ts02['日期'] > '2009-12-31']
dongliang6_ts02_2010 = dongliang6_ts02[dongliang6_ts02['日期'] > '2009-12-31']
dongliang11_ts02_2010 = dongliang11_ts02[dongliang11_ts02['日期'] > '2009-12-31']
```


```python
X = huanshoulv_ts_2010[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = huanshoulv_ts_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.145</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.107</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.854</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00290</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:20</td>     <th>  Log-Likelihood:    </th> <td> -366.10</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   744.2</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   760.9</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   10.6708</td> <td>    0.570</td> <td>   18.712</td> <td> 0.000</td> <td>    9.541</td> <td>   11.801</td>
</tr>
<tr>
  <th>SMB</th>   <td>    0.0627</td> <td>    0.190</td> <td>    0.330</td> <td> 0.742</td> <td>   -0.314</td> <td>    0.439</td>
</tr>
<tr>
  <th>HML</th>   <td>    0.8315</td> <td>    0.304</td> <td>    2.732</td> <td> 0.007</td> <td>    0.228</td> <td>    1.435</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -1.0247</td> <td>    0.341</td> <td>   -3.008</td> <td> 0.003</td> <td>   -1.700</td> <td>   -0.350</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.3265</td> <td>    0.220</td> <td>   -1.482</td> <td> 0.141</td> <td>   -0.763</td> <td>    0.110</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1490</td> <td>    0.065</td> <td>    2.280</td> <td> 0.024</td> <td>    0.020</td> <td>    0.278</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>23.035</td> <th>  Durbin-Watson:     </th> <td>   1.884</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  49.355</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.760</td> <th>  Prob(JB):          </th> <td>1.92e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.749</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python

X = dongliang6_ts_2010[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang6_ts_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.126</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.088</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   3.298</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th>  <td>0.00808</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:20</td>     <th>  Log-Likelihood:    </th> <td> -400.84</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   813.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   830.4</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   13.3370</td> <td>    0.762</td> <td>   17.508</td> <td> 0.000</td> <td>   11.828</td> <td>   14.846</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.2369</td> <td>    0.254</td> <td>   -0.934</td> <td> 0.352</td> <td>   -0.739</td> <td>    0.266</td>
</tr>
<tr>
  <th>HML</th>   <td>    0.3522</td> <td>    0.407</td> <td>    0.866</td> <td> 0.388</td> <td>   -0.453</td> <td>    1.158</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.7196</td> <td>    0.455</td> <td>   -1.581</td> <td> 0.117</td> <td>   -1.621</td> <td>    0.182</td>
</tr>
<tr>
  <th>RMW</th>   <td>    0.8966</td> <td>    0.294</td> <td>    3.046</td> <td> 0.003</td> <td>    0.314</td> <td>    1.480</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.1502</td> <td>    0.087</td> <td>    1.721</td> <td> 0.088</td> <td>   -0.023</td> <td>    0.323</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.403</td> <th>  Durbin-Watson:     </th> <td>   1.797</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.006</td> <th>  Jarque-Bera (JB):  </th> <td>  11.437</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.569</td> <th>  Prob(JB):          </th> <td> 0.00328</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.996</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python


X = dongliang11_ts_2010[['SMB', 'HML', 'CMA', 'RMW', 'mk_rf']]
y = dongliang11_ts_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.394</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.367</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   14.79</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>3.59e-11</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:21</td>     <th>  Log-Likelihood:    </th> <td> -374.76</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   761.5</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   114</td>      <th>  BIC:               </th> <td>   778.2</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.7558</td> <td>    0.613</td> <td>    2.865</td> <td> 0.005</td> <td>    0.542</td> <td>    2.970</td>
</tr>
<tr>
  <th>SMB</th>   <td>   -0.6612</td> <td>    0.204</td> <td>   -3.240</td> <td> 0.002</td> <td>   -1.066</td> <td>   -0.257</td>
</tr>
<tr>
  <th>HML</th>   <td>    0.1586</td> <td>    0.327</td> <td>    0.485</td> <td> 0.629</td> <td>   -0.490</td> <td>    0.807</td>
</tr>
<tr>
  <th>CMA</th>   <td>   -0.6338</td> <td>    0.366</td> <td>   -1.731</td> <td> 0.086</td> <td>   -1.359</td> <td>    0.092</td>
</tr>
<tr>
  <th>RMW</th>   <td>   -0.5921</td> <td>    0.237</td> <td>   -2.500</td> <td> 0.014</td> <td>   -1.061</td> <td>   -0.123</td>
</tr>
<tr>
  <th>mk_rf</th> <td>    0.0523</td> <td>    0.070</td> <td>    0.744</td> <td> 0.458</td> <td>   -0.087</td> <td>    0.191</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>14.633</td> <th>  Durbin-Watson:     </th> <td>   1.748</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.001</td> <th>  Jarque-Bera (JB):  </th> <td>  24.004</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.559</td> <th>  Prob(JB):          </th> <td>6.13e-06</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.885</td> <th>  Cond. No.          </th> <td>    11.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python

X = huanshoulv_ts02_2010[X_cols]
y = huanshoulv_ts02_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.090</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.059</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   2.853</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th>  <td>0.0269</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:21</td>     <th>  Log-Likelihood:    </th> <td> -369.79</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   749.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   115</td>      <th>  BIC:               </th> <td>   763.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   10.6939</td> <td>    0.574</td> <td>   18.644</td> <td> 0.000</td> <td>    9.558</td> <td>   11.830</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   52.7219</td> <td>   34.480</td> <td>    1.529</td> <td> 0.129</td> <td>  -15.576</td> <td>  121.020</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>    1.6163</td> <td>    1.223</td> <td>    1.321</td> <td> 0.189</td> <td>   -0.806</td> <td>    4.039</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   -4.6331</td> <td>    3.082</td> <td>   -1.503</td> <td> 0.135</td> <td>  -10.737</td> <td>    1.471</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>  -26.4119</td> <td>   13.460</td> <td>   -1.962</td> <td> 0.052</td> <td>  -53.073</td> <td>    0.249</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.953</td> <th>  Durbin-Watson:     </th> <td>   1.737</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.004</td> <th>  Jarque-Bera (JB):  </th> <td>  19.088</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.370</td> <th>  Prob(JB):          </th> <td>7.16e-05</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.809</td> <th>  Cond. No.          </th> <td>    70.9</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python

X = dongliang6_ts02_2010[X_cols]
y = dongliang6_ts02_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.157</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.128</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   5.372</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>0.000530</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:21</td>     <th>  Log-Likelihood:    </th> <td> -398.67</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   807.3</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   115</td>      <th>  BIC:               </th> <td>   821.3</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>   12.3550</td> <td>    0.730</td> <td>   16.933</td> <td> 0.000</td> <td>   10.910</td> <td>   13.800</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>  162.6239</td> <td>   43.861</td> <td>    3.708</td> <td> 0.000</td> <td>   75.744</td> <td>  249.503</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.4396</td> <td>    1.556</td> <td>   -0.283</td> <td> 0.778</td> <td>   -3.522</td> <td>    2.642</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>   13.4488</td> <td>    3.920</td> <td>    3.431</td> <td> 0.001</td> <td>    5.684</td> <td>   21.214</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>    0.7543</td> <td>   17.121</td> <td>    0.044</td> <td> 0.965</td> <td>  -33.160</td> <td>   34.669</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>27.948</td> <th>  Durbin-Watson:     </th> <td>   1.831</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  53.183</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.989</td> <th>  Prob(JB):          </th> <td>2.83e-12</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.593</td> <th>  Cond. No.          </th> <td>    70.9</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python


X = dongliang11_ts02_2010[X_cols]
y = dongliang11_ts02_2010['收益率_rf']


res = get_OLS(X, y)
res.summary()
```




<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>收益率_rf</td>      <th>  R-squared:         </th> <td>   0.230</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.203</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.579</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 22 Jul 2021</td> <th>  Prob (F-statistic):</th> <td>4.29e-06</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:28:22</td>     <th>  Log-Likelihood:    </th> <td> -389.09</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   120</td>      <th>  AIC:               </th> <td>   788.2</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   115</td>      <th>  BIC:               </th> <td>   802.1</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    0.2041</td> <td>    0.674</td> <td>    0.303</td> <td> 0.762</td> <td>   -1.130</td> <td>    1.539</td>
</tr>
<tr>
  <th>市值因子收益率</th>     <td>   89.4586</td> <td>   40.496</td> <td>    2.209</td> <td> 0.029</td> <td>    9.244</td> <td>  169.673</td>
</tr>
<tr>
  <th>账面市值比因子收益率</th>  <td>   -0.6723</td> <td>    1.437</td> <td>   -0.468</td> <td> 0.641</td> <td>   -3.518</td> <td>    2.173</td>
</tr>
<tr>
  <th>ROE因子收益率</th>    <td>  -12.8081</td> <td>    3.619</td> <td>   -3.539</td> <td> 0.001</td> <td>  -19.977</td> <td>   -5.639</td>
</tr>
<tr>
  <th>总资产增长率因子收益率</th> <td>   -7.2535</td> <td>   15.808</td> <td>   -0.459</td> <td> 0.647</td> <td>  -38.566</td> <td>   24.059</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.251</td> <th>  Durbin-Watson:     </th> <td>   1.740</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.119</td> <th>  Jarque-Bera (JB):  </th> <td>   4.725</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.179</td> <th>  Prob(JB):          </th> <td>  0.0942</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.904</td> <th>  Cond. No.          </th> <td>    70.9</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.




```python

```


```python

```
